RAM:0000	     ;
RAM:0000	     ; +-------------------------------------------------------------------------+
RAM:0000	     ; |   This	file has been generated	by The Interactive Disassembler	(IDA)	 |
RAM:0000	     ; |	   Copyright (c) 2015 Hex-Rays,	<support@hex-rays.com>		 |
RAM:0000	     ; |		      License info: 48-B437-7294-77			 |
RAM:0000	     ; |			Chris Nott, Virtual Logic			 |
RAM:0000	     ; +-------------------------------------------------------------------------+
RAM:0000	     ;
RAM:0000	     ; Input SHA256 : 393574F1F0232302BE07C20B1CBD701EE2C7547DBBF02D0AB836D3B20EA041B7
RAM:0000	     ; Input MD5    : 2A2ACFD20A2D495DDDEE77AF99730795
RAM:0000	     ; Input CRC32  : 151C1E33
RAM:0000
RAM:0000	     ;
RAM:0000	     ; +-------------------------------------------------+
RAM:0000	     ; + Asteroids (Rev	2) Disassembly v0.01		 +
RAM:0000	     ; +   - by	tcdev (msmcdoug@gmail.com)		 +
RAM:0000	     ; +   - based on work by Lonnie Howell		 +
RAM:0000	     ; +-------------------------------------------------+
RAM:0000	     ;
RAM:0000	     ; File Name   : E:\dev\pace\pacedev.net\sw\re\platform\asteroids\roms\asteroid2.bin
RAM:0000	     ; Format	   : Binary file
RAM:0000	     ; Base Address: 0000h Range: 6800h	- 8000h	Loaded length: 00001800h
RAM:0000
RAM:0000	     ; ; Processor:	   M6502
RAM:0000	     ; ; Target	assembler: Table Driven	Assembler (TASM) by Speech Technology Inc.
RAM:0000
RAM:0000	     ; ===========================================================================
RAM:0000
RAM:0000	     ; Segment type: Regular
RAM:0000					     ;.segment RAM
RAM:0000 ??	     globalScale:		     .block 1
RAM:0001 ??	     byte_1:			     .block 1
RAM:0002 ??	     dvg_curr_addr_lsb:		     .block 1
RAM:0003 ??	     dvg_curr_addr_msb:		     .block 1
RAM:0004 ??	     byte_4:			     .block 1			     ; tmp store coord conversion
RAM:0005 ??	     byte_5:			     .block 1			     ; tmp store coord conversion
RAM:0006 ??	     byte_6:			     .block 1			     ; tmp store coord conversion
RAM:0007 ??	     byte_7:			     .block 1			     ; tmp store coord conversion
RAM:0008 ??	     byte_8:			     .block 1			     ; tmp store
RAM:0009 ??	     byte_9:			     .block 1			     ; tmp store
RAM:000A ??	     byte_A:			     .block 1
RAM:000B ??	     byte_B:			     .block 1
RAM:000C ??	     byte_C:			     .block 1
RAM:000D ??	     byte_D:			     .block 1
RAM:000E ??	     byte_E:			     .block 1
RAM:000F ??	     byte_F:			     .block 1
RAM:0010 ??	     initial_offset:		     .block 1
RAM:0011 ??					     .block 1
RAM:0012 ??					     .block 1
RAM:0013 ??					     .block 1
RAM:0014 ??					     .block 1
RAM:0015 ??	     byte_15:			     .block 1
RAM:0016 ??	     byte_16:			     .block 1
RAM:0017 ??	     byte_17:			     .block 1
RAM:0018 ??	     curPlayer:			     .block 1
RAM:0019 ??	     curPlayer_x2:		     .block 1
RAM:001A ??	     numPlayersPreviousGame:	     .block 1
RAM:001B ??	     unk_1B:			     .block 1
RAM:001C ??	     numPlayers:		     .block 1
RAM:001D
RAM:001D	     ; High score format (2 bytes)
RAM:001D	     ; byte 1 -	tens (in decimal)
RAM:001D	     ; byte 2 -	thousands (in decimal)
RAM:001D ?? ??	     highScoreTable:		     .block 2
RAM:001F ?? ??					     .block 2
RAM:0021 ?? ??	     word_21:			     .block 2
RAM:0023 ?? ??					     .block 2
RAM:0025 ?? ??					     .block 2
RAM:0027 ?? ??	     word_27:			     .block 2
RAM:0029 ?? ??					     .block 2
RAM:002B ?? ??					     .block 2
RAM:002D ?? ??					     .block 2
RAM:002F ?? ??					     .block 2
RAM:0031 ??	     letterHighScoreEntry:	     .block 1
RAM:0032 ??	     placeP1HighScore:		     .block 1
RAM:0033 ??	     placeP2HighScore:		     .block 1
RAM:0034 ?? ?? ??    highScoreInitials:		     .block 3
RAM:0037 ?? ?? ??				     .block 3
RAM:003A ?? ?? ??				     .block 3
RAM:003D ?? ?? ??				     .block 3
RAM:0040 ?? ?? ??				     .block 3
RAM:0043 ?? ?? ??				     .block 3
RAM:0046 ?? ?? ??				     .block 3
RAM:0049 ?? ?? ??				     .block 3
RAM:004C ?? ?? ??				     .block 3
RAM:004F ?? ?? ??    byte_4F:			     .block 3
RAM:0052 ??	     p1ScoreTens:		     .block 1
RAM:0053 ??	     p1ScoreThousands:		     .block 1
RAM:0054 ??	     p2ScoreTens:		     .block 1
RAM:0055 ??	     p2ScoreThousands:		     .block 1
RAM:0056 ??	     numStartingShipsPerGame:	     .block 1
RAM:0057 ??	     numShipsP1:		     .block 1
RAM:0058 ??	     numShipsP2:		     .block 1
RAM:0059	     ; Hyperspace flag:
RAM:0059	     ; - 0x01 =	successful
RAM:0059	     ;	 0x80 =	unsuccessful (death)
RAM:0059	     ;	 0x00 =	not active
RAM:0059 ??	     hyperspaceFlag:		     .block 1
RAM:005A ??	     timerStartGame:		     .block 1
RAM:005B ??	     VBLANK_triggered:		     .block 1
RAM:005C ??	     fastTimer:			     .block 1
RAM:005D ??	     slowTimer:			     .block 1
RAM:005E ??	     NMI_count:			     .block 1
RAM:005F ??	     rnd1:			     .block 1
RAM:0060 ??	     rnd2:			     .block 1
RAM:0061 ??	     direction:			     .block 1
RAM:0062 ??	     saucerShotDirection:	     .block 1
RAM:0063 ??	     btn_edge_debounce:		     .block 1
RAM:0064 ??	     shipHorizontalVelocityLow:	     .block 1
RAM:0065 ??	     shipVerticalVelocityLow:	     .block 1
RAM:0066 ??	     timerPlayerFireSound:	     .block 1
RAM:0067 ??	     timerSaucerFireSound:	     .block 1
RAM:0068 ??	     timerBonusShipSound:	     .block 1
RAM:0069 ??	     timerExplosionSound:	     .block 1
RAM:006A ??	     fireSoundFlagPlayer:	     .block 1
RAM:006B ??	     fireSoundFlagSaucer:	     .block 1
RAM:006C ??	     volFreqThumpSound:		     .block 1
RAM:006D ??	     timerThumpSoundOn:		     .block 1
RAM:006E ??	     timerThumpSoundOff:	     .block 1
RAM:006F ??	     io3200ShadowRegister:	     .block 1
RAM:0070 ??	     CurrNumCredits:		     .block 1
RAM:0071	     ; 4=center_mult, 3..2=right_mult, 1..0=coinage
RAM:0071 ??	     coinMultCredits:		     .block 1
RAM:0072 ??	     slamSwitchFlag:		     .block 1
RAM:0073 ??	     totalCoinsForCredits:	     .block 1
RAM:0074 ??	     byte_74:			     .block 1
RAM:0075 ??	     byte_75:			     .block 1
RAM:0076 ??	     byte_76:			     .block 1
RAM:0077 ??	     unk_77:			     .block 1
RAM:0078 ??					     .block 1
RAM:0079 ??					     .block 1
RAM:007A ??	     coin_1_inp_length:		     .block 1
RAM:007B ??	     coin_2_inp_length:		     .block 1
RAM:007C ??	     coin_3_inp_length:		     .block 1
RAM:007D ??					     .block 1
RAM:007E ??					     .block 1
RAM:007F ??					     .block 1
RAM:0080 ?? ?? ?? ??+				     .block 80h
RAM:0100 ?? ?? ?? ??+stack:			     .block 100h
RAM:0200 ?? ?? ?? ??+P1RAM:			     .block 1Bh			     ; Asteroids 1-27
RAM:021B	     ; p1PlayerFlag
RAM:021B	     ; - 0x00  = in hyperspace?
RAM:021B	     ; - 0x01  = player	alive and active
RAM:021B	     ; - 0xA0+ = player	exploding
RAM:021B ??	     p1PlayerFlag:		     .block 1
RAM:021C	     ; p1SaucerFlag
RAM:021C	     ; - 0x00  = no saucer
RAM:021C	     ; - 0x01  = small saucer
RAM:021C	     ; - 0x02  = large saucer
RAM:021C	     ; - 0xA0+ = saucer	exploding
RAM:021C ??	     p1SaucerFlag:		     .block 1
RAM:021D ??	     saucerShotTimer1:		     .block 1
RAM:021E ??	     saucerShotTimer2:		     .block 1
RAM:021F ??	     p1TimerShot0:		     .block 1
RAM:0220 ??	     p1TimerShot1:		     .block 1
RAM:0221 ??	     p1TimerShot2:		     .block 1
RAM:0222 ??	     p1TimerShot3:		     .block 1
RAM:0223	     ; Horizontal Velocity 0-255 (255-192)=Left, 1-63=Right
RAM:0223 ?? ?? ?? ??+asteroid_Vh:		     .block 1Bh
RAM:023E ??	     ship_Vh:			     .block 1
RAM:023F ??	     saucer_Vh:			     .block 1
RAM:0240 ?? ??	     saucerShot_Vh:		     .block 2
RAM:0242 ?? ?? ?? ?? shipShot_Vh:		     .block 4
RAM:0246	     ; Vertical	Velocity 0-255 (255-192)=Down, 1-63=Up
RAM:0246 ?? ?? ?? ??+asteroid_Vv:		     .block 1Bh
RAM:0261 ??	     ship_Vv:			     .block 1
RAM:0262 ??	     saucer_Vv:			     .block 1
RAM:0263 ?? ??	     saucerShot_Vv:		     .block 2
RAM:0265 ?? ?? ?? ?? shipShot_Vv:		     .block 4
RAM:0269	     ; Horiztonal Position High	(0-31) 0=Left, 31=Right
RAM:0269 ?? ?? ?? ??+asteroid_PHh:		     .block 1Bh
RAM:0284 ??	     ship_PHh:			     .block 1
RAM:0285 ??	     saucer_PHh:		     .block 1
RAM:0286 ?? ??	     saucerShot_PHh:		     .block 2
RAM:0288 ?? ?? ?? ?? shipShot_PHh:		     .block 4
RAM:028C	     ; Vertical	Position High (0-23), 0=Bottom,	23=Top
RAM:028C ?? ?? ?? ??+asteroid_PHv:		     .block 1Bh
RAM:02A7 ??	     ship_PHv:			     .block 1
RAM:02A8 ??	     saucer_PHv:		     .block 1
RAM:02A9 ?? ??	     saucerShot_PHv:		     .block 2
RAM:02AB ?? ?? ?? ?? shotShot_PHv:		     .block 4
RAM:02AF	     ; Horizontal Position Low (0-255),	0=Left,	255=Right
RAM:02AF ?? ?? ?? ??+asteroid_PLh:		     .block 1Bh
RAM:02CA ??	     ship_PLh:			     .block 1
RAM:02CB ??	     saucer_PLh:		     .block 1
RAM:02CC ?? ??	     saucerShot_PLh:		     .block 2
RAM:02CE ?? ?? ?? ?? shipShot_PLh:		     .block 4
RAM:02D2	     ; Vertical	Position Low (0-255), 0=Bottom,	255=Top
RAM:02D2 ?? ?? ?? ??+asteroid_PLv:		     .block 1Bh
RAM:02ED ??	     ship_PLv:			     .block 1
RAM:02EE ??	     saucer_PLv:		     .block 1
RAM:02EF ?? ??	     saucerShot_PLv:		     .block 2
RAM:02F1 ?? ?? ?? ?? shipShot_PLv:		     .block 4
RAM:02F5 ??	     startingAsteroidsPerWave:	     .block 1
RAM:02F6 ??	     currentNumberOfAsteroids:	     .block 1
RAM:02F7 ??	     saucerCountdownTimer:	     .block 1
RAM:02F8 ??	     starting_saucerCountdownTimer:  .block 1
RAM:02F9 ??	     byte_2F9:			     .block 1			     ; ???goes up after	explosion???
RAM:02FA ??	     shipSpawnTimer:		     .block 1
RAM:02FB ??	     asteroidWaveTimer:		     .block 1
RAM:02FC ??	     byte_2FC:			     .block 1
RAM:02FD ??	     byte_2FD:			     .block 1			     ; ???goes up by 1 per wave???
RAM:02FE ??					     .block 1
RAM:02FF ??					     .block 1
RAM:0300	     ; this gets bank-switched into the	same address space
RAM:0300	     ; as the P1RAM block to save on code
RAM:0300 ?? ?? ?? ??+P2RAM:			     .block 100h
RAM:0300 ?? ?? ?? ??+; end of 'RAM'
RAM:0300 ?? ?? ?? ??+
IN0:2000	     ; ===========================================================================
IN0:2000
IN0:2000	     ; Segment type: Regular
IN0:2000					     ;.segment IN0
IN0:2000					     .org 2000h
IN0:2000 ??					     .block 1
IN0:2001 ??	     freq3kHz:			     .block 1
IN0:2002 ??	     halt:			     .block 1
IN0:2003 ??	     hyperspaceSwitch:		     .block 1
IN0:2004 ??	     FireSwitch:		     .block 1
IN0:2005 ??	     diagStep:			     .block 1
IN0:2006 ??	     slamSwitch:		     .block 1
IN0:2007 ??	     selfTest:			     .block 1
IN0:2007	     ; end of 'IN0'
IN0:2007
IN1:2400	     ; ===========================================================================
IN1:2400
IN1:2400	     ; Segment type: Regular
IN1:2400					     ;.segment IN1
IN1:2400					     .org 2400h
IN1:2400 ??	     leftCoinSwitch:		     .block 1
IN1:2401 ??	     centerCoinSwitch:		     .block 1
IN1:2402 ??	     rightCoinSwitch:		     .block 1
IN1:2403 ??	     p1StartSwitch:		     .block 1
IN1:2404 ??	     p2StartSwitch:		     .block 1
IN1:2405 ??	     thrustSwitch:		     .block 1
IN1:2406 ??	     rotateRightSwitch:		     .block 1
IN1:2407 ??	     rotateLeftSwitch:		     .block 1
IN1:2407	     ; end of 'IN1'
IN1:2407
DSW1:2800	      ;	0 = Free Play, 1 = 1 Coin 2 Credits, 2 = 1 Coin	1 Credit, 3 = 2	Coins 1	Credit
DSW1:2800	      ;	===========================================================================
DSW1:2800
DSW1:2800	      ;	Segment	type: Regular
DSW1:2800					      ;.segment	DSW1
DSW1:2800					      .org 2800h
DSW1:2800 ??	      coinage:			      .block 1
DSW1:2801	      ;	0 = 1x & 4, 1 =	1x & 3,	2 = 2x & 4, 3 =	2x & 3
DSW1:2801 ??	      rightCoinMultiplier:	      .block 1
DSW1:2802 ??	      centerCoinMultiplierAndLives:   .block 1
DSW1:2803 ??	      language:			      .block 1
DSW1:2803	      ;	end of 'DSW1'
DSW1:2803
DVGRAM:4000		; ===========================================================================
DVGRAM:4000
DVGRAM:4000		; Segment type:	Regular
DVGRAM:4000						;.segment DVGRAM
DVGRAM:4000						.org 4000h
DVGRAM:4000 ?? ?? ?? ??+DVGRAM:				.block 800h
DVGRAM:4000 ?? ?? ?? ??+; end of 'DVGRAM'
DVGRAM:4000 ?? ?? ?? ??+
DVGROM:5000		; ===========================================================================
DVGROM:5000
DVGROM:5000		; Segment type:	Regular
DVGROM:5000						;.segment DVGROM
DVGROM:5000						.org 5000h
DVGROM:5000 ?? ?? ?? ??+DVGROM:				.block 800h
DVGROM:5000 ?? ?? ?? ??+; end of 'DVGROM'
DVGROM:5000 ?? ?? ?? ??+
ROM:6800	     ; ---------------------------------------------------------------------------
ROM:6800	     ; ===========================================================================
ROM:6800
ROM:6800	     ; Segment type: Pure code
ROM:6800					     ;.segment ROM
ROM:6800					     .org 6800h
ROM:6800 4C F3 7C				     JMP     RESET		     ; Debugger? Off in	the weeds? Do Reset.
ROM:6803	     ; ---------------------------------------------------------------------------
ROM:6803
ROM:6803	     START:							     ; Reset Sound, Zero Out Sound Timers
ROM:6803 20 FA 6E				     JSR     init_sound
ROM:6806 20 D8 6E				     JSR     init_players	     ; init ships and scores
ROM:6809
ROM:6809	     main_outer_loop:
ROM:6809 20 68 71				     JSR     calc_rnd_stuff
ROM:680C
ROM:680C	     main_inner_loop:						     ; self test switch	on?
ROM:680C AD 07 20				     LDA     selfTest
ROM:680F
ROM:680F	     spin:							     ; yes, spin
ROM:680F 30 FE					     BMI     spin
ROM:6811 46 5B					     LSR     VBLANK_triggered	     ; 4xNMI happened?
ROM:6813 90 F7					     BCC     main_inner_loop	     ; no, busy	wait
ROM:6815
ROM:6815	     loc_6815:							     ; HALT
ROM:6815 AD 02 20				     LDA     halt
ROM:6818 30 FB					     BMI     loc_6815		     ; wait for	DVG
ROM:681A AD 01 40				     LDA     DVGRAM+1
ROM:681D 49 02					     EOR     #2			     ; JMP $0402<->$0002
ROM:681F 8D 01 40				     STA     DVGRAM+1
ROM:6822 8D 00 30				     STA     3000h		     ; Start DVG
ROM:6825 8D 00 34				     STA     3400h		     ; Reset Watchdog
ROM:6828 E6 5C					     INC     fastTimer		     ; Update Fast Timer
ROM:682A D0 02					     BNE     loc_682E
ROM:682C E6 5D					     INC     slowTimer		     ; Update Slow Timer
ROM:682E
ROM:682E	     loc_682E:							     ; ping-pong DVG RAM $4000/$4400
ROM:682E A2 40					     LDX     #40h ; '@'
ROM:6830 29 02					     AND     #2
ROM:6832 D0 02					     BNE     loc_6836
ROM:6834 A2 44					     LDX     #44h ; 'D'
ROM:6836
ROM:6836	     loc_6836:
ROM:6836 A9 02					     LDA     #2
ROM:6838 85 02					     STA     dvg_curr_addr_lsb	     ; 0x02 (after JMP instruction)
ROM:683A 86 03					     STX     dvg_curr_addr_msb	     ; 0x40/0x44 (ping pong)
ROM:683C 20 85 68				     JSR     handle_start_end_turn_or_game
ROM:683F B0 C2					     BCS     START		     ; *** never set?!?	***
ROM:6841 20 5C 76				     JSR     check_high_score
ROM:6844 20 90 6D				     JSR     handle_high_score_entry
ROM:6847 10 1B					     BPL     loc_6864		     ; go if new high score
ROM:6849 20 C4 73				     JSR     display_high_score_table
ROM:684C B0 16					     BCS     loc_6864		     ; game not	active,	skip
ROM:684E A5 5A					     LDA     timerStartGame	     ; waiting to start	game?
ROM:6850 D0 0C					     BNE     loc_685E		     ; yes, skip
ROM:6852 20 D7 6C				     JSR     handle_fire
ROM:6855 20 74 6E				     JSR     handle_hyperspace
ROM:6858 20 3F 70				     JSR     handle_left_right_thrust
ROM:685B 20 93 6B				     JSR     handle_saucer
ROM:685E
ROM:685E	     loc_685E:							     ; ???
ROM:685E 20 57 6F				     JSR     handle_objects
ROM:6861 20 F0 69				     JSR     handle_shots_2	     ; ???
ROM:6864
ROM:6864	     loc_6864:							     ; display (C), scores, extra ships
ROM:6864 20 4F 72				     JSR     display_C_scores_ships
ROM:6867 20 55 75				     JSR     handle_sounds
ROM:686A A9 7F					     LDA     #7Fh ; ''              ; X=0x7F
ROM:686C AA					     TAX			     ; Y=0x7F
ROM:686D 20 03 7C				     JSR     write_CURx4_cmd
ROM:6870 20 B5 77				     JSR     update_prng
ROM:6873 20 C0 7B				     JSR     halt_dvg		     ; finished	rendering
ROM:6876 AD FB 02				     LDA     asteroidWaveTimer
ROM:6879 F0 03					     BEQ     loc_687E		     ; zero, skip
ROM:687B CE FB 02				     DEC     asteroidWaveTimer
ROM:687E
ROM:687E	     loc_687E:							     ; both zero?
ROM:687E 0D F6 02				     ORA     currentNumberOfAsteroids
ROM:6881 D0 89					     BNE     main_inner_loop	     ; no, go
ROM:6883 F0 84					     BEQ     main_outer_loop
ROM:6885
ROM:6885	     ; =============== S U B R O U T I N E =======================================
ROM:6885
ROM:6885
ROM:6885	     handle_start_end_turn_or_game:
ROM:6885 A5 1C					     LDA     numPlayers		     ; game active?
ROM:6887 F0 14					     BEQ     check_freeplay	     ; no, skip
ROM:6889 A5 5A					     LDA     timerStartGame	     ; Time before next	player starts
ROM:688B D0 03					     BNE     display_current_player  ; timer running, go
ROM:688D 4C 60 69				     JMP     handle_end_turn_or_game ; game active (playing)
ROM:6890	     ; ---------------------------------------------------------------------------
ROM:6890
ROM:6890	     display_current_player:					     ; update timer
ROM:6890 C6 5A					     DEC     timerStartGame
ROM:6892 20 E2 69				     JSR     print_PLAYER_N	     ; show current player
ROM:6895
ROM:6895	     loc_6895:
ROM:6895 18					     CLC
ROM:6896 60					     RTS
ROM:6897	     ; ---------------------------------------------------------------------------
ROM:6897
ROM:6897	     freeplay:							     ; Free Credits!
ROM:6897 A9 02					     LDA     #2
ROM:6899 85 70					     STA     CurrNumCredits	     ; Can Only	Play A 2 Player	Game, So Only Need To Add 2
ROM:689B D0 13					     BNE     check_start	     ; go
ROM:689D
ROM:689D	     check_freeplay:						     ; DIP Switch Settings Bitmap
ROM:689D A5 71					     LDA     coinMultCredits
ROM:689F 29 03					     AND     #3			     ; coinage only. freeplay?
ROM:68A1 F0 F4					     BEQ     freeplay		     ; yes, go
ROM:68A3 18					     CLC
ROM:68A4 69 07					     ADC     #7			     ; calc coinage message
ROM:68A6 A8					     TAY			     ; Into Y for the offset
ROM:68A7 A5 32					     LDA     placeP1HighScore
ROM:68A9 25 33					     AND     placeP2HighScore
ROM:68AB 10 03					     BPL     check_start
ROM:68AD 20 F6 77				     JSR     PrintPackedMsg	     ; display coinage
ROM:68B0
ROM:68B0	     check_start:						     ; credits?
ROM:68B0 A4 70					     LDY     CurrNumCredits
ROM:68B2 F0 E1					     BEQ     loc_6895		     ; no, return
ROM:68B4 A2 01					     LDX     #1			     ; 1 player
ROM:68B6 AD 03 24				     LDA     p1StartSwitch	     ; P1 start	pressed?
ROM:68B9 30 23					     BMI     start_game		     ; yes, go
ROM:68BB C0 02					     CPY     #2			     ; >=2 credits available?
ROM:68BD 90 7C					     BCC     display_push_start	     ; no, exit
ROM:68BF AD 04 24				     LDA     p2StartSwitch	     ; P2 start	pressed?
ROM:68C2 10 77					     BPL     display_push_start	     ; no, exit
ROM:68C4 A5 6F					     LDA     io3200ShadowRegister
ROM:68C6 09 04					     ORA     #4			     ; RAMSEL=1	(P2)
ROM:68C8 85 6F					     STA     io3200ShadowRegister
ROM:68CA 8D 00 32				     STA     3200h		     ; output
ROM:68CD 20 D8 6E				     JSR     init_players
ROM:68D0 20 68 71				     JSR     calc_rnd_stuff
ROM:68D3 20 E8 71				     JSR     sub_71E8
ROM:68D6 A5 56					     LDA     numStartingShipsPerGame
ROM:68D8 85 58					     STA     numShipsP2
ROM:68DA A2 02					     LDX     #2			     ; 2 players
ROM:68DC C6 70					     DEC     CurrNumCredits
ROM:68DE
ROM:68DE	     start_game:
ROM:68DE 86 1C					     STX     numPlayers
ROM:68E0 C6 70					     DEC     CurrNumCredits
ROM:68E2 A5 6F					     LDA     io3200ShadowRegister
ROM:68E4 29 F8					     AND     #0F8h ; '¯'             ; RAMSEL=0 (P1), lamps OFF
ROM:68E6 45 1C					     EOR     numPlayers		     ; player lamp ON
ROM:68E8 85 6F					     STA     io3200ShadowRegister
ROM:68EA 8D 00 32				     STA     3200h		     ; output
ROM:68ED 20 E8 71				     JSR     sub_71E8
ROM:68F0 A9 01					     LDA     #1
ROM:68F2 8D FA 02				     STA     shipSpawnTimer
ROM:68F5 8D FA 03				     STA     P2RAM+0FAh
ROM:68F8 A9 92					     LDA     #92h ; 'í'
ROM:68FA 8D F8 02				     STA     starting_saucerCountdownTimer
ROM:68FD 8D F8 03				     STA     P2RAM+0F8h
ROM:6900 8D F7 03				     STA     P2RAM+0F7h
ROM:6903 8D F7 02				     STA     saucerCountdownTimer
ROM:6906 A9 7F					     LDA     #7Fh ; ''
ROM:6908 8D FB 02				     STA     asteroidWaveTimer
ROM:690B 8D FB 03				     STA     P2RAM+0FBh
ROM:690E A9 05					     LDA     #5
ROM:6910 8D FD 02				     STA     byte_2FD
ROM:6913 8D FD 03				     STA     P2RAM+0FDh
ROM:6916 A9 FF					     LDA     #0FFh
ROM:6918 85 32					     STA     placeP1HighScore	     ; flag no high score
ROM:691A 85 33					     STA     placeP2HighScore	     ; flag no high score
ROM:691C A9 80					     LDA     #80h ; 'Ä'
ROM:691E 85 5A					     STA     timerStartGame	     ; init timer
ROM:6920 0A					     ASL     A			     ; A=0
ROM:6921 85 18					     STA     curPlayer		     ; init current player
ROM:6923 85 19					     STA     curPlayer_x2
ROM:6925 A5 56					     LDA     numStartingShipsPerGame
ROM:6927 85 57					     STA     numShipsP1		     ; init number of ships
ROM:6929 A9 04					     LDA     #4
ROM:692B 85 6C					     STA     volFreqThumpSound
ROM:692D 85 6E					     STA     timerThumpSoundOff	     ; init thump sound
ROM:692F A9 30					     LDA     #30h ; '0'
ROM:6931 8D FC 02				     STA     byte_2FC
ROM:6934 8D FC 03				     STA     P2RAM+0FCh
ROM:6937 8D 00 3E				     STA     3E00h		     ; sound (noise reset)
ROM:693A 60					     RTS
ROM:693B	     ; ---------------------------------------------------------------------------
ROM:693B
ROM:693B	     display_push_start:
ROM:693B A5 32					     LDA     placeP1HighScore
ROM:693D 25 32					     AND     placeP1HighScore
ROM:693F 10 0B					     BPL     loc_694C
ROM:6941 A5 5C					     LDA     fastTimer
ROM:6943 29 20					     AND     #20h ; ' '              ; display phase?
ROM:6945 D0 05					     BNE     loc_694C		     ; no, skip
ROM:6947 A0 06					     LDY     #6			     ; "PUSH START"
ROM:6949 20 F6 77				     JSR     PrintPackedMsg
ROM:694C
ROM:694C	     loc_694C:
ROM:694C A5 5C					     LDA     fastTimer
ROM:694E 29 0F					     AND     #0Fh
ROM:6950 D0 0C					     BNE     loc_695E
ROM:6952 A9 01					     LDA     #1
ROM:6954 C5 70					     CMP     CurrNumCredits
ROM:6956 69 01					     ADC     #1
ROM:6958 49 01					     EOR     #1
ROM:695A 45 6F					     EOR     io3200ShadowRegister
ROM:695C 85 6F					     STA     io3200ShadowRegister
ROM:695E
ROM:695E	     loc_695E:
ROM:695E 18					     CLC
ROM:695F 60					     RTS
ROM:6960	     ; ---------------------------------------------------------------------------
ROM:6960
ROM:6960	     handle_end_turn_or_game:
ROM:6960 A5 5C					     LDA     fastTimer
ROM:6962 29 3F					     AND     #3Fh ; '?'
ROM:6964 D0 0A					     BNE     loc_6970
ROM:6966 AD FC 02				     LDA     byte_2FC
ROM:6969 C9 08					     CMP     #8
ROM:696B F0 03					     BEQ     loc_6970
ROM:696D CE FC 02				     DEC     byte_2FC
ROM:6970
ROM:6970	     loc_6970:
ROM:6970 A6 18					     LDX     curPlayer
ROM:6972 B5 57					     LDA     numShipsP1,X	     ; any ships left?
ROM:6974 D0 1C					     BNE     toggle_player	     ; yes, skip
ROM:6976 AD 1F 02				     LDA     p1TimerShot0
ROM:6979 0D 20 02				     ORA     p1TimerShot1
ROM:697C 0D 21 02				     ORA     p1TimerShot2
ROM:697F 0D 22 02				     ORA     p1TimerShot3	     ; shot(s) still active?
ROM:6982 D0 0E					     BNE     toggle_player	     ; yes, skip
ROM:6984 A0 07					     LDY     #7			     ; "GAME OVER"
ROM:6986 20 F6 77				     JSR     PrintPackedMsg
ROM:6989 A5 1C					     LDA     numPlayers
ROM:698B C9 02					     CMP     #2			     ; 2 player	game?
ROM:698D 90 03					     BCC     toggle_player	     ; no, skip
ROM:698F 20 E2 69				     JSR     print_PLAYER_N	     ; display player
ROM:6992
ROM:6992	     toggle_player:						     ; player alive?
ROM:6992 AD 1B 02				     LDA     p1PlayerFlag
ROM:6995 D0 36					     BNE     loc_69CD		     ; yes, skip
ROM:6997 AD FA 02				     LDA     shipSpawnTimer
ROM:699A C9 80					     CMP     #80h ; 'Ä'
ROM:699C D0 2F					     BNE     loc_69CD
ROM:699E A9 10					     LDA     #10h
ROM:69A0 8D FA 02				     STA     shipSpawnTimer
ROM:69A3 A6 1C					     LDX     numPlayers
ROM:69A5 A5 57					     LDA     numShipsP1
ROM:69A7 05 58					     ORA     numShipsP2		     ; either play have	ships left?
ROM:69A9 F0 24					     BEQ     loc_69CF		     ; no, exit
ROM:69AB 20 2D 70				     JSR     sub_702D
ROM:69AE CA					     DEX			     ; 1 player	game?
ROM:69AF F0 1C					     BEQ     loc_69CD		     ; yes, exit
ROM:69B1 A9 80					     LDA     #80h ; 'Ä'
ROM:69B3 85 5A					     STA     timerStartGame
ROM:69B5 A5 18					     LDA     curPlayer
ROM:69B7 49 01					     EOR     #1			     ; toggler player
ROM:69B9 AA					     TAX
ROM:69BA B5 57					     LDA     numShipsP1,X	     ; other player have any ships left?
ROM:69BC F0 0F					     BEQ     loc_69CD		     ; no, exit
ROM:69BE 86 18					     STX     curPlayer		     ; update current player
ROM:69C0 A9 04					     LDA     #4			     ; RAMSEL
ROM:69C2 45 6F					     EOR     io3200ShadowRegister    ; toggle
ROM:69C4 85 6F					     STA     io3200ShadowRegister
ROM:69C6 8D 00 32				     STA     3200h		     ; output
ROM:69C9 8A					     TXA
ROM:69CA 0A					     ASL     A			     ; current player *	2
ROM:69CB 85 19					     STA     curPlayer_x2
ROM:69CD
ROM:69CD	     loc_69CD:
ROM:69CD 18					     CLC
ROM:69CE 60					     RTS
ROM:69CF	     ; ---------------------------------------------------------------------------
ROM:69CF
ROM:69CF	     loc_69CF:
ROM:69CF 86 1A					     STX     numPlayersPreviousGame
ROM:69D1 A9 FF					     LDA     #0FFh
ROM:69D3 85 1C					     STA     numPlayers		     ; invalidate
ROM:69D5 20 FA 6E				     JSR     init_sound
ROM:69D8 A5 6F					     LDA     io3200ShadowRegister
ROM:69DA 29 F8					     AND     #0F8h ; '¯'             ; RAMSEL=0, lamps OFF
ROM:69DC 09 03					     ORA     #3			     ; lamps ON
ROM:69DE 85 6F					     STA     io3200ShadowRegister
ROM:69E0 18					     CLC
ROM:69E1 60					     RTS
ROM:69E1	     ; End of function handle_start_end_turn_or_game
ROM:69E1
ROM:69E2
ROM:69E2	     ; =============== S U B R O U T I N E =======================================
ROM:69E2
ROM:69E2
ROM:69E2	     print_PLAYER_N:
ROM:69E2 A0 01					     LDY     #1			     ; "PLAYER"
ROM:69E4 20 F6 77				     JSR     PrintPackedMsg
ROM:69E7 A4 18					     LDY     curPlayer
ROM:69E9 C8					     INY
ROM:69EA 98					     TYA
ROM:69EB 20 D1 7B				     JSR     display_digit_A
ROM:69EE 60					     RTS
ROM:69EE	     ; End of function print_PLAYER_N
ROM:69EE
ROM:69EE	     ; ---------------------------------------------------------------------------
ROM:69EF 71					     .db  71h ;	q
ROM:69F0
ROM:69F0	     ; =============== S U B R O U T I N E =======================================
ROM:69F0
ROM:69F0
ROM:69F0	     handle_shots_2:
ROM:69F0 A2 07					     LDX     #7			     ; values to check
ROM:69F2
ROM:69F2	     loc_69F2:							     ; timer/flag
ROM:69F2 BD 1B 02				     LDA     p1PlayerFlag,X
ROM:69F5 F0 02					     BEQ     loc_69F9		     ; not active, skip
ROM:69F7 10 04					     BPL     loc_69FD		     ; active, go
ROM:69F9
ROM:69F9	     loc_69F9:							     ; next timer
ROM:69F9 CA					     DEX
ROM:69FA 10 F6					     BPL     loc_69F2		     ; loop 'til done
ROM:69FC 60					     RTS
ROM:69FD	     ; ---------------------------------------------------------------------------
ROM:69FD
ROM:69FD	     loc_69FD:
ROM:69FD A0 1C					     LDY     #1Ch
ROM:69FF E0 04					     CPX     #4			     ; shot timer?
ROM:6A01 B0 07					     BCS     loc_6A0A		     ; yes, go
ROM:6A03 88					     DEY
ROM:6A04 8A					     TXA
ROM:6A05 D0 03					     BNE     loc_6A0A
ROM:6A07
ROM:6A07	     loc_6A07:
ROM:6A07 88					     DEY
ROM:6A08 30 EF					     BMI     loc_69F9
ROM:6A0A
ROM:6A0A	     loc_6A0A:
ROM:6A0A B9 00 02				     LDA     P1RAM,Y
ROM:6A0D F0 F8					     BEQ     loc_6A07
ROM:6A0F 30 F6					     BMI     loc_6A07
ROM:6A11 85 0B					     STA     byte_B
ROM:6A13 B9 AF 02				     LDA     asteroid_PLh,Y
ROM:6A16 38					     SEC
ROM:6A17 FD CA 02				     SBC     ship_PLh,X
ROM:6A1A 85 08					     STA     byte_8
ROM:6A1C B9 69 02				     LDA     asteroid_PHh,Y
ROM:6A1F FD 84 02				     SBC     ship_PHh,X
ROM:6A22 4A					     LSR     A
ROM:6A23 66 08					     ROR     byte_8
ROM:6A25 0A					     ASL     A
ROM:6A26 F0 0C					     BEQ     loc_6A34
ROM:6A28 10 6D					     BPL     loc_6A97
ROM:6A2A 49 FE					     EOR     #0FEh ; '˛'
ROM:6A2C D0 69					     BNE     loc_6A97
ROM:6A2E A5 08					     LDA     byte_8
ROM:6A30 49 FF					     EOR     #0FFh
ROM:6A32 85 08					     STA     byte_8
ROM:6A34
ROM:6A34	     loc_6A34:
ROM:6A34 B9 D2 02				     LDA     asteroid_PLv,Y
ROM:6A37 38					     SEC
ROM:6A38 FD ED 02				     SBC     ship_PLv,X
ROM:6A3B 85 09					     STA     byte_9
ROM:6A3D B9 8C 02				     LDA     asteroid_PHv,Y
ROM:6A40 FD A7 02				     SBC     ship_PHv,X
ROM:6A43 4A					     LSR     A
ROM:6A44 66 09					     ROR     byte_9
ROM:6A46 0A					     ASL     A
ROM:6A47 F0 0C					     BEQ     loc_6A55
ROM:6A49 10 4C					     BPL     loc_6A97
ROM:6A4B 49 FE					     EOR     #0FEh ; '˛'
ROM:6A4D D0 48					     BNE     loc_6A97
ROM:6A4F A5 09					     LDA     byte_9
ROM:6A51 49 FF					     EOR     #0FFh
ROM:6A53 85 09					     STA     byte_9
ROM:6A55
ROM:6A55	     loc_6A55:
ROM:6A55 A9 2A					     LDA     #2Ah ; '*'
ROM:6A57 46 0B					     LSR     byte_B
ROM:6A59 B0 08					     BCS     loc_6A63
ROM:6A5B A9 48					     LDA     #48h ; 'H'
ROM:6A5D 46 0B					     LSR     byte_B
ROM:6A5F B0 02					     BCS     loc_6A63
ROM:6A61 A9 84					     LDA     #84h ; 'Ñ'
ROM:6A63
ROM:6A63	     loc_6A63:
ROM:6A63 E0 01					     CPX     #1
ROM:6A65 B0 02					     BCS     loc_6A69
ROM:6A67 69 1C					     ADC     #1Ch
ROM:6A69
ROM:6A69	     loc_6A69:
ROM:6A69 D0 0C					     BNE     loc_6A77
ROM:6A6B 69 12					     ADC     #12h
ROM:6A6D AE 1C 02				     LDX     p1SaucerFlag
ROM:6A70 CA					     DEX
ROM:6A71 F0 02					     BEQ     loc_6A75
ROM:6A73 69 12					     ADC     #12h
ROM:6A75
ROM:6A75	     loc_6A75:
ROM:6A75 A2 01					     LDX     #1
ROM:6A77
ROM:6A77	     loc_6A77:
ROM:6A77 C5 08					     CMP     byte_8
ROM:6A79 90 1C					     BCC     loc_6A97
ROM:6A7B C5 09					     CMP     byte_9
ROM:6A7D 90 18					     BCC     loc_6A97
ROM:6A7F 85 0B					     STA     byte_B
ROM:6A81 4A					     LSR     A
ROM:6A82 18					     CLC
ROM:6A83 65 0B					     ADC     byte_B
ROM:6A85 85 0B					     STA     byte_B
ROM:6A87 A5 09					     LDA     byte_9
ROM:6A89 65 08					     ADC     byte_8
ROM:6A8B B0 0A					     BCS     loc_6A97
ROM:6A8D C5 0B					     CMP     byte_B
ROM:6A8F B0 06					     BCS     loc_6A97
ROM:6A91 20 0F 6B				     JSR     sub_6B0F
ROM:6A94
ROM:6A94	     loc_6A94:
ROM:6A94 4C F9 69				     JMP     loc_69F9
ROM:6A97	     ; ---------------------------------------------------------------------------
ROM:6A97
ROM:6A97	     loc_6A97:
ROM:6A97 88					     DEY
ROM:6A98 30 FA					     BMI     loc_6A94
ROM:6A9A 4C 0A 6A				     JMP     loc_6A0A
ROM:6A9A	     ; End of function handle_shots_2
ROM:6A9A
ROM:6A9D
ROM:6A9D	     ; =============== S U B R O U T I N E =======================================
ROM:6A9D
ROM:6A9D
ROM:6A9D	     sub_6A9D:
ROM:6A9D B9 00 02				     LDA     P1RAM,Y
ROM:6AA0 29 07					     AND     #7
ROM:6AA2 85 08					     STA     byte_8
ROM:6AA4 20 B5 77				     JSR     update_prng
ROM:6AA7 29 18					     AND     #18h
ROM:6AA9 05 08					     ORA     byte_8
ROM:6AAB 9D 00 02				     STA     P1RAM,X
ROM:6AAE B9 AF 02				     LDA     asteroid_PLh,Y
ROM:6AB1 9D AF 02				     STA     asteroid_PLh,X
ROM:6AB4 B9 69 02				     LDA     asteroid_PHh,Y
ROM:6AB7 9D 69 02				     STA     asteroid_PHh,X
ROM:6ABA B9 D2 02				     LDA     asteroid_PLv,Y
ROM:6ABD 9D D2 02				     STA     asteroid_PLv,X
ROM:6AC0 B9 8C 02				     LDA     asteroid_PHv,Y
ROM:6AC3 9D 8C 02				     STA     asteroid_PHv,X
ROM:6AC6 B9 23 02				     LDA     asteroid_Vh,Y
ROM:6AC9 9D 23 02				     STA     asteroid_Vh,X
ROM:6ACC B9 46 02				     LDA     asteroid_Vv,Y
ROM:6ACF 9D 46 02				     STA     asteroid_Vv,X
ROM:6AD2 60					     RTS
ROM:6AD2	     ; End of function sub_6A9D
ROM:6AD2
ROM:6AD3
ROM:6AD3	     ; =============== S U B R O U T I N E =======================================
ROM:6AD3
ROM:6AD3
ROM:6AD3	     copy_vector_from_table_to_avgram:
ROM:6AD3 85 0B					     STA     byte_B		     ; table address (LSB)
ROM:6AD5 86 0C					     STX     byte_C		     ; table address (MSB)
ROM:6AD5	     ; End of function copy_vector_from_table_to_avgram
ROM:6AD5
ROM:6AD7
ROM:6AD7	     ; =============== S U B R O U T I N E =======================================
ROM:6AD7
ROM:6AD7
ROM:6AD7	     copy_vector_to_avgram:
ROM:6AD7 A0 00					     LDY     #0
ROM:6AD9
ROM:6AD9	     loc_6AD9:
ROM:6AD9 C8					     INY
ROM:6ADA B1 0B					     LDA     (byte_B),Y		     ; SSSS -mYY (VEC) / 1111 smYY (SVEC)
ROM:6ADC 45 09					     EOR     byte_9		     ; flag for	flip Y (bit 2)
ROM:6ADE 91 02					     STA     (2),Y		     ; store in	avg ram	(cmd)
ROM:6AE0 88					     DEY
ROM:6AE1 C9 F0					     CMP     #0F0h ; ''             ; SVEC?
ROM:6AE3 B0 1E					     BCS     is_svec		     ; yes, go
ROM:6AE5 C9 A0					     CMP     #0A0h ; '†'             ; VEC?
ROM:6AE7 B0 16					     BCS     loc_6AFF		     ; no, exit
ROM:6AE9 B1 0B					     LDA     (byte_B),Y		     ; YYYY YYYY
ROM:6AEB 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:6AED C8					     INY
ROM:6AEE C8					     INY
ROM:6AEF B1 0B					     LDA     (byte_B),Y		     ; XXXX XXXX
ROM:6AF1 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:6AF3 C8					     INY
ROM:6AF4 B1 0B					     LDA     (byte_B),Y		     ; BBBB -mXX
ROM:6AF6 45 08					     EOR     byte_8		     ; sign for	X delta
ROM:6AF8 65 17					     ADC     byte_17
ROM:6AFA 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:6AFC
ROM:6AFC	     loc_6AFC:
ROM:6AFC C8					     INY
ROM:6AFD D0 DA					     BNE     loc_6AD9		     ; always
ROM:6AFF
ROM:6AFF	     loc_6AFF:
ROM:6AFF 88					     DEY
ROM:6B00 4C 39 7C				     JMP     update_avg_curr_addr
ROM:6B03	     ; ---------------------------------------------------------------------------
ROM:6B03
ROM:6B03	     is_svec:							     ; BBBB SmXX
ROM:6B03 B1 0B					     LDA     (byte_B),Y
ROM:6B05 45 08					     EOR     byte_8		     ; flag for	flip X (bit 2)
ROM:6B07 18					     CLC
ROM:6B08 65 17					     ADC     byte_17
ROM:6B0A 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:6B0C C8					     INY
ROM:6B0D D0 ED					     BNE     loc_6AFC		     ; always
ROM:6B0D	     ; End of function copy_vector_to_avgram
ROM:6B0D
ROM:6B0F
ROM:6B0F	     ; =============== S U B R O U T I N E =======================================
ROM:6B0F
ROM:6B0F
ROM:6B0F	     sub_6B0F:
ROM:6B0F E0 01					     CPX     #1
ROM:6B11 D0 08					     BNE     loc_6B1B
ROM:6B13 C0 1B					     CPY     #27
ROM:6B15 D0 12					     BNE     loc_6B29
ROM:6B17 A2 00					     LDX     #0
ROM:6B19 A0 1C					     LDY     #28
ROM:6B1B
ROM:6B1B	     loc_6B1B:
ROM:6B1B 8A					     TXA
ROM:6B1C D0 1E					     BNE     loc_6B3C
ROM:6B1E A9 81					     LDA     #81h ; 'Å'
ROM:6B20 8D FA 02				     STA     shipSpawnTimer
ROM:6B23 A6 18					     LDX     curPlayer
ROM:6B25 D6 57					     DEC     numShipsP1,X	     ; dec number of ships
ROM:6B27 A2 00					     LDX     #0
ROM:6B29
ROM:6B29	     loc_6B29:							     ; flag player exploding
ROM:6B29 A9 A0					     LDA     #0A0h ; '†'
ROM:6B2B 9D 1B 02				     STA     p1PlayerFlag,X
ROM:6B2E A9 00					     LDA     #0
ROM:6B30 9D 3E 02				     STA     ship_Vh,X
ROM:6B33 9D 61 02				     STA     ship_Vv,X
ROM:6B36 C0 1B					     CPY     #27
ROM:6B38 90 0D					     BCC     loc_6B47
ROM:6B3A B0 37					     BCS     loc_6B73
ROM:6B3C
ROM:6B3C	     loc_6B3C:
ROM:6B3C A9 00					     LDA     #0
ROM:6B3E 9D 1B 02				     STA     p1PlayerFlag,X
ROM:6B41 C0 1B					     CPY     #27
ROM:6B43 F0 21					     BEQ     loc_6B66
ROM:6B45 B0 2C					     BCS     loc_6B73
ROM:6B47
ROM:6B47	     loc_6B47:
ROM:6B47 20 EC 75				     JSR     sub_75EC
ROM:6B4A
ROM:6B4A	     loc_6B4A:
ROM:6B4A B9 00 02				     LDA     P1RAM,Y
ROM:6B4D 29 03					     AND     #3
ROM:6B4F 49 02					     EOR     #2
ROM:6B51 4A					     LSR     A
ROM:6B52 6A					     ROR     A
ROM:6B53 6A					     ROR     A
ROM:6B54 09 3F					     ORA     #3Fh ; '?'
ROM:6B56 85 69					     STA     timerExplosionSound
ROM:6B58 A9 A0					     LDA     #0A0h ; '†'
ROM:6B5A 99 00 02				     STA     P1RAM,Y
ROM:6B5D A9 00					     LDA     #0
ROM:6B5F 99 23 02				     STA     asteroid_Vh,Y
ROM:6B62 99 46 02				     STA     asteroid_Vv,Y
ROM:6B65 60					     RTS
ROM:6B66	     ; ---------------------------------------------------------------------------
ROM:6B66
ROM:6B66	     loc_6B66:
ROM:6B66 8A					     TXA
ROM:6B67 A6 18					     LDX     curPlayer
ROM:6B69 D6 57					     DEC     numShipsP1,X
ROM:6B6B AA					     TAX
ROM:6B6C A9 81					     LDA     #81h ; 'Å'
ROM:6B6E 8D FA 02				     STA     shipSpawnTimer
ROM:6B71 D0 D7					     BNE     loc_6B4A
ROM:6B73
ROM:6B73	     loc_6B73:
ROM:6B73 AD F8 02				     LDA     starting_saucerCountdownTimer
ROM:6B76 8D F7 02				     STA     saucerCountdownTimer
ROM:6B79 A5 1C					     LDA     numPlayers
ROM:6B7B F0 CD					     BEQ     loc_6B4A
ROM:6B7D 86 0D					     STX     byte_D
ROM:6B7F A6 19					     LDX     curPlayer_x2
ROM:6B81 AD 1C 02				     LDA     p1SaucerFlag
ROM:6B84 4A					     LSR     A			     ; small saucer?
ROM:6B85 A9 99					     LDA     #99h ; 'ô'              ; (99+1)*10 = 1,000 pts
ROM:6B87 B0 02					     BCS     loc_6B8B		     ; yes, skip
ROM:6B89 A9 20					     LDA     #20h ; ' '              ; 20x10 = 200 pts
ROM:6B8B
ROM:6B8B	     loc_6B8B:
ROM:6B8B 20 97 73				     JSR     add_A_to_score
ROM:6B8E A6 0D					     LDX     byte_D
ROM:6B90 4C 4A 6B				     JMP     loc_6B4A
ROM:6B90	     ; End of function sub_6B0F
ROM:6B90
ROM:6B93
ROM:6B93	     ; =============== S U B R O U T I N E =======================================
ROM:6B93
ROM:6B93
ROM:6B93	     handle_saucer:
ROM:6B93 A5 5C					     LDA     fastTimer
ROM:6B95 29 03					     AND     #3			     ; time to update?
ROM:6B97 F0 01					     BEQ     loc_6B9A		     ; yes, go
ROM:6B99
ROM:6B99	     locret_6B99:
ROM:6B99 60					     RTS
ROM:6B9A	     ; ---------------------------------------------------------------------------
ROM:6B9A
ROM:6B9A	     loc_6B9A:
ROM:6B9A AD 1C 02				     LDA     p1SaucerFlag
ROM:6B9D 30 FA					     BMI     locret_6B99	     ; exploding? yes, exit
ROM:6B9F F0 03					     BEQ     handle_new_saucer	     ; no saucer? yes, go
ROM:6BA1 4C 34 6C				     JMP     handle_existing_saucer  ; small/large saucer
ROM:6BA4	     ; ---------------------------------------------------------------------------
ROM:6BA4
ROM:6BA4	     handle_new_saucer:						     ; game active?
ROM:6BA4 A5 1C					     LDA     numPlayers
ROM:6BA6 F0 07					     BEQ     loc_6BAF		     ; no, go
ROM:6BA8 AD 1B 02				     LDA     p1PlayerFlag	     ; player active?
ROM:6BAB F0 EC					     BEQ     locret_6B99	     ; no, return
ROM:6BAD 30 EA					     BMI     locret_6B99	     ; exploding? yes, return
ROM:6BAF
ROM:6BAF	     loc_6BAF:
ROM:6BAF AD F9 02				     LDA     byte_2F9
ROM:6BB2 F0 03					     BEQ     loc_6BB7
ROM:6BB4 CE F9 02				     DEC     byte_2F9
ROM:6BB7
ROM:6BB7	     loc_6BB7:
ROM:6BB7 CE F7 02				     DEC     saucerCountdownTimer
ROM:6BBA D0 DD					     BNE     locret_6B99
ROM:6BBC A9 12					     LDA     #18
ROM:6BBE 8D F7 02				     STA     saucerCountdownTimer
ROM:6BC1 AD F9 02				     LDA     byte_2F9
ROM:6BC4 F0 0A					     BEQ     loc_6BD0
ROM:6BC6 AD F6 02				     LDA     currentNumberOfAsteroids
ROM:6BC9 F0 CE					     BEQ     locret_6B99	     ; , return
ROM:6BCB CD FD 02				     CMP     byte_2FD
ROM:6BCE B0 C9					     BCS     locret_6B99	     ; , return
ROM:6BD0
ROM:6BD0	     loc_6BD0:
ROM:6BD0 AD F8 02				     LDA     starting_saucerCountdownTimer
ROM:6BD3 38					     SEC
ROM:6BD4 E9 06					     SBC     #6
ROM:6BD6 C9 20					     CMP     #20h ; ' '
ROM:6BD8 90 03					     BCC     loc_6BDD
ROM:6BDA 8D F8 02				     STA     starting_saucerCountdownTimer
ROM:6BDD
ROM:6BDD	     loc_6BDD:
ROM:6BDD A9 00					     LDA     #0
ROM:6BDF 8D CB 02				     STA     saucer_PLh
ROM:6BE2 8D 85 02				     STA     saucer_PHh
ROM:6BE5 20 B5 77				     JSR     update_prng
ROM:6BE8 4A					     LSR     A
ROM:6BE9 6E EE 02				     ROR     saucer_PLv
ROM:6BEC 4A					     LSR     A
ROM:6BED 6E EE 02				     ROR     saucer_PLv
ROM:6BF0 4A					     LSR     A
ROM:6BF1 6E EE 02				     ROR     saucer_PLv
ROM:6BF4 C9 18					     CMP     #18h
ROM:6BF6 90 02					     BCC     loc_6BFA
ROM:6BF8 29 17					     AND     #17h
ROM:6BFA
ROM:6BFA	     loc_6BFA:
ROM:6BFA 8D A8 02				     STA     saucer_PHv
ROM:6BFD A2 10					     LDX     #10h
ROM:6BFF 24 60					     BIT     rnd2
ROM:6C01 70 0C					     BVS     loc_6C0F
ROM:6C03 A9 1F					     LDA     #1Fh
ROM:6C05 8D 85 02				     STA     saucer_PHh
ROM:6C08 A9 FF					     LDA     #0FFh
ROM:6C0A 8D CB 02				     STA     saucer_PLh
ROM:6C0D A2 F0					     LDX     #0F0h ; ''
ROM:6C0F
ROM:6C0F	     loc_6C0F:
ROM:6C0F 8E 3F 02				     STX     saucer_Vh
ROM:6C12 A2 02					     LDX     #2			     ; large saucer
ROM:6C14 AD F8 02				     LDA     starting_saucerCountdownTimer
ROM:6C17 30 17					     BMI     loc_6C30
ROM:6C19 A4 19					     LDY     curPlayer_x2	     ; p1/p2 score
ROM:6C1B B9 53 00				     LDA     p1ScoreThousands,Y
ROM:6C1E C9 30					     CMP     #30h ; '0'              ; score over 30,000?
ROM:6C20 B0 0D					     BCS     loc_6C2F		     ; yes, skip (always small saucer)
ROM:6C22 20 B5 77				     JSR     update_prng
ROM:6C25 85 08					     STA     byte_8
ROM:6C27 AD F8 02				     LDA     starting_saucerCountdownTimer
ROM:6C2A 4A					     LSR     A
ROM:6C2B C5 08					     CMP     byte_8
ROM:6C2D B0 01					     BCS     loc_6C30
ROM:6C2F
ROM:6C2F	     loc_6C2F:							     ; small saucer
ROM:6C2F CA					     DEX
ROM:6C30
ROM:6C30	     loc_6C30:
ROM:6C30 8E 1C 02				     STX     p1SaucerFlag
ROM:6C33 60					     RTS
ROM:6C34	     ; ---------------------------------------------------------------------------
ROM:6C34
ROM:6C34	     handle_existing_saucer:
ROM:6C34 A5 5C					     LDA     fastTimer
ROM:6C36 0A					     ASL     A
ROM:6C37 D0 0C					     BNE     loc_6C45
ROM:6C39 20 B5 77				     JSR     update_prng
ROM:6C3C 29 03					     AND     #3
ROM:6C3E AA					     TAX
ROM:6C3F BD D3 6C				     LDA     unk_6CD3,X
ROM:6C42 8D 62 02				     STA     saucer_Vv
ROM:6C45
ROM:6C45	     loc_6C45:							     ; game active?
ROM:6C45 A5 1C					     LDA     numPlayers
ROM:6C47 F0 05					     BEQ     loc_6C4E		     ; no, skip
ROM:6C49 AD FA 02				     LDA     shipSpawnTimer
ROM:6C4C D0 05					     BNE     locret_6C53
ROM:6C4E
ROM:6C4E	     loc_6C4E:
ROM:6C4E CE F7 02				     DEC     saucerCountdownTimer
ROM:6C51 F0 01					     BEQ     loc_6C54
ROM:6C53
ROM:6C53	     locret_6C53:
ROM:6C53 60					     RTS
ROM:6C54	     ; ---------------------------------------------------------------------------
ROM:6C54
ROM:6C54	     loc_6C54:
ROM:6C54 A9 0A					     LDA     #10
ROM:6C56 8D F7 02				     STA     saucerCountdownTimer
ROM:6C59 AD 1C 02				     LDA     p1SaucerFlag
ROM:6C5C 4A					     LSR     A			     ; small saucer?
ROM:6C5D F0 06					     BEQ     handle_small_saucer     ; yes, go
ROM:6C5F 20 B5 77				     JSR     update_prng	     ; random shot direction
ROM:6C62 4C C4 6C				     JMP     update_shot_direction
ROM:6C65	     ; ---------------------------------------------------------------------------
ROM:6C65
ROM:6C65	     handle_small_saucer:
ROM:6C65 AD 3F 02				     LDA     saucer_Vh
ROM:6C68 C9 80					     CMP     #80h ; 'Ä'
ROM:6C6A 6A					     ROR     A
ROM:6C6B 85 0C					     STA     byte_C
ROM:6C6D AD CA 02				     LDA     ship_PLh
ROM:6C70 38					     SEC
ROM:6C71 ED CB 02				     SBC     saucer_PLh
ROM:6C74 85 0B					     STA     byte_B
ROM:6C76 AD 84 02				     LDA     ship_PHh
ROM:6C79 ED 85 02				     SBC     saucer_PHh
ROM:6C7C 06 0B					     ASL     byte_B
ROM:6C7E 2A					     ROL     A
ROM:6C7F 06 0B					     ASL     byte_B
ROM:6C81 2A					     ROL     A
ROM:6C82 38					     SEC
ROM:6C83 E5 0C					     SBC     byte_C
ROM:6C85 AA					     TAX
ROM:6C86 AD 62 02				     LDA     saucer_Vv
ROM:6C89 C9 80					     CMP     #80h ; 'Ä'
ROM:6C8B 6A					     ROR     A
ROM:6C8C 85 0C					     STA     byte_C
ROM:6C8E AD ED 02				     LDA     ship_PLv
ROM:6C91 38					     SEC
ROM:6C92 ED EE 02				     SBC     saucer_PLv
ROM:6C95 85 0B					     STA     byte_B
ROM:6C97 AD A7 02				     LDA     ship_PHv
ROM:6C9A ED A8 02				     SBC     saucer_PHv
ROM:6C9D 06 0B					     ASL     byte_B
ROM:6C9F 2A					     ROL     A
ROM:6CA0 06 0B					     ASL     byte_B
ROM:6CA2 2A					     ROL     A
ROM:6CA3 38					     SEC
ROM:6CA4 E5 0C					     SBC     byte_C
ROM:6CA6 A8					     TAY
ROM:6CA7 20 F0 76				     JSR     loc_76EF+1
ROM:6CAA 85 62					     STA     saucerShotDirection
ROM:6CAC 20 B5 77				     JSR     update_prng
ROM:6CAF A6 19					     LDX     curPlayer_x2
ROM:6CB1 B4 53					     LDY     p1ScoreThousands,X
ROM:6CB3 C0 35					     CPY     #35h ; '5'              ; score over 35,000?
ROM:6CB5 A2 00					     LDX     #0
ROM:6CB7 90 01					     BCC     loc_6CBA		     ; no, skip
ROM:6CB9 E8					     INX
ROM:6CBA
ROM:6CBA	     loc_6CBA:
ROM:6CBA 3D CF 6C				     AND     unk_6CCF,X
ROM:6CBD 10 03					     BPL     loc_6CC2
ROM:6CBF 1D D1 6C				     ORA     unk_6CD1,X
ROM:6CC2
ROM:6CC2	     loc_6CC2:
ROM:6CC2 65 62					     ADC     saucerShotDirection
ROM:6CC4
ROM:6CC4	     update_shot_direction:
ROM:6CC4 85 62					     STA     saucerShotDirection
ROM:6CC6 A0 03					     LDY     #3
ROM:6CC8 A2 01					     LDX     #1
ROM:6CCA 86 0E					     STX     byte_E
ROM:6CCC 4C F2 6C				     JMP     find_free_shot_slot
ROM:6CCC	     ; End of function handle_saucer
ROM:6CCC
ROM:6CCC	     ; ---------------------------------------------------------------------------
ROM:6CCF 8F	     unk_6CCF:			     .db  8Fh ;	è
ROM:6CD0 87					     .db  87h ;	á
ROM:6CD1 70	     unk_6CD1:			     .db  70h ;	p
ROM:6CD2 78					     .db  78h ;	x
ROM:6CD3 F0	     unk_6CD3:			     .db 0F0h ;	
ROM:6CD4 00					     .db    0
ROM:6CD5 00					     .db    0
ROM:6CD6 10					     .db  10h
ROM:6CD7	     ; detects leading edge of fire button press
ROM:6CD7
ROM:6CD7	     ; =============== S U B R O U T I N E =======================================
ROM:6CD7
ROM:6CD7
ROM:6CD7	     handle_fire:
ROM:6CD7 A5 1C					     LDA     numPlayers		     ; game active?
ROM:6CD9 F0 21					     BEQ     locret_6CFC	     ; no, exit
ROM:6CDB 0E 04 20				     ASL     FireSwitch		     ; fire button to C
ROM:6CDE 66 63					     ROR     btn_edge_debounce	     ; shift into bit 7
ROM:6CE0 24 63					     BIT     btn_edge_debounce	     ; test
ROM:6CE2 10 18					     BPL     locret_6CFC	     ; b7=0, not pressed, exit
ROM:6CE4 70 16					     BVS     locret_6CFC	     ; b6=1, was pressed, exit
ROM:6CE6 AD FA 02				     LDA     shipSpawnTimer
ROM:6CE9 D0 11					     BNE     locret_6CFC
ROM:6CEB AA					     TAX
ROM:6CEC A9 03					     LDA     #3			     ; offset shot0 timer - 1
ROM:6CEE 85 0E					     STA     byte_E
ROM:6CF0 A0 07					     LDY     #7			     ; offset shot3 timer
ROM:6CF2
ROM:6CF2	     find_free_shot_slot:					     ; get shot	timer
ROM:6CF2 B9 1B 02				     LDA     p1PlayerFlag,Y
ROM:6CF5 F0 06					     BEQ     new_shot_fired	     ; not active, go
ROM:6CF7 88					     DEY			     ; next shot timer
ROM:6CF8 C4 0E					     CPY     byte_E		     ; done all	shot timers?
ROM:6CFA D0 F6					     BNE     find_free_shot_slot     ; no, loop
ROM:6CFC
ROM:6CFC	     locret_6CFC:
ROM:6CFC 60					     RTS
ROM:6CFD	     ; ---------------------------------------------------------------------------
ROM:6CFD
ROM:6CFD	     new_shot_fired:						     ; was byte_2FA
ROM:6CFD 86 0D					     STX     byte_D
ROM:6CFF A9 12					     LDA     #18
ROM:6D01 99 1B 02				     STA     p1PlayerFlag,Y	     ; init shot timer
ROM:6D04 B5 61					     LDA     direction,X
ROM:6D06 20 D2 77				     JSR     some_thrust_calc
ROM:6D09 A6 0D					     LDX     byte_D		     ; was byte_2FA
ROM:6D0B C9 80					     CMP     #80h ; 'Ä'
ROM:6D0D 6A					     ROR     A
ROM:6D0E 85 09					     STA     byte_9
ROM:6D10 18					     CLC
ROM:6D11 7D 3E 02				     ADC     ship_Vh,X
ROM:6D14 30 08					     BMI     loc_6D1E
ROM:6D16 C9 70					     CMP     #112
ROM:6D18 90 0A					     BCC     loc_6D24
ROM:6D1A A9 6F					     LDA     #111
ROM:6D1C D0 06					     BNE     loc_6D24
ROM:6D1E
ROM:6D1E	     loc_6D1E:
ROM:6D1E C9 91					     CMP     #145
ROM:6D20 B0 02					     BCS     loc_6D24
ROM:6D22 A9 91					     LDA     #145
ROM:6D24
ROM:6D24	     loc_6D24:
ROM:6D24 99 3E 02				     STA     ship_Vh,Y
ROM:6D27 B5 61					     LDA     direction,X
ROM:6D29 20 D5 77				     JSR     sub_77D5
ROM:6D2C A6 0D					     LDX     byte_D
ROM:6D2E C9 80					     CMP     #80h ; 'Ä'
ROM:6D30 6A					     ROR     A
ROM:6D31 85 0C					     STA     byte_C
ROM:6D33 18					     CLC
ROM:6D34 7D 61 02				     ADC     ship_Vv,X
ROM:6D37 30 08					     BMI     loc_6D41
ROM:6D39 C9 70					     CMP     #112
ROM:6D3B 90 0A					     BCC     loc_6D47
ROM:6D3D A9 6F					     LDA     #111
ROM:6D3F D0 06					     BNE     loc_6D47
ROM:6D41
ROM:6D41	     loc_6D41:
ROM:6D41 C9 91					     CMP     #145
ROM:6D43 B0 02					     BCS     loc_6D47
ROM:6D45 A9 91					     LDA     #145
ROM:6D47
ROM:6D47	     loc_6D47:
ROM:6D47 99 61 02				     STA     ship_Vv,Y
ROM:6D4A A2 00					     LDX     #0
ROM:6D4C A5 09					     LDA     byte_9
ROM:6D4E 10 01					     BPL     loc_6D51
ROM:6D50 CA					     DEX
ROM:6D51
ROM:6D51	     loc_6D51:
ROM:6D51 86 08					     STX     byte_8
ROM:6D53 A6 0D					     LDX     byte_D
ROM:6D55 C9 80					     CMP     #80h ; 'Ä'
ROM:6D57 6A					     ROR     A
ROM:6D58 18					     CLC
ROM:6D59 65 09					     ADC     byte_9
ROM:6D5B 18					     CLC
ROM:6D5C 7D CA 02				     ADC     ship_PLh,X
ROM:6D5F 99 CA 02				     STA     ship_PLh,Y
ROM:6D62 A5 08					     LDA     byte_8
ROM:6D64 7D 84 02				     ADC     ship_PHh,X
ROM:6D67 99 84 02				     STA     ship_PHh,Y
ROM:6D6A A2 00					     LDX     #0
ROM:6D6C A5 0C					     LDA     byte_C
ROM:6D6E 10 01					     BPL     loc_6D71
ROM:6D70 CA					     DEX
ROM:6D71
ROM:6D71	     loc_6D71:
ROM:6D71 86 0B					     STX     byte_B
ROM:6D73 A6 0D					     LDX     byte_D
ROM:6D75 C9 80					     CMP     #80h ; 'Ä'
ROM:6D77 6A					     ROR     A
ROM:6D78 18					     CLC
ROM:6D79 65 0C					     ADC     byte_C
ROM:6D7B 18					     CLC
ROM:6D7C 7D ED 02				     ADC     ship_PLv,X
ROM:6D7F 99 ED 02				     STA     ship_PLv,Y
ROM:6D82 A5 0B					     LDA     byte_B
ROM:6D84 7D A7 02				     ADC     ship_PHv,X
ROM:6D87 99 A7 02				     STA     ship_PHv,Y
ROM:6D8A A9 80					     LDA     #80h ; 'Ä'
ROM:6D8C 95 66					     STA     timerPlayerFireSound,X
ROM:6D8E 60					     RTS
ROM:6D8E	     ; End of function handle_fire
ROM:6D8E
ROM:6D8E	     ; ---------------------------------------------------------------------------
ROM:6D8F D8					     .db 0D8h ;	ÿ
ROM:6D90
ROM:6D90	     ; =============== S U B R O U T I N E =======================================
ROM:6D90
ROM:6D90
ROM:6D90	     handle_high_score_entry:
ROM:6D90 A5 32					     LDA     placeP1HighScore
ROM:6D92 25 33					     AND     placeP2HighScore
ROM:6D94 10 01					     BPL     high_score_entry
ROM:6D96 60					     RTS
ROM:6D97	     ; ---------------------------------------------------------------------------
ROM:6D97
ROM:6D97	     high_score_entry:
ROM:6D97 A5 1A					     LDA     numPlayersPreviousGame
ROM:6D99 4A					     LSR     A
ROM:6D9A F0 18					     BEQ     loc_6DB4
ROM:6D9C A0 01					     LDY     #1			     ; "PLAYER"
ROM:6D9E 20 F6 77				     JSR     PrintPackedMsg
ROM:6DA1 A0 02					     LDY     #2
ROM:6DA3 A6 33					     LDX     placeP2HighScore
ROM:6DA5 10 01					     BPL     loc_6DA8
ROM:6DA7 88					     DEY
ROM:6DA8
ROM:6DA8	     loc_6DA8:
ROM:6DA8 84 18					     STY     curPlayer
ROM:6DAA A5 5C					     LDA     fastTimer
ROM:6DAC 29 10					     AND     #10h
ROM:6DAE D0 04					     BNE     loc_6DB4
ROM:6DB0 98					     TYA
ROM:6DB1 20 D1 7B				     JSR     display_digit_A
ROM:6DB4
ROM:6DB4	     loc_6DB4:
ROM:6DB4 46 18					     LSR     curPlayer
ROM:6DB6 20 B2 73				     JSR     set_RAMSEL_for_player
ROM:6DB9 A0 02					     LDY     #2			     ; "YOUR SCORE IS ONE OF THE TEN BEST"
ROM:6DBB 20 F6 77				     JSR     PrintPackedMsg
ROM:6DBE A0 03					     LDY     #3			     ; "PLEASE ENTER YOUR INITIALS"
ROM:6DC0 20 F6 77				     JSR     PrintPackedMsg
ROM:6DC3 A0 04					     LDY     #4			     ; "PUSH ROTATE TO SELECT LETTER"
ROM:6DC5 20 F6 77				     JSR     PrintPackedMsg
ROM:6DC8 A0 05					     LDY     #5			     ; "PUSH HYPERSPACE WHEN LETTER IS CORRECT"
ROM:6DCA 20 F6 77				     JSR     PrintPackedMsg
ROM:6DCD A9 20					     LDA     #20h ; ' '
ROM:6DCF 85 00					     STA     globalScale
ROM:6DD1 A9 64					     LDA     #64h ; 'd'
ROM:6DD3 A2 39					     LDX     #39h ; '9'
ROM:6DD5 20 03 7C				     JSR     write_CURx4_cmd
ROM:6DD8 A9 70					     LDA     #70h ; 'p'
ROM:6DDA 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:6DDD A6 18					     LDX     curPlayer
ROM:6DDF B4 32					     LDY     32h,X
ROM:6DE1 84 0B					     STY     byte_B
ROM:6DE3 98					     TYA
ROM:6DE4 18					     CLC
ROM:6DE5 65 31					     ADC     letterHighScoreEntry
ROM:6DE7 85 0C					     STA     byte_C
ROM:6DE9 20 1A 6F				     JSR     display_initial
ROM:6DEC A4 0B					     LDY     byte_B
ROM:6DEE C8					     INY
ROM:6DEF 20 1A 6F				     JSR     display_initial
ROM:6DF2 A4 0B					     LDY     byte_B
ROM:6DF4 C8					     INY
ROM:6DF5 C8					     INY
ROM:6DF6 20 1A 6F				     JSR     display_initial
ROM:6DF9 AD 03 20				     LDA     hyperspaceSwitch	     ; read hyperspace button
ROM:6DFC 2A					     ROL     A			     ; shift into C
ROM:6DFD 26 63					     ROL     btn_edge_debounce	     ; shift into bit0
ROM:6DFF A5 63					     LDA     btn_edge_debounce
ROM:6E01 29 1F					     AND     #1Fh		     ; low 5 bits
ROM:6E03 C9 07					     CMP     #7			     ; 00111?
ROM:6E05 D0 27					     BNE     loc_6E2E		     ; no, exit
ROM:6E07 E6 31					     INC     letterHighScoreEntry
ROM:6E09 A5 31					     LDA     letterHighScoreEntry
ROM:6E0B C9 03					     CMP     #3
ROM:6E0D 90 13					     BCC     loc_6E22
ROM:6E0F A6 18					     LDX     curPlayer
ROM:6E11 A9 FF					     LDA     #0FFh
ROM:6E13 95 32					     STA     placeP1HighScore,X
ROM:6E15
ROM:6E15	     loc_6E15:
ROM:6E15 A2 00					     LDX     #0
ROM:6E17 86 18					     STX     curPlayer
ROM:6E19 86 31					     STX     letterHighScoreEntry
ROM:6E1B A2 F0					     LDX     #0F0h ; ''
ROM:6E1D 86 5D					     STX     slowTimer
ROM:6E1F 4C B2 73				     JMP     set_RAMSEL_for_player
ROM:6E22	     ; ---------------------------------------------------------------------------
ROM:6E22
ROM:6E22	     loc_6E22:
ROM:6E22 E6 0C					     INC     byte_C
ROM:6E24 A6 0C					     LDX     byte_C
ROM:6E26 A9 F4					     LDA     #0F4h ; 'Ù'
ROM:6E28 85 5D					     STA     slowTimer
ROM:6E2A A9 0B					     LDA     #0Bh
ROM:6E2C 95 34					     STA     highScoreInitials,X
ROM:6E2E
ROM:6E2E	     loc_6E2E:
ROM:6E2E A5 5D					     LDA     slowTimer
ROM:6E30 D0 08					     BNE     loc_6E3A
ROM:6E32 A9 FF					     LDA     #0FFh
ROM:6E34 85 32					     STA     placeP1HighScore
ROM:6E36 85 33					     STA     placeP2HighScore
ROM:6E38 30 DB					     BMI     loc_6E15
ROM:6E3A
ROM:6E3A	     loc_6E3A:
ROM:6E3A A5 5C					     LDA     fastTimer
ROM:6E3C 29 07					     AND     #7
ROM:6E3E D0 31					     BNE     loc_6E71
ROM:6E40 AD 07 24				     LDA     rotateLeftSwitch
ROM:6E43 10 04					     BPL     loc_6E49
ROM:6E45 A9 01					     LDA     #1
ROM:6E47 D0 07					     BNE     loc_6E50
ROM:6E49
ROM:6E49	     loc_6E49:
ROM:6E49 AD 06 24				     LDA     rotateRightSwitch
ROM:6E4C 10 23					     BPL     loc_6E71
ROM:6E4E A9 FF					     LDA     #0FFh
ROM:6E50
ROM:6E50	     loc_6E50:
ROM:6E50 A6 0C					     LDX     byte_C
ROM:6E52 18					     CLC
ROM:6E53 75 34					     ADC     highScoreInitials,X
ROM:6E55 30 10					     BMI     loc_6E67
ROM:6E57 C9 0B					     CMP     #0Bh
ROM:6E59 B0 0E					     BCS     loc_6E69
ROM:6E5B C9 01					     CMP     #1
ROM:6E5D F0 04					     BEQ     loc_6E63
ROM:6E5F A9 00					     LDA     #0
ROM:6E61 F0 0C					     BEQ     loc_6E6F
ROM:6E63
ROM:6E63	     loc_6E63:
ROM:6E63 A9 0B					     LDA     #0Bh
ROM:6E65 D0 08					     BNE     loc_6E6F
ROM:6E67
ROM:6E67	     loc_6E67:
ROM:6E67 A9 24					     LDA     #24h ; '$'
ROM:6E69
ROM:6E69	     loc_6E69:
ROM:6E69 C9 25					     CMP     #25h ; '%'
ROM:6E6B 90 02					     BCC     loc_6E6F
ROM:6E6D A9 00					     LDA     #0
ROM:6E6F
ROM:6E6F	     loc_6E6F:
ROM:6E6F 95 34					     STA     highScoreInitials,X
ROM:6E71
ROM:6E71	     loc_6E71:
ROM:6E71 A9 00					     LDA     #0
ROM:6E73 60					     RTS
ROM:6E73	     ; End of function handle_high_score_entry
ROM:6E73
ROM:6E74
ROM:6E74	     ; =============== S U B R O U T I N E =======================================
ROM:6E74
ROM:6E74
ROM:6E74	     handle_hyperspace:
ROM:6E74 A5 1C					     LDA     numPlayers
ROM:6E76 F0 5F					     BEQ     locret_6ED7	     ; not a real game,	exit
ROM:6E78 AD 1B 02				     LDA     p1PlayerFlag
ROM:6E7B 30 5A					     BMI     locret_6ED7	     ; exploding, exit
ROM:6E7D AD FA 02				     LDA     shipSpawnTimer
ROM:6E80 D0 55					     BNE     locret_6ED7
ROM:6E82 AD 03 20				     LDA     hyperspaceSwitch	     ; button pressed?
ROM:6E85 10 50					     BPL     locret_6ED7	     ; no, exit
ROM:6E87 A9 00					     LDA     #0			     ; flag hyperspace?
ROM:6E89 8D 1B 02				     STA     p1PlayerFlag
ROM:6E8C 8D 3E 02				     STA     ship_Vh
ROM:6E8F 8D 61 02				     STA     ship_Vv
ROM:6E92 A9 30					     LDA     #30h ; '0'
ROM:6E94 8D FA 02				     STA     shipSpawnTimer
ROM:6E97 20 B5 77				     JSR     update_prng
ROM:6E9A 29 1F					     AND     #1Fh
ROM:6E9C C9 1D					     CMP     #29
ROM:6E9E 90 02					     BCC     loc_6EA2
ROM:6EA0 A9 1C					     LDA     #28
ROM:6EA2
ROM:6EA2	     loc_6EA2:
ROM:6EA2 C9 03					     CMP     #3
ROM:6EA4 B0 02					     BCS     loc_6EA8
ROM:6EA6 A9 03					     LDA     #3
ROM:6EA8
ROM:6EA8	     loc_6EA8:							     ; 3-28
ROM:6EA8 8D 84 02				     STA     ship_PHh
ROM:6EAB A2 05					     LDX     #5
ROM:6EAD
ROM:6EAD	     loc_6EAD:
ROM:6EAD 20 B5 77				     JSR     update_prng
ROM:6EB0 CA					     DEX
ROM:6EB1 D0 FA					     BNE     loc_6EAD
ROM:6EB3 29 1F					     AND     #1Fh
ROM:6EB5 E8					     INX			     ; =1 (successful)
ROM:6EB6 C9 18					     CMP     #24
ROM:6EB8 90 0C					     BCC     loc_6EC6
ROM:6EBA 29 07					     AND     #7
ROM:6EBC 0A					     ASL     A
ROM:6EBD 69 04					     ADC     #4
ROM:6EBF CD F6 02				     CMP     currentNumberOfAsteroids
ROM:6EC2 90 02					     BCC     loc_6EC6
ROM:6EC4 A2 80					     LDX     #80h ; 'Ä'              ; flag unsuccessful (death)
ROM:6EC6
ROM:6EC6	     loc_6EC6:
ROM:6EC6 C9 15					     CMP     #21
ROM:6EC8 90 02					     BCC     loc_6ECC
ROM:6ECA A9 14					     LDA     #20
ROM:6ECC
ROM:6ECC	     loc_6ECC:
ROM:6ECC C9 03					     CMP     #3
ROM:6ECE B0 02					     BCS     loc_6ED2
ROM:6ED0 A9 03					     LDA     #3
ROM:6ED2
ROM:6ED2	     loc_6ED2:							     ; 3-20
ROM:6ED2 8D A7 02				     STA     ship_PHv
ROM:6ED5 86 59					     STX     hyperspaceFlag
ROM:6ED7
ROM:6ED7	     locret_6ED7:
ROM:6ED7 60					     RTS
ROM:6ED7	     ; End of function handle_hyperspace
ROM:6ED7
ROM:6ED8
ROM:6ED8	     ; =============== S U B R O U T I N E =======================================
ROM:6ED8
ROM:6ED8
ROM:6ED8	     init_players:
ROM:6ED8 A9 02					     LDA     #2
ROM:6EDA 8D F5 02				     STA     startingAsteroidsPerWave
ROM:6EDD A2 03					     LDX     #3
ROM:6EDF 4E 02 28				     LSR     centerCoinMultiplierAndLives
ROM:6EE2 B0 01					     BCS     loc_6EE5
ROM:6EE4 E8					     INX
ROM:6EE5
ROM:6EE5	     loc_6EE5:
ROM:6EE5 86 56					     STX     numStartingShipsPerGame
ROM:6EE7 A9 00					     LDA     #0
ROM:6EE9 A2 04					     LDX     #4			     ; 4 shots timers to init
ROM:6EEB
ROM:6EEB	     loc_6EEB:
ROM:6EEB 9D 1B 02				     STA     p1PlayerFlag,X
ROM:6EEE 9D 1F 02				     STA     p1TimerShot0,X
ROM:6EF1 95 51					     STA     51h,X		     ; zero player score
ROM:6EF3 CA					     DEX			     ; next byte
ROM:6EF4 10 F5					     BPL     loc_6EEB		     ; loop until done
ROM:6EF6 8D F6 02				     STA     currentNumberOfAsteroids ;	???
ROM:6EF9 60					     RTS
ROM:6EF9	     ; End of function init_players
ROM:6EF9
ROM:6EFA
ROM:6EFA	     ; =============== S U B R O U T I N E =======================================
ROM:6EFA
ROM:6EFA
ROM:6EFA	     init_sound:
ROM:6EFA A9 00					     LDA     #0			     ; turn off	sound
ROM:6EFC 8D 00 36				     STA     3600h		     ; sound (explosion)
ROM:6EFF 8D 00 3A				     STA     3A00h		     ; sound (thump)
ROM:6F02 8D 00 3C				     STA     3C00h		     ; sound (saucer)
ROM:6F05 8D 01 3C				     STA     3C01h		     ; sound (saucer fire)
ROM:6F08 8D 03 3C				     STA     3C03h		     ; sound (ship thrust)
ROM:6F0B 8D 04 3C				     STA     3C04h		     ; sound (ship fire)
ROM:6F0E 8D 05 3C				     STA     3C05h		     ; sound (bonus life)
ROM:6F11 85 69					     STA     timerExplosionSound
ROM:6F13 85 66					     STA     timerPlayerFireSound
ROM:6F15 85 67					     STA     timerSaucerFireSound
ROM:6F17 85 68					     STA     timerBonusShipSound
ROM:6F19 60					     RTS
ROM:6F19	     ; End of function init_sound
ROM:6F19
ROM:6F1A
ROM:6F1A	     ; =============== S U B R O U T I N E =======================================
ROM:6F1A
ROM:6F1A
ROM:6F1A	     display_initial:
ROM:6F1A B9 34 00				     LDA     highScoreInitials,Y     ; get initial
ROM:6F1D 0A					     ASL     A			     ; convert to char code
ROM:6F1E A8					     TAY			     ; space?
ROM:6F1F D0 14					     BNE     display_char_code_Y     ; no, display
ROM:6F21 A5 32					     LDA     placeP1HighScore
ROM:6F23 25 33					     AND     placeP2HighScore	     ; entered as <space>?
ROM:6F25 30 0E					     BMI     display_char_code_Y     ; yes, display
ROM:6F27 A9 72					     LDA     #72h ; 'r'              ; brightness=7, S=0, X=2
ROM:6F29 A2 F8					     LDX     #0F8h ; '¯'             ; cmd=SVEC, s=-ve, Y=0
ROM:6F2B 20 45 7D				     JSR     write_AX_to_avgram
ROM:6F2E A9 01					     LDA     #1			     ; brightness=0, S=0, X=0
ROM:6F30 A2 F8					     LDX     #0F8h ; '¯'             ; cmd=SVEC, s=-ve, Y=0
ROM:6F32 4C 45 7D				     JMP     write_AX_to_avgram
ROM:6F32	     ; End of function display_initial
ROM:6F32
ROM:6F35
ROM:6F35	     ; =============== S U B R O U T I N E =======================================
ROM:6F35
ROM:6F35
ROM:6F35	     display_char_code_Y:
ROM:6F35 BE D5 56				     LDX     (DVGROM+6D5h),Y	     ; chr fn
ROM:6F38 B9 D4 56				     LDA     (DVGROM+6D4h),Y	     ; chr fn
ROM:6F3B 4C 45 7D				     JMP     write_AX_to_avgram
ROM:6F3B	     ; End of function display_char_code_Y
ROM:6F3B
ROM:6F3E
ROM:6F3E	     ; =============== S U B R O U T I N E =======================================
ROM:6F3E
ROM:6F3E
ROM:6F3E	     display_extra_ships:
ROM:6F3E F0 16					     BEQ     locret_6F56
ROM:6F40 84 08					     STY     byte_8
ROM:6F42 A2 D5					     LDX     #213		     ; Y coord (x4=852)
ROM:6F44 A0 E0					     LDY     #0E0h ; '‡'
ROM:6F46 84 00					     STY     globalScale
ROM:6F48 20 03 7C				     JSR     write_CURx4_cmd
ROM:6F4B
ROM:6F4B	     loc_6F4B:
ROM:6F4B A2 DA					     LDX     #0DAh ; '⁄'
ROM:6F4D A9 54					     LDA     #54h ; 'T'              ; addr=0x54DA
ROM:6F4F 20 FC 7B				     JSR     write_JSR_cmd	     ; display extra ships?
ROM:6F52 C6 08					     DEC     byte_8
ROM:6F54 D0 F5					     BNE     loc_6F4B
ROM:6F56
ROM:6F56	     locret_6F56:
ROM:6F56 60					     RTS
ROM:6F56	     ; End of function display_extra_ships
ROM:6F56
ROM:6F57
ROM:6F57	     ; =============== S U B R O U T I N E =======================================
ROM:6F57
ROM:6F57
ROM:6F57	     handle_objects:
ROM:6F57 A2 22					     LDX     #22h ; '"'              ; offset to last object in table
ROM:6F59
ROM:6F59	     loc_6F59:							     ; get entry
ROM:6F59 BD 00 02				     LDA     P1RAM,X
ROM:6F5C D0 04					     BNE     handle_object_entry     ; non-zero	entry, handle it
ROM:6F5E
ROM:6F5E	     loc_6F5E:							     ; next value
ROM:6F5E CA					     DEX
ROM:6F5F 10 F8					     BPL     loc_6F59		     ; loop 'til done
ROM:6F61 60					     RTS
ROM:6F62	     ; ---------------------------------------------------------------------------
ROM:6F62
ROM:6F62	     handle_object_entry:
ROM:6F62 10 63					     BPL     loc_6FC7
ROM:6F64 20 08 77				     JSR     negate_A
ROM:6F67 4A					     LSR     A
ROM:6F68 4A					     LSR     A
ROM:6F69 4A					     LSR     A
ROM:6F6A 4A					     LSR     A			     ; high nibble
ROM:6F6B E0 1B					     CPX     #1Bh		     ; playerFlag?
ROM:6F6D D0 07					     BNE     loc_6F76		     ; no, skip
ROM:6F6F A5 5C					     LDA     fastTimer
ROM:6F71 29 01					     AND     #1
ROM:6F73 4A					     LSR     A
ROM:6F74 F0 01					     BEQ     loc_6F77
ROM:6F76
ROM:6F76	     loc_6F76:
ROM:6F76 38					     SEC
ROM:6F77
ROM:6F77	     loc_6F77:
ROM:6F77 7D 00 02				     ADC     P1RAM,X
ROM:6F7A 30 25					     BMI     loc_6FA1
ROM:6F7C E0 1B					     CPX     #1Bh		     ; playerFlag?
ROM:6F7E F0 13					     BEQ     loc_6F93		     ; yes, go
ROM:6F80 B0 17					     BCS     loc_6F99
ROM:6F82 CE F6 02				     DEC     currentNumberOfAsteroids
ROM:6F85 D0 05					     BNE     loc_6F8C
ROM:6F87 A0 7F					     LDY     #7Fh ; ''
ROM:6F89 8C FB 02				     STY     asteroidWaveTimer
ROM:6F8C
ROM:6F8C	     loc_6F8C:
ROM:6F8C A9 00					     LDA     #0
ROM:6F8E 9D 00 02				     STA     P1RAM,X
ROM:6F91 F0 CB					     BEQ     loc_6F5E
ROM:6F93
ROM:6F93	     loc_6F93:
ROM:6F93 20 E8 71				     JSR     sub_71E8
ROM:6F96 4C 8C 6F				     JMP     loc_6F8C
ROM:6F99	     ; ---------------------------------------------------------------------------
ROM:6F99
ROM:6F99	     loc_6F99:
ROM:6F99 AD F8 02				     LDA     starting_saucerCountdownTimer
ROM:6F9C 8D F7 02				     STA     saucerCountdownTimer
ROM:6F9F D0 EB					     BNE     loc_6F8C
ROM:6FA1
ROM:6FA1	     loc_6FA1:
ROM:6FA1 9D 00 02				     STA     P1RAM,X
ROM:6FA4 29 F0					     AND     #0F0h ; ''
ROM:6FA6 18					     CLC
ROM:6FA7 69 10					     ADC     #10h
ROM:6FA9 E0 1B					     CPX     #1Bh		     ; PlayerFlag?
ROM:6FAB D0 02					     BNE     loc_6FAF		     ; no, skip
ROM:6FAD A9 00					     LDA     #0
ROM:6FAF
ROM:6FAF	     loc_6FAF:
ROM:6FAF A8					     TAY
ROM:6FB0 BD AF 02				     LDA     asteroid_PLh,X
ROM:6FB3 85 04					     STA     byte_4
ROM:6FB5 BD 69 02				     LDA     asteroid_PHh,X
ROM:6FB8 85 05					     STA     byte_5
ROM:6FBA BD D2 02				     LDA     asteroid_PLv,X
ROM:6FBD 85 06					     STA     byte_6
ROM:6FBF BD 8C 02				     LDA     asteroid_PHv,X
ROM:6FC2 85 07					     STA     byte_7
ROM:6FC4 4C 27 70				     JMP     loc_7027
ROM:6FC7	     ; ---------------------------------------------------------------------------
ROM:6FC7
ROM:6FC7	     loc_6FC7:
ROM:6FC7 18					     CLC
ROM:6FC8 A0 00					     LDY     #0
ROM:6FCA BD 23 02				     LDA     asteroid_Vh,X
ROM:6FCD 10 01					     BPL     loc_6FD0
ROM:6FCF 88					     DEY
ROM:6FD0
ROM:6FD0	     loc_6FD0:
ROM:6FD0 7D AF 02				     ADC     asteroid_PLh,X
ROM:6FD3 9D AF 02				     STA     asteroid_PLh,X
ROM:6FD6 85 04					     STA     byte_4
ROM:6FD8 98					     TYA
ROM:6FD9 7D 69 02				     ADC     asteroid_PHh,X
ROM:6FDC C9 20					     CMP     #20h ; ' '
ROM:6FDE 90 0C					     BCC     loc_6FEC
ROM:6FE0 29 1F					     AND     #1Fh
ROM:6FE2 E0 1C					     CPX     #1Ch		     ; SaucerFlag?
ROM:6FE4 D0 06					     BNE     loc_6FEC		     ; no, go
ROM:6FE6 20 2D 70				     JSR     sub_702D
ROM:6FE9 4C 5E 6F				     JMP     loc_6F5E
ROM:6FEC	     ; ---------------------------------------------------------------------------
ROM:6FEC
ROM:6FEC	     loc_6FEC:
ROM:6FEC 9D 69 02				     STA     asteroid_PHh,X
ROM:6FEF 85 05					     STA     byte_5
ROM:6FF1 18					     CLC
ROM:6FF2 A0 00					     LDY     #0
ROM:6FF4 BD 46 02				     LDA     asteroid_Vv,X
ROM:6FF7 10 02					     BPL     loc_6FFB
ROM:6FF9 A0 FF					     LDY     #0FFh
ROM:6FFB
ROM:6FFB	     loc_6FFB:
ROM:6FFB 7D D2 02				     ADC     asteroid_PLv,X
ROM:6FFE 9D D2 02				     STA     asteroid_PLv,X
ROM:7001 85 06					     STA     byte_6
ROM:7003 98					     TYA
ROM:7004 7D 8C 02				     ADC     asteroid_PHv,X
ROM:7007 C9 18					     CMP     #18h
ROM:7009 90 08					     BCC     loc_7013
ROM:700B F0 04					     BEQ     loc_7011
ROM:700D A9 17					     LDA     #17h
ROM:700F D0 02					     BNE     loc_7013
ROM:7011
ROM:7011	     loc_7011:
ROM:7011 A9 00					     LDA     #0
ROM:7013
ROM:7013	     loc_7013:
ROM:7013 9D 8C 02				     STA     asteroid_PHv,X
ROM:7016 85 07					     STA     byte_7
ROM:7018 BD 00 02				     LDA     P1RAM,X
ROM:701B A0 E0					     LDY     #0E0h ; '‡'
ROM:701D 4A					     LSR     A
ROM:701E B0 07					     BCS     loc_7027
ROM:7020 A0 F0					     LDY     #0F0h ; ''
ROM:7022 4A					     LSR     A
ROM:7023 B0 02					     BCS     loc_7027
ROM:7025 A0 00					     LDY     #0
ROM:7027
ROM:7027	     loc_7027:
ROM:7027 20 FE 72				     JSR     display_object
ROM:702A 4C 5E 6F				     JMP     loc_6F5E
ROM:702A	     ; End of function handle_objects
ROM:702A
ROM:702D
ROM:702D	     ; =============== S U B R O U T I N E =======================================
ROM:702D
ROM:702D
ROM:702D	     sub_702D:
ROM:702D AD F8 02				     LDA     starting_saucerCountdownTimer
ROM:7030 8D F7 02				     STA     saucerCountdownTimer
ROM:7033 A9 00					     LDA     #0
ROM:7035 8D 1C 02				     STA     p1SaucerFlag
ROM:7038 8D 3F 02				     STA     saucer_Vh
ROM:703B 8D 62 02				     STA     saucer_Vv
ROM:703E 60					     RTS
ROM:703E	     ; End of function sub_702D
ROM:703E
ROM:703F
ROM:703F	     ; =============== S U B R O U T I N E =======================================
ROM:703F
ROM:703F
ROM:703F	     handle_left_right_thrust:
ROM:703F A5 1C					     LDA     numPlayers
ROM:7041 F0 42					     BEQ     locret_7085
ROM:7043 AD 1B 02				     LDA     p1PlayerFlag
ROM:7046 30 3D					     BMI     locret_7085	     ; exploding - exit
ROM:7048 AD FA 02				     LDA     shipSpawnTimer
ROM:704B F0 39					     BEQ     check_rot_left
ROM:704D CE FA 02				     DEC     shipSpawnTimer
ROM:7050 D0 33					     BNE     locret_7085
ROM:7052 A4 59					     LDY     hyperspaceFlag
ROM:7054 30 19					     BMI     loc_706F		     ; unsuccessful - go
ROM:7056 D0 10					     BNE     loc_7068		     ; successful - go
ROM:7058 20 39 71				     JSR     sub_7139
ROM:705B D0 24					     BNE     loc_7081
ROM:705D AC 1C 02				     LDY     p1SaucerFlag
ROM:7060 F0 06					     BEQ     loc_7068		     ; no saucer - go
ROM:7062 A0 02					     LDY     #2
ROM:7064 8C FA 02				     STY     shipSpawnTimer
ROM:7067 60					     RTS
ROM:7068	     ; ---------------------------------------------------------------------------
ROM:7068
ROM:7068	     loc_7068:							     ; flag alive and active
ROM:7068 A9 01					     LDA     #1
ROM:706A 8D 1B 02				     STA     p1PlayerFlag
ROM:706D D0 12					     BNE     loc_7081		     ; always go
ROM:706F
ROM:706F	     loc_706F:							     ; flag exploding
ROM:706F A9 A0					     LDA     #0A0h ; '†'
ROM:7071 8D 1B 02				     STA     p1PlayerFlag
ROM:7074 A2 3E					     LDX     #3Eh ; '>'
ROM:7076 86 69					     STX     timerExplosionSound
ROM:7078 A6 18					     LDX     curPlayer
ROM:707A D6 57					     DEC     numShipsP1,X	     ; dec number of ships
ROM:707C A9 81					     LDA     #81h ; 'Å'
ROM:707E 8D FA 02				     STA     shipSpawnTimer
ROM:7081
ROM:7081	     loc_7081:							     ; flag inactive
ROM:7081 A9 00					     LDA     #0
ROM:7083 85 59					     STA     hyperspaceFlag
ROM:7085
ROM:7085	     locret_7085:
ROM:7085 60					     RTS
ROM:7086	     ; ---------------------------------------------------------------------------
ROM:7086
ROM:7086	     check_rot_left:						     ; left button?
ROM:7086 AD 07 24				     LDA     rotateLeftSwitch
ROM:7089 10 04					     BPL     check_rot_right	     ; no, skip
ROM:708B A9 03					     LDA     #3
ROM:708D D0 07					     BNE     update_dir		     ; always go
ROM:708F
ROM:708F	     check_rot_right:						     ; right button?
ROM:708F AD 06 24				     LDA     rotateRightSwitch
ROM:7092 10 07					     BPL     loc_709B		     ; no, skip
ROM:7094 A9 FD					     LDA     #-3
ROM:7096
ROM:7096	     update_dir:
ROM:7096 18					     CLC
ROM:7097 65 61					     ADC     direction		     ; calc direction
ROM:7099 85 61					     STA     direction		     ; update
ROM:709B
ROM:709B	     loc_709B:
ROM:709B A5 5C					     LDA     fastTimer
ROM:709D 4A					     LSR     A
ROM:709E B0 E5					     BCS     locret_7085	     ; exit
ROM:70A0 AD 05 24				     LDA     thrustSwitch	     ; thrust button?
ROM:70A3 10 3C					     BPL     loc_70E1		     ; no, go
ROM:70A5 A9 80					     LDA     #80h ; 'Ä'
ROM:70A7 8D 03 3C				     STA     3C03h		     ; sound (ship thrust)
ROM:70AA A0 00					     LDY     #0
ROM:70AC A5 61					     LDA     direction
ROM:70AE 20 D2 77				     JSR     some_thrust_calc
ROM:70B1 10 01					     BPL     loc_70B4
ROM:70B3 88					     DEY
ROM:70B4
ROM:70B4	     loc_70B4:
ROM:70B4 0A					     ASL     A
ROM:70B5 18					     CLC
ROM:70B6 65 64					     ADC     shipHorizontalVelocityLow
ROM:70B8 AA					     TAX
ROM:70B9 98					     TYA
ROM:70BA 6D 3E 02				     ADC     ship_Vh
ROM:70BD 20 25 71				     JSR     sub_7125
ROM:70C0 8D 3E 02				     STA     ship_Vh
ROM:70C3 86 64					     STX     shipHorizontalVelocityLow
ROM:70C5 A0 00					     LDY     #0
ROM:70C7 A5 61					     LDA     direction
ROM:70C9 20 D5 77				     JSR     sub_77D5
ROM:70CC 10 01					     BPL     loc_70CF
ROM:70CE 88					     DEY
ROM:70CF
ROM:70CF	     loc_70CF:
ROM:70CF 0A					     ASL     A
ROM:70D0 18					     CLC
ROM:70D1 65 65					     ADC     shipVerticalVelocityLow
ROM:70D3 AA					     TAX
ROM:70D4 98					     TYA
ROM:70D5 6D 61 02				     ADC     ship_Vv
ROM:70D8 20 25 71				     JSR     sub_7125
ROM:70DB 8D 61 02				     STA     ship_Vv
ROM:70DE 86 65					     STX     shipVerticalVelocityLow
ROM:70E0 60					     RTS
ROM:70E1	     ; ---------------------------------------------------------------------------
ROM:70E1
ROM:70E1	     loc_70E1:
ROM:70E1 A9 00					     LDA     #0
ROM:70E3 8D 03 3C				     STA     3C03h		     ; sound (ship thrust)
ROM:70E6 AD 3E 02				     LDA     ship_Vh
ROM:70E9 05 64					     ORA     shipHorizontalVelocityLow
ROM:70EB F0 18					     BEQ     loc_7105
ROM:70ED AD 3E 02				     LDA     ship_Vh
ROM:70F0 0A					     ASL     A
ROM:70F1 A2 FF					     LDX     #0FFh
ROM:70F3 18					     CLC
ROM:70F4 49 FF					     EOR     #0FFh
ROM:70F6 30 02					     BMI     loc_70FA
ROM:70F8 E8					     INX
ROM:70F9 38					     SEC
ROM:70FA
ROM:70FA	     loc_70FA:
ROM:70FA 65 64					     ADC     shipHorizontalVelocityLow
ROM:70FC 85 64					     STA     shipHorizontalVelocityLow
ROM:70FE 8A					     TXA
ROM:70FF 6D 3E 02				     ADC     ship_Vh
ROM:7102 8D 3E 02				     STA     ship_Vh
ROM:7105
ROM:7105	     loc_7105:
ROM:7105 A5 65					     LDA     shipVerticalVelocityLow
ROM:7107 0D 61 02				     ORA     ship_Vv
ROM:710A F0 18					     BEQ     locret_7124
ROM:710C AD 61 02				     LDA     ship_Vv
ROM:710F 0A					     ASL     A
ROM:7110 A2 FF					     LDX     #0FFh
ROM:7112 18					     CLC
ROM:7113 49 FF					     EOR     #0FFh
ROM:7115 30 02					     BMI     loc_7119
ROM:7117 38					     SEC
ROM:7118 E8					     INX
ROM:7119
ROM:7119	     loc_7119:
ROM:7119 65 65					     ADC     shipVerticalVelocityLow
ROM:711B 85 65					     STA     shipVerticalVelocityLow
ROM:711D 8A					     TXA
ROM:711E 6D 61 02				     ADC     ship_Vv
ROM:7121 8D 61 02				     STA     ship_Vv
ROM:7124
ROM:7124	     locret_7124:
ROM:7124 60					     RTS
ROM:7124	     ; End of function handle_left_right_thrust
ROM:7124
ROM:7125
ROM:7125	     ; =============== S U B R O U T I N E =======================================
ROM:7125
ROM:7125
ROM:7125	     sub_7125:
ROM:7125 30 09					     BMI     loc_7130
ROM:7127 C9 40					     CMP     #40h ; '@'
ROM:7129 90 0D					     BCC     locret_7138
ROM:712B A2 FF					     LDX     #0FFh
ROM:712D A9 3F					     LDA     #3Fh ; '?'
ROM:712F 60					     RTS
ROM:7130	     ; ---------------------------------------------------------------------------
ROM:7130
ROM:7130	     loc_7130:
ROM:7130 C9 C0					     CMP     #0C0h ; '¿'
ROM:7132 B0 04					     BCS     locret_7138
ROM:7134 A2 01					     LDX     #1
ROM:7136 A9 C0					     LDA     #0C0h ; '¿'
ROM:7138
ROM:7138	     locret_7138:
ROM:7138 60					     RTS
ROM:7138	     ; End of function sub_7125
ROM:7138
ROM:7139
ROM:7139	     ; =============== S U B R O U T I N E =======================================
ROM:7139
ROM:7139
ROM:7139	     sub_7139:
ROM:7139 A2 1C					     LDX     #1Ch
ROM:713B
ROM:713B	     loc_713B:
ROM:713B BD 00 02				     LDA     P1RAM,X
ROM:713E F0 1E					     BEQ     loc_715E
ROM:7140 BD 69 02				     LDA     asteroid_PHh,X
ROM:7143 38					     SEC
ROM:7144 ED 84 02				     SBC     ship_PHh
ROM:7147 C9 04					     CMP     #4
ROM:7149 90 04					     BCC     loc_714F
ROM:714B C9 FC					     CMP     #0FCh ; '¸'
ROM:714D 90 0F					     BCC     loc_715E
ROM:714F
ROM:714F	     loc_714F:
ROM:714F BD 8C 02				     LDA     asteroid_PHv,X
ROM:7152 38					     SEC
ROM:7153 ED A7 02				     SBC     ship_PHv
ROM:7156 C9 04					     CMP     #4
ROM:7158 90 09					     BCC     loc_7163
ROM:715A C9 FC					     CMP     #0FCh ; '¸'
ROM:715C B0 05					     BCS     loc_7163
ROM:715E
ROM:715E	     loc_715E:
ROM:715E CA					     DEX
ROM:715F 10 DA					     BPL     loc_713B
ROM:7161 E8					     INX
ROM:7162 60					     RTS
ROM:7163	     ; ---------------------------------------------------------------------------
ROM:7163
ROM:7163	     loc_7163:
ROM:7163 EE FA 02				     INC     shipSpawnTimer
ROM:7166 60					     RTS
ROM:7166	     ; End of function sub_7139
ROM:7166
ROM:7166	     ; ---------------------------------------------------------------------------
ROM:7167 90					     .db  90h ;	ê
ROM:7168
ROM:7168	     ; =============== S U B R O U T I N E =======================================
ROM:7168
ROM:7168
ROM:7168	     calc_rnd_stuff:
ROM:7168 A2 1A					     LDX     #1Ah
ROM:716A AD FB 02				     LDA     asteroidWaveTimer
ROM:716D D0 70					     BNE     loc_71DF
ROM:716F AD 1C 02				     LDA     p1SaucerFlag	     ; saucer active?
ROM:7172 D0 73					     BNE     locret_71E7	     ; yes, return
ROM:7174 8D 3F 02				     STA     saucer_Vh
ROM:7177 8D 62 02				     STA     saucer_Vv
ROM:717A EE FD 02				     INC     byte_2FD
ROM:717D AD FD 02				     LDA     byte_2FD
ROM:7180 C9 0B					     CMP     #0Bh
ROM:7182 90 03					     BCC     loc_7187
ROM:7184 CE FD 02				     DEC     byte_2FD
ROM:7187
ROM:7187	     loc_7187:
ROM:7187 AD F5 02				     LDA     startingAsteroidsPerWave
ROM:718A 18					     CLC
ROM:718B 69 02					     ADC     #2
ROM:718D C9 0B					     CMP     #0Bh
ROM:718F 90 02					     BCC     loc_7193
ROM:7191 A9 0B					     LDA     #0Bh
ROM:7193
ROM:7193	     loc_7193:
ROM:7193 8D F6 02				     STA     currentNumberOfAsteroids
ROM:7196 8D F5 02				     STA     startingAsteroidsPerWave
ROM:7199 85 08					     STA     byte_8
ROM:719B A0 1C					     LDY     #1Ch
ROM:719D
ROM:719D	     loc_719D:
ROM:719D 20 B5 77				     JSR     update_prng
ROM:71A0 29 18					     AND     #18h
ROM:71A2 09 04					     ORA     #4
ROM:71A4 9D 00 02				     STA     P1RAM,X
ROM:71A7 20 03 72				     JSR     sub_7203
ROM:71AA 20 B5 77				     JSR     update_prng
ROM:71AD 4A					     LSR     A
ROM:71AE 29 1F					     AND     #1Fh
ROM:71B0 90 13					     BCC     loc_71C5
ROM:71B2 C9 18					     CMP     #18h
ROM:71B4 90 02					     BCC     loc_71B8
ROM:71B6 29 17					     AND     #17h
ROM:71B8
ROM:71B8	     loc_71B8:
ROM:71B8 9D 8C 02				     STA     asteroid_PHv,X
ROM:71BB A9 00					     LDA     #0
ROM:71BD 9D 69 02				     STA     asteroid_PHh,X
ROM:71C0 9D AF 02				     STA     asteroid_PLh,X
ROM:71C3 F0 0B					     BEQ     loc_71D0
ROM:71C5
ROM:71C5	     loc_71C5:
ROM:71C5 9D 69 02				     STA     asteroid_PHh,X
ROM:71C8 A9 00					     LDA     #0
ROM:71CA 9D 8C 02				     STA     asteroid_PHv,X
ROM:71CD 9D D2 02				     STA     asteroid_PLv,X
ROM:71D0
ROM:71D0	     loc_71D0:
ROM:71D0 CA					     DEX
ROM:71D1 C6 08					     DEC     byte_8
ROM:71D3 D0 C8					     BNE     loc_719D
ROM:71D5 A9 7F					     LDA     #7Fh ; ''
ROM:71D7 8D F7 02				     STA     saucerCountdownTimer
ROM:71DA A9 30					     LDA     #30h ; '0'
ROM:71DC 8D FC 02				     STA     byte_2FC
ROM:71DF
ROM:71DF	     loc_71DF:
ROM:71DF A9 00					     LDA     #0
ROM:71E1
ROM:71E1	     loc_71E1:
ROM:71E1 9D 00 02				     STA     P1RAM,X
ROM:71E4 CA					     DEX
ROM:71E5 10 FA					     BPL     loc_71E1
ROM:71E7
ROM:71E7	     locret_71E7:
ROM:71E7 60					     RTS
ROM:71E7	     ; End of function calc_rnd_stuff
ROM:71E7
ROM:71E8
ROM:71E8	     ; =============== S U B R O U T I N E =======================================
ROM:71E8
ROM:71E8
ROM:71E8	     sub_71E8:
ROM:71E8 A9 60					     LDA     #60h ; '`'
ROM:71EA 8D CA 02				     STA     ship_PLh
ROM:71ED 8D ED 02				     STA     ship_PLv
ROM:71F0 A9 00					     LDA     #0
ROM:71F2 8D 3E 02				     STA     ship_Vh
ROM:71F5 8D 61 02				     STA     ship_Vv
ROM:71F8 A9 10					     LDA     #10h
ROM:71FA 8D 84 02				     STA     ship_PHh
ROM:71FD A9 0C					     LDA     #0Ch
ROM:71FF 8D A7 02				     STA     ship_PHv
ROM:7202 60					     RTS
ROM:7202	     ; End of function sub_71E8
ROM:7202
ROM:7203
ROM:7203	     ; =============== S U B R O U T I N E =======================================
ROM:7203
ROM:7203
ROM:7203	     sub_7203:
ROM:7203 20 B5 77				     JSR     update_prng
ROM:7206 29 8F					     AND     #8Fh ; 'è'
ROM:7208 10 02					     BPL     loc_720C
ROM:720A 09 F0					     ORA     #0F0h ; ''
ROM:720C
ROM:720C	     loc_720C:
ROM:720C 18					     CLC
ROM:720D 79 23 02				     ADC     asteroid_Vh,Y
ROM:7210 20 33 72				     JSR     sub_7233
ROM:7213 9D 23 02				     STA     asteroid_Vh,X
ROM:7216 20 B5 77				     JSR     update_prng
ROM:7219 20 B5 77				     JSR     update_prng
ROM:721C 20 B5 77				     JSR     update_prng
ROM:721F 20 B5 77				     JSR     update_prng
ROM:7222 29 8F					     AND     #8Fh ; 'è'
ROM:7224 10 02					     BPL     loc_7228
ROM:7226 09 F0					     ORA     #0F0h ; ''
ROM:7228
ROM:7228	     loc_7228:
ROM:7228 18					     CLC
ROM:7229 79 46 02				     ADC     asteroid_Vv,Y
ROM:722C 20 33 72				     JSR     sub_7233
ROM:722F 9D 46 02				     STA     asteroid_Vv,X
ROM:7232 60					     RTS
ROM:7232	     ; End of function sub_7203
ROM:7232
ROM:7233
ROM:7233	     ; =============== S U B R O U T I N E =======================================
ROM:7233
ROM:7233
ROM:7233	     sub_7233:
ROM:7233 10 0D					     BPL     loc_7242
ROM:7235 C9 E1					     CMP     #0E1h ; '·'
ROM:7237 B0 02					     BCS     loc_723B
ROM:7239 A9 E1					     LDA     #0E1h ; '·'
ROM:723B
ROM:723B	     loc_723B:
ROM:723B C9 FB					     CMP     #0FBh ; '˚'
ROM:723D 90 0F					     BCC     locret_724E
ROM:723F A9 FA					     LDA     #0FAh ; '˙'
ROM:7241 60					     RTS
ROM:7242	     ; ---------------------------------------------------------------------------
ROM:7242
ROM:7242	     loc_7242:
ROM:7242 C9 06					     CMP     #6
ROM:7244 B0 02					     BCS     loc_7248
ROM:7246 A9 06					     LDA     #6
ROM:7248
ROM:7248	     loc_7248:
ROM:7248 C9 20					     CMP     #20h ; ' '
ROM:724A 90 02					     BCC     locret_724E
ROM:724C A9 1F					     LDA     #1Fh
ROM:724E
ROM:724E	     locret_724E:
ROM:724E 60					     RTS
ROM:724E	     ; End of function sub_7233
ROM:724E
ROM:724F
ROM:724F	     ; =============== S U B R O U T I N E =======================================
ROM:724F
ROM:724F
ROM:724F	     display_C_scores_ships:
ROM:724F A9 10					     LDA     #10h
ROM:7251 85 00					     STA     globalScale
ROM:7253 A9 50					     LDA     #50h ; 'P'
ROM:7255 A2 A4					     LDX     #0A4h ; '§'             ; addr = 0x50A4
ROM:7257 20 FC 7B				     JSR     write_JSR_cmd	     ; "(C)1979 ATARI INC"
ROM:725A A9 19					     LDA     #25		     ; X coord (x4=100)
ROM:725C A2 DB					     LDX     #219		     ; Y coord (x4=876)
ROM:725E 20 03 7C				     JSR     write_CURx4_cmd
ROM:7261 A9 70					     LDA     #70h ; 'p'              ; scale = 7
ROM:7263 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:7266 A2 00					     LDX     #0
ROM:7268 A5 1C					     LDA     numPlayers
ROM:726A C9 02					     CMP     #2			     ; 2 players?
ROM:726C D0 18					     BNE     loc_7286		     ; no, skip
ROM:726E A5 18					     LDA     curPlayer		     ; player 1?
ROM:7270 D0 14					     BNE     loc_7286		     ; yes, skip
ROM:7272 A2 20					     LDX     #20h ; ' '
ROM:7274 AD 1B 02				     LDA     p1PlayerFlag
ROM:7277 05 59					     ORA     hyperspaceFlag
ROM:7279 D0 0B					     BNE     loc_7286
ROM:727B AD FA 02				     LDA     shipSpawnTimer
ROM:727E 30 06					     BMI     loc_7286
ROM:7280 A5 5C					     LDA     fastTimer
ROM:7282 29 10					     AND     #10h
ROM:7284 F0 0D					     BEQ     loc_7293		     ; not every frame
ROM:7286
ROM:7286	     loc_7286:
ROM:7286 A9 52					     LDA     #p1ScoreTens
ROM:7288 A0 02					     LDY     #2			     ; 2 bytes to display
ROM:728A 38					     SEC			     ; flag no zero padding
ROM:728B 20 3F 77				     JSR     display_numeric	     ; display P1 score
ROM:728E A9 00					     LDA     #0
ROM:7290 20 8B 77				     JSR     display_pad_digit	     ; display score units (=0)
ROM:7293
ROM:7293	     loc_7293:							     ; X coord (x4=160)
ROM:7293 A9 28					     LDA     #40
ROM:7295 A4 57					     LDY     numShipsP1
ROM:7297 20 3E 6F				     JSR     display_extra_ships
ROM:729A A9 00					     LDA     #0
ROM:729C 85 00					     STA     globalScale
ROM:729E A9 78					     LDA     #120		     ; X coord (x4=480)
ROM:72A0 A2 DB					     LDX     #219		     ; y coord (x4=876)
ROM:72A2 20 03 7C				     JSR     write_CURx4_cmd
ROM:72A5 A9 50					     LDA     #50h ; 'P'              ; scale = 5
ROM:72A7 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:72AA A9 1D					     LDA     #highScoreTable
ROM:72AC A0 02					     LDY     #2			     ; 2 bytes to display
ROM:72AE 38					     SEC			     ; flag no zero padding
ROM:72AF 20 3F 77				     JSR     display_numeric	     ; display high score
ROM:72B2 A9 00					     LDA     #0
ROM:72B4 20 D1 7B				     JSR     display_digit_A	     ; display high score units	(=0)
ROM:72B7 A9 10					     LDA     #10h
ROM:72B9 85 00					     STA     globalScale
ROM:72BB A9 C0					     LDA     #192		     ; X coord (x4=768)
ROM:72BD A2 DB					     LDX     #219		     ; Y coord (x4=876)
ROM:72BF 20 03 7C				     JSR     write_CURx4_cmd
ROM:72C2 A9 50					     LDA     #50h ; 'P'              ; scale = 5
ROM:72C4 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:72C7 A2 00					     LDX     #0
ROM:72C9 A5 1C					     LDA     numPlayers
ROM:72CB C9 01					     CMP     #1			     ; 1 player	only?
ROM:72CD F0 2E					     BEQ     locret_72FD	     ; yes, exit
ROM:72CF 90 18					     BCC     loc_72E9
ROM:72D1 A5 18					     LDA     curPlayer
ROM:72D3 F0 14					     BEQ     loc_72E9
ROM:72D5 A2 20					     LDX     #20h ; ' '
ROM:72D7 AD 1B 02				     LDA     p1PlayerFlag
ROM:72DA 05 59					     ORA     hyperspaceFlag
ROM:72DC D0 0B					     BNE     loc_72E9
ROM:72DE AD FA 02				     LDA     shipSpawnTimer
ROM:72E1 30 06					     BMI     loc_72E9
ROM:72E3 A5 5C					     LDA     fastTimer
ROM:72E5 29 10					     AND     #10h
ROM:72E7 F0 0D					     BEQ     loc_72F6		     ; not every frame
ROM:72E9
ROM:72E9	     loc_72E9:
ROM:72E9 A9 54					     LDA     #p2ScoreTens
ROM:72EB A0 02					     LDY     #2			     ; 2 bytes to display
ROM:72ED 38					     SEC			     ; flag no zero padding
ROM:72EE 20 3F 77				     JSR     display_numeric	     ; display P2 score
ROM:72F1 A9 00					     LDA     #0
ROM:72F3 20 8B 77				     JSR     display_pad_digit	     ; display score units (=0)
ROM:72F6
ROM:72F6	     loc_72F6:							     ; X coord (x4=828)
ROM:72F6 A9 CF					     LDA     #207
ROM:72F8 A4 58					     LDY     numShipsP2
ROM:72FA 4C 3E 6F				     JMP     display_extra_ships
ROM:72FD	     ; ---------------------------------------------------------------------------
ROM:72FD
ROM:72FD	     locret_72FD:
ROM:72FD 60					     RTS
ROM:72FD	     ; End of function display_C_scores_ships
ROM:72FD
ROM:72FE
ROM:72FE	     ; =============== S U B R O U T I N E =======================================
ROM:72FE
ROM:72FE
ROM:72FE	     display_object:
ROM:72FE 84 00					     STY     globalScale
ROM:7300 86 0D					     STX     byte_D		     ; object offset (from P1RAM)
ROM:7302 A5 05					     LDA     byte_5
ROM:7304 4A					     LSR     A
ROM:7305 66 04					     ROR     byte_4
ROM:7307 4A					     LSR     A
ROM:7308 66 04					     ROR     byte_4
ROM:730A 4A					     LSR     A
ROM:730B 66 04					     ROR     byte_4
ROM:730D 85 05					     STA     byte_5		     ; 5:4 /= 8
ROM:730F A5 07					     LDA     byte_7
ROM:7311 18					     CLC
ROM:7312 69 04					     ADC     #4
ROM:7314 4A					     LSR     A
ROM:7315 66 06					     ROR     byte_6
ROM:7317 4A					     LSR     A
ROM:7318 66 06					     ROR     byte_6
ROM:731A 4A					     LSR     A
ROM:731B 66 06					     ROR     byte_6
ROM:731D 85 07					     STA     byte_7		     ; 7:6 = (7:6+1024)/8
ROM:731F A2 04					     LDX     #4			     ; base of temp coordinates
ROM:7321 20 1C 7C				     JSR     write_CUR_cmd
ROM:7324 A9 70					     LDA     #70h ; 'p'
ROM:7326 38					     SEC
ROM:7327 E5 00					     SBC     globalScale
ROM:7329 C9 A0					     CMP     #0A0h ; '†'
ROM:732B 90 0E					     BCC     loc_733B
ROM:732D
ROM:732D	     loc_732D:
ROM:732D 48					     PHA
ROM:732E A9 90					     LDA     #90h ; 'ê'
ROM:7330 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:7333 68					     PLA
ROM:7334 38					     SEC
ROM:7335 E9 10					     SBC     #10h
ROM:7337 C9 A0					     CMP     #0A0h ; '†'
ROM:7339 B0 F2					     BCS     loc_732D
ROM:733B
ROM:733B	     loc_733B:
ROM:733B 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:733E A6 0D					     LDX     byte_D		     ; restore object offset
ROM:7340 BD 00 02				     LDA     P1RAM,X		     ; get entry (again)
ROM:7343 10 16					     BPL     display_shot_ship_asteroid_or_saucer
ROM:7345 E0 1B					     CPX     #1Bh		     ; PlayerFlag?
ROM:7347 F0 0C					     BEQ     loc_7355		     ; yes, go
ROM:7349 29 0C					     AND     #0Ch		     ; pattern (3:2)
ROM:734B 4A					     LSR     A			     ; pattern (2:1)
ROM:734C A8					     TAY			     ; pattern = word offset
ROM:734D B9 F8 50				     LDA     (DVGROM+0F8h),Y	     ; shrapnel	table address LSB
ROM:7350 BE F9 50				     LDX     (DVGROM+0F9h),Y	     ; shrapnel	table address MSB
ROM:7353 D0 1B					     BNE     loc_7370		     ; always
ROM:7355
ROM:7355	     loc_7355:
ROM:7355 20 65 74				     JSR     display_exploding_ship
ROM:7358 A6 0D					     LDX     byte_D		     ; restore object offset
ROM:735A 60					     RTS
ROM:735B	     ; ---------------------------------------------------------------------------
ROM:735B
ROM:735B	     display_shot_ship_asteroid_or_saucer:			     ; PlayerFlag?
ROM:735B E0 1B					     CPX     #1Bh
ROM:735D F0 17					     BEQ     display_ship	     ; yes, go
ROM:735F E0 1C					     CPX     #1Ch		     ; SaucerFlag?
ROM:7361 F0 19					     BEQ     display_saucer	     ; yes, go
ROM:7363 B0 1F					     BCS     display_shot	     ; shot, go
ROM:7365 29 18					     AND     #18h		     ; pattern (4:3)
ROM:7367 4A					     LSR     A
ROM:7368 4A					     LSR     A			     ; pattern (2:1)
ROM:7369 A8					     TAY			     ; pattern = word offset
ROM:736A B9 DE 51				     LDA     (DVGROM+1DEh),Y	     ; asteroid	table address LSB
ROM:736D BE DF 51				     LDX     (DVGROM+1DFh),Y	     ; asteroid	table address MSB
ROM:7370
ROM:7370	     loc_7370:							     ; writes JSR instruction
ROM:7370 20 45 7D				     JSR     write_AX_to_avgram
ROM:7373 A6 0D					     LDX     byte_D		     ; restore object offset
ROM:7375 60					     RTS
ROM:7376	     ; ---------------------------------------------------------------------------
ROM:7376
ROM:7376	     display_ship:
ROM:7376 20 0B 75				     JSR     calc_ship_and_render
ROM:7379 A6 0D					     LDX     byte_D		     ; restore object offset
ROM:737B 60					     RTS
ROM:737C	     ; ---------------------------------------------------------------------------
ROM:737C
ROM:737C	     display_saucer:						     ; saucer table address LSB
ROM:737C AD 50 52				     LDA     DVGROM+250h
ROM:737F AE 51 52				     LDX     DVGROM+251h	     ; saucer table address MSB
ROM:7382 D0 EC					     BNE     loc_7370		     ; always
ROM:7384
ROM:7384	     display_shot:
ROM:7384 A9 70					     LDA     #70h ; 'p'
ROM:7386 A2 F0					     LDX     #0F0h ; ''
ROM:7388 20 E0 7C				     JSR     set_scale_A_bright_X
ROM:738B A6 0D					     LDX     byte_D		     ; restore object offset
ROM:738D A5 5C					     LDA     fastTimer
ROM:738F 29 03					     AND     #3			     ; time to dec?
ROM:7391 D0 03					     BNE     locret_7396	     ; no, skip
ROM:7393 DE 00 02				     DEC     P1RAM,X
ROM:7396
ROM:7396	     locret_7396:
ROM:7396 60					     RTS
ROM:7396	     ; End of function display_object
ROM:7396
ROM:7397
ROM:7397	     ; =============== S U B R O U T I N E =======================================
ROM:7397
ROM:7397
ROM:7397	     add_A_to_score:
ROM:7397 F8					     SED
ROM:7398 75 52					     ADC     p1ScoreTens,X
ROM:739A 95 52					     STA     p1ScoreTens,X
ROM:739C 90 12					     BCC     loc_73B0
ROM:739E B5 53					     LDA     p1ScoreThousands,X
ROM:73A0 69 00					     ADC     #0
ROM:73A2 95 53					     STA     p1ScoreThousands,X
ROM:73A4 29 0F					     AND     #0Fh		     ; another 10,000?
ROM:73A6 D0 08					     BNE     loc_73B0		     ; no, skip
ROM:73A8 A9 B0					     LDA     #0B0h ; '∞'
ROM:73AA 85 68					     STA     timerBonusShipSound
ROM:73AC A6 18					     LDX     curPlayer
ROM:73AE F6 57					     INC     numShipsP1,X	     ; extra ship!
ROM:73B0
ROM:73B0	     loc_73B0:
ROM:73B0 D8					     CLD
ROM:73B1 60					     RTS
ROM:73B1	     ; End of function add_A_to_score
ROM:73B1
ROM:73B2
ROM:73B2	     ; =============== S U B R O U T I N E =======================================
ROM:73B2
ROM:73B2
ROM:73B2	     set_RAMSEL_for_player:
ROM:73B2 A5 18					     LDA     curPlayer		     ; 0/1
ROM:73B4 0A					     ASL     A
ROM:73B5 0A					     ASL     A			     ; 0/4
ROM:73B6 85 08					     STA     byte_8
ROM:73B8 A5 6F					     LDA     io3200ShadowRegister
ROM:73BA 29 FB					     AND     #0FBh ; '˚'             ; mask off RAMSEL
ROM:73BC 05 08					     ORA     byte_8		     ; OR in new RAMSEL
ROM:73BE 85 6F					     STA     io3200ShadowRegister
ROM:73C0 8D 00 32				     STA     3200h
ROM:73C3 60					     RTS
ROM:73C3	     ; End of function set_RAMSEL_for_player
ROM:73C3
ROM:73C4
ROM:73C4	     ; =============== S U B R O U T I N E =======================================
ROM:73C4
ROM:73C4
ROM:73C4	     display_high_score_table:
ROM:73C4 A5 1C					     LDA     numPlayers		     ; game active?
ROM:73C6 F0 02					     BEQ     loc_73CA		     ; no, skip
ROM:73C8
ROM:73C8	     loc_73C8:							     ; flag game active
ROM:73C8 18					     CLC
ROM:73C9 60					     RTS
ROM:73CA	     ; ---------------------------------------------------------------------------
ROM:73CA
ROM:73CA	     loc_73CA:
ROM:73CA A5 5D					     LDA     slowTimer
ROM:73CC 29 04					     AND     #4
ROM:73CE D0 F8					     BNE     loc_73C8
ROM:73D0 A5 1D					     LDA     highScoreTable
ROM:73D2 05 1E					     ORA     highScoreTable+1
ROM:73D4 F0 F2					     BEQ     loc_73C8
ROM:73D6 A0 00					     LDY     #0			     ; "HIGH SCORES"
ROM:73D8 20 F6 77				     JSR     PrintPackedMsg
ROM:73DB A2 00					     LDX     #0
ROM:73DD 86 10					     STX     initial_offset	     ; offset into initials
ROM:73DF A9 01					     LDA     #1
ROM:73E1 85 00					     STA     globalScale
ROM:73E3 A9 A7					     LDA     #167		     ; starting	Y coord	(x4=668)
ROM:73E5 85 0E					     STA     byte_E
ROM:73E7 A9 10					     LDA     #16
ROM:73E9 85 00					     STA     globalScale
ROM:73EB
ROM:73EB	     display_hs_entry:
ROM:73EB B5 1D					     LDA     highScoreTable,X
ROM:73ED 15 1E					     ORA     (highScoreTable+1),X    ; end of table?
ROM:73EF F0 67					     BEQ     loc_7458		     ; yes, exit
ROM:73F1 86 0F					     STX     byte_F		     ; entry counter (x2)
ROM:73F3 A9 5F					     LDA     #95		     ; x coord (x4=380)
ROM:73F5 A6 0E					     LDX     byte_E		     ; y coord
ROM:73F7 20 03 7C				     JSR     write_CURx4_cmd
ROM:73FA A9 40					     LDA     #40h ; '@'              ; S=4
ROM:73FC 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:73FF A5 0F					     LDA     byte_F		     ; entry counter (x2)
ROM:7401 4A					     LSR     A			     ; x1
ROM:7402 F8					     SED
ROM:7403 69 01					     ADC     #1
ROM:7405 D8					     CLD
ROM:7406 85 0D					     STA     byte_D		     ; number buffer for printing
ROM:7408 A9 0D					     LDA     #byte_D		     ; ptr number buffer
ROM:740A 38					     SEC			     ; flag no zero padding
ROM:740B A0 01					     LDY     #1			     ; 1 byte to print
ROM:740D A2 00					     LDX     #0			     ; pad digit
ROM:740F 20 3F 77				     JSR     display_numeric	     ; display entry no.
ROM:7412 A9 40					     LDA     #40h ; '@'              ; S=4
ROM:7414 AA					     TAX			     ; Brightness=4
ROM:7415 20 E0 7C				     JSR     set_scale_A_bright_X    ; displays	a dot???
ROM:7418 A0 00					     LDY     #0			     ; <space>
ROM:741A 20 35 6F				     JSR     display_char_code_Y
ROM:741D A5 0F					     LDA     byte_F		     ; entry counter (x2)
ROM:741F 18					     CLC
ROM:7420 69 1D					     ADC     #highScoreTable	     ; get ptr entry (score)
ROM:7422 A0 02					     LDY     #2			     ; 2 bytes to print
ROM:7424 38					     SEC			     ; flag no zero padding
ROM:7425 A2 00					     LDX     #0			     ; pad digit
ROM:7427 20 3F 77				     JSR     display_numeric	     ; display score
ROM:742A A9 00					     LDA     #0
ROM:742C 20 D1 7B				     JSR     display_digit_A
ROM:742F A0 00					     LDY     #0			     ; <space>
ROM:7431 20 35 6F				     JSR     display_char_code_Y
ROM:7434 A4 10					     LDY     initial_offset	     ; get 1st initial
ROM:7436 20 1A 6F				     JSR     display_initial
ROM:7439 E6 10					     INC     initial_offset
ROM:743B A4 10					     LDY     initial_offset	     ; get 2nd initial
ROM:743D 20 1A 6F				     JSR     display_initial
ROM:7440 E6 10					     INC     initial_offset
ROM:7442 A4 10					     LDY     initial_offset	     ; get 3rd initial
ROM:7444 20 1A 6F				     JSR     display_initial
ROM:7447 E6 10					     INC     initial_offset
ROM:7449 A5 0E					     LDA     byte_E		     ; y coord
ROM:744B 38					     SEC
ROM:744C E9 08					     SBC     #8			     ; adjust for next line
ROM:744E 85 0E					     STA     byte_E		     ; update
ROM:7450 A6 0F					     LDX     byte_F		     ; entry counter (x2)
ROM:7452 E8					     INX
ROM:7453 E8					     INX			     ; +2
ROM:7454 E0 14					     CPX     #20		     ; done all	10 entries?
ROM:7456 90 93					     BCC     display_hs_entry	     ; no, loop
ROM:7458
ROM:7458	     loc_7458:
ROM:7458 38					     SEC
ROM:7459 60					     RTS
ROM:7459	     ; End of function display_high_score_table
ROM:7459
ROM:745A
ROM:745A	     ; =============== S U B R O U T I N E =======================================
ROM:745A
ROM:745A
ROM:745A	     sub_745A:
ROM:745A A2 1A					     LDX     #1Ah
ROM:745A	     ; End of function sub_745A
ROM:745A
ROM:745C
ROM:745C	     ; =============== S U B R O U T I N E =======================================
ROM:745C
ROM:745C
ROM:745C	     sub_745C:
ROM:745C BD 00 02				     LDA     P1RAM,X
ROM:745F F0 03					     BEQ     locret_7464
ROM:7461 CA					     DEX
ROM:7462 10 F8					     BPL     sub_745C
ROM:7464
ROM:7464	     locret_7464:
ROM:7464 60					     RTS
ROM:7464	     ; End of function sub_745C
ROM:7464
ROM:7465
ROM:7465	     ; =============== S U B R O U T I N E =======================================
ROM:7465
ROM:7465
ROM:7465	     display_exploding_ship:
ROM:7465 AD 1B 02				     LDA     p1PlayerFlag
ROM:7468 C9 A2					     CMP     #0A2h ; '¢'             ; 2 frames past exploding?
ROM:746A B0 22					     BCS     loc_748E
ROM:746C A2 0A					     LDX     #0Ah
ROM:746E
ROM:746E	     loc_746E:
ROM:746E BD EC 50				     LDA     (DVGROM+0ECh),X
ROM:7471 4A					     LSR     A
ROM:7472 4A					     LSR     A
ROM:7473 4A					     LSR     A
ROM:7474 4A					     LSR     A
ROM:7475 18					     CLC
ROM:7476 69 F8					     ADC     #0F8h ; '¯'
ROM:7478 49 F8					     EOR     #0F8h ; '¯'
ROM:747A 95 7E					     STA     7Eh,X
ROM:747C BD ED 50				     LDA     (DVGROM+0EDh),X
ROM:747F 4A					     LSR     A
ROM:7480 4A					     LSR     A
ROM:7481 4A					     LSR     A
ROM:7482 4A					     LSR     A
ROM:7483 18					     CLC
ROM:7484 69 F8					     ADC     #0F8h ; '¯'
ROM:7486 49 F8					     EOR     #0F8h ; '¯'
ROM:7488 95 8A					     STA     8Ah,X
ROM:748A CA					     DEX
ROM:748B CA					     DEX
ROM:748C 10 E0					     BPL     loc_746E
ROM:748E
ROM:748E	     loc_748E:
ROM:748E AD 1B 02				     LDA     p1PlayerFlag
ROM:7491 49 FF					     EOR     #0FFh
ROM:7493 29 70					     AND     #70h ; 'p'
ROM:7495 4A					     LSR     A
ROM:7496 4A					     LSR     A
ROM:7497 4A					     LSR     A
ROM:7498 AA					     TAX
ROM:7499
ROM:7499	     loc_7499:
ROM:7499 86 09					     STX     byte_9
ROM:749B A0 00					     LDY     #0
ROM:749D BD EC 50				     LDA     (DVGROM+0ECh),X
ROM:74A0 10 01					     BPL     loc_74A3
ROM:74A2 88					     DEY
ROM:74A3
ROM:74A3	     loc_74A3:
ROM:74A3 18					     CLC
ROM:74A4 75 7D					     ADC     7Dh,X
ROM:74A6 95 7D					     STA     7Dh,X
ROM:74A8 98					     TYA
ROM:74A9 75 7E					     ADC     7Eh,X
ROM:74AB 95 7E					     STA     7Eh,X
ROM:74AD 85 04					     STA     byte_4
ROM:74AF 84 05					     STY     byte_5
ROM:74B1 A0 00					     LDY     #0
ROM:74B3 BD ED 50				     LDA     (DVGROM+0EDh),X
ROM:74B6 10 01					     BPL     loc_74B9
ROM:74B8 88					     DEY
ROM:74B9
ROM:74B9	     loc_74B9:
ROM:74B9 18					     CLC
ROM:74BA 75 89					     ADC     89h,X
ROM:74BC 95 89					     STA     89h,X
ROM:74BE 98					     TYA
ROM:74BF 75 8A					     ADC     8Ah,X
ROM:74C1 95 8A					     STA     8Ah,X
ROM:74C3 85 06					     STA     byte_6
ROM:74C5 84 07					     STY     byte_7
ROM:74C7 A5 02					     LDA     dvg_curr_addr_lsb
ROM:74C9 85 0B					     STA     byte_B
ROM:74CB A5 03					     LDA     dvg_curr_addr_msb
ROM:74CD 85 0C					     STA     byte_C
ROM:74CF 20 49 7C				     JSR     sub_7C49
ROM:74D2 A4 09					     LDY     byte_9
ROM:74D4 B9 E0 50				     LDA     (DVGROM+0E0h),Y	     ; wrecked ship table address LSB
ROM:74D7 BE E1 50				     LDX     (DVGROM+0E1h),Y	     ; wrecked ship table address MSB
ROM:74DA 20 45 7D				     JSR     write_AX_to_avgram
ROM:74DD A4 09					     LDY     byte_9
ROM:74DF B9 E1 50				     LDA     (DVGROM+0E1h),Y	     ; wrecked ship table address MSB
ROM:74E2 49 04					     EOR     #4
ROM:74E4 AA					     TAX
ROM:74E5 B9 E0 50				     LDA     (DVGROM+0E0h),Y	     ; wrecked ship table address LSB
ROM:74E8 29 0F					     AND     #0Fh
ROM:74EA 49 04					     EOR     #4
ROM:74EC 20 45 7D				     JSR     write_AX_to_avgram
ROM:74EF A0 FF					     LDY     #0FFh
ROM:74F1
ROM:74F1	     loc_74F1:
ROM:74F1 C8					     INY
ROM:74F2 B1 0B					     LDA     (0Bh),Y
ROM:74F4 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:74F6 C8					     INY
ROM:74F7 B1 0B					     LDA     (0Bh),Y
ROM:74F9 49 04					     EOR     #4
ROM:74FB 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:74FD C0 03					     CPY     #3
ROM:74FF 90 F0					     BCC     loc_74F1
ROM:7501 20 39 7C				     JSR     update_avg_curr_addr
ROM:7504 A6 09					     LDX     byte_9
ROM:7506 CA					     DEX
ROM:7507 CA					     DEX
ROM:7508 10 8F					     BPL     loc_7499
ROM:750A 60					     RTS
ROM:750A	     ; End of function display_exploding_ship
ROM:750A
ROM:750B
ROM:750B	     ; =============== S U B R O U T I N E =======================================
ROM:750B
ROM:750B
ROM:750B	     calc_ship_and_render:
ROM:750B A2 00					     LDX     #0			     ; default positive	delta
ROM:750D 86 17					     STX     byte_17
ROM:750F A0 00					     LDY     #0			     ; default positive	delta
ROM:7511 A5 61					     LDA     direction
ROM:7513 10 06					     BPL     loc_751B		     ; positive, skip
ROM:7515 A0 04					     LDY     #4			     ; flag negative delta
ROM:7517 8A					     TXA			     ; 0
ROM:7518 38					     SEC
ROM:7519 E5 61					     SBC     direction
ROM:751B
ROM:751B	     loc_751B:							     ; ABS(direction)
ROM:751B 85 08					     STA     byte_8
ROM:751D 24 08					     BIT     byte_8
ROM:751F 30 02					     BMI     loc_7523		     ; b7=1
ROM:7521 50 07					     BVC     loc_752A		     ; b6=0
ROM:7523
ROM:7523	     loc_7523:							     ; flag negative delta
ROM:7523 A2 04					     LDX     #4
ROM:7525 A9 80					     LDA     #80h ; 'Ä'
ROM:7527 38					     SEC
ROM:7528 E5 08					     SBC     byte_8
ROM:752A
ROM:752A	     loc_752A:							     ; flag for	flip X
ROM:752A 86 08					     STX     byte_8
ROM:752C 84 09					     STY     byte_9		     ; flag for	flip Y
ROM:752E 4A					     LSR     A
ROM:752F 29 FE					     AND     #0FEh ; '˛'
ROM:7531 A8					     TAY
ROM:7532 B9 6E 52				     LDA     (DVGROM+26Eh),Y	     ; ship table address LSB
ROM:7535 BE 6F 52				     LDX     (DVGROM+26Fh),Y	     ; ship table address MSB
ROM:7538 20 D3 6A				     JSR     copy_vector_from_table_to_avgram
ROM:753B AD 05 24				     LDA     thrustSwitch	     ; thrust?
ROM:753E 10 14					     BPL     locret_7554	     ; no, exit
ROM:7540 A5 5C					     LDA     fastTimer
ROM:7542 29 04					     AND     #4			     ; time to display thrust?
ROM:7544 F0 0E					     BEQ     locret_7554	     ; no, exit
ROM:7546 C8					     INY
ROM:7547 C8					     INY			     ; Y=2???
ROM:7548 38					     SEC
ROM:7549 A6 0C					     LDX     byte_C
ROM:754B 98					     TYA
ROM:754C 65 0B					     ADC     byte_B
ROM:754E 90 01					     BCC     loc_7551
ROM:7550 E8					     INX			     ; BC+=2
ROM:7551
ROM:7551	     loc_7551:
ROM:7551 20 D3 6A				     JSR     copy_vector_from_table_to_avgram
ROM:7554
ROM:7554	     locret_7554:
ROM:7554 60					     RTS
ROM:7554	     ; End of function calc_ship_and_render
ROM:7554
ROM:7555
ROM:7555	     ; =============== S U B R O U T I N E =======================================
ROM:7555
ROM:7555
ROM:7555	     handle_sounds:
ROM:7555 A5 1C					     LDA     numPlayers		     ; game active?
ROM:7557 D0 01					     BNE     update_sounds	     ; yes, update all sounds
ROM:7559 60					     RTS
ROM:755A	     ; ---------------------------------------------------------------------------
ROM:755A
ROM:755A	     update_sounds:
ROM:755A A2 00					     LDX     #0
ROM:755C AD 1C 02				     LDA     p1SaucerFlag
ROM:755F 30 0A					     BMI     loc_756B		     ; exploding, skip
ROM:7561 F0 08					     BEQ     loc_756B		     ; no saucer, skip
ROM:7563 6A					     ROR     A
ROM:7564 6A					     ROR     A
ROM:7565 6A					     ROR     A
ROM:7566 8D 02 3C				     STA     3C02h		     ; sound select (large/small saucer)
ROM:7569 A2 80					     LDX     #80h ; 'Ä'              ; enable sound
ROM:756B
ROM:756B	     loc_756B:							     ; sound (saucer)
ROM:756B 8E 00 3C				     STX     3C00h
ROM:756E A2 01					     LDX     #1			     ; index to	saucer fire sound
ROM:7570 20 CD 75				     JSR     update_player_saucer_sound
ROM:7573 8D 01 3C				     STA     3C01h		     ; sound (saucer fire)
ROM:7576 CA					     DEX			     ; index to	player sound
ROM:7577 20 CD 75				     JSR     update_player_saucer_sound
ROM:757A 8D 04 3C				     STA     3C04h		     ; sound (ship fire)
ROM:757D AD 1B 02				     LDA     p1PlayerFlag
ROM:7580 C9 01					     CMP     #1			     ; alive?
ROM:7582 F0 04					     BEQ     loc_7588		     ; yes, skip
ROM:7584 8A					     TXA
ROM:7585 8D 03 3C				     STA     3C03h		     ; sound (ship thrust)
ROM:7588
ROM:7588	     loc_7588:
ROM:7588 AD F6 02				     LDA     currentNumberOfAsteroids
ROM:758B F0 11					     BEQ     loc_759E
ROM:758D AD 1B 02				     LDA     p1PlayerFlag	     ; alive?
ROM:7590 30 0C					     BMI     loc_759E		     ; no, skip
ROM:7592 05 59					     ORA     hyperspaceFlag	     ; hyperspace?
ROM:7594 F0 08					     BEQ     loc_759E		     ; not active, skip
ROM:7596 A5 6D					     LDA     timerThumpSoundOn
ROM:7598 F0 14					     BEQ     loc_75AE		     ; off, skip
ROM:759A C6 6D					     DEC     timerThumpSoundOn	     ; update thump sound timer
ROM:759C D0 21					     BNE     loc_75BF		     ; not done, skip
ROM:759E
ROM:759E	     loc_759E:
ROM:759E A5 6C					     LDA     volFreqThumpSound
ROM:75A0 29 0F					     AND     #0Fh
ROM:75A2 85 6C					     STA     volFreqThumpSound
ROM:75A4 8D 00 3A				     STA     3A00h		     ; sound (thump)
ROM:75A7 AD FC 02				     LDA     byte_2FC
ROM:75AA 85 6E					     STA     timerThumpSoundOff
ROM:75AC 10 11					     BPL     loc_75BF
ROM:75AE
ROM:75AE	     loc_75AE:							     ; update timer
ROM:75AE C6 6E					     DEC     timerThumpSoundOff
ROM:75B0 D0 0D					     BNE     loc_75BF		     ; not done, skip
ROM:75B2 A9 04					     LDA     #4
ROM:75B4 85 6D					     STA     timerThumpSoundOn	     ; init thump on timer
ROM:75B6 A5 6C					     LDA     volFreqThumpSound
ROM:75B8 49 14					     EOR     #14h
ROM:75BA 85 6C					     STA     volFreqThumpSound
ROM:75BC 8D 00 3A				     STA     3A00h		     ; sound (thump)
ROM:75BF
ROM:75BF	     loc_75BF:
ROM:75BF A5 69					     LDA     timerExplosionSound
ROM:75C1 AA					     TAX
ROM:75C2 29 3F					     AND     #3Fh ; '?'              ; exploding sound on?
ROM:75C4 F0 01					     BEQ     loc_75C7		     ; no, skip
ROM:75C6 CA					     DEX			     ; update timer
ROM:75C7
ROM:75C7	     loc_75C7:
ROM:75C7 86 69					     STX     timerExplosionSound
ROM:75C9 8E 00 36				     STX     3600h		     ; sound (explosion)
ROM:75CC 60					     RTS
ROM:75CC	     ; End of function handle_sounds
ROM:75CC
ROM:75CD
ROM:75CD	     ; =============== S U B R O U T I N E =======================================
ROM:75CD
ROM:75CD
ROM:75CD	     update_player_saucer_sound:
ROM:75CD B5 6A					     LDA     fireSoundFlagPlayer,X   ; player/saucer sound flag
ROM:75CF 30 0C					     BMI     loc_75DD		     ; branch if ON
ROM:75D1 B5 66					     LDA     timerPlayerFireSound,X  ; player/saucer fire sound	timer
ROM:75D3 10 12					     BPL     loc_75E7
ROM:75D5 A9 10					     LDA     #10h		     ; init value
ROM:75D7 95 66					     STA     timerPlayerFireSound,X  ; player/saucer fire sound	timer
ROM:75D9
ROM:75D9	     loc_75D9:							     ; turn on sound
ROM:75D9 A9 80					     LDA     #80h ; 'Ä'
ROM:75DB 30 0C					     BMI     loc_75E9		     ; exit
ROM:75DD
ROM:75DD	     loc_75DD:							     ; player/saucer fire sound	timer
ROM:75DD B5 66					     LDA     timerPlayerFireSound,X
ROM:75DF F0 06					     BEQ     loc_75E7		     ; done, turn off
ROM:75E1 30 04					     BMI     loc_75E7		     ; done, turn off
ROM:75E3 D6 66					     DEC     timerPlayerFireSound,X  ; dec timer
ROM:75E5 D0 F2					     BNE     loc_75D9		     ; not done, turn on
ROM:75E7
ROM:75E7	     loc_75E7:							     ; turn off	sound
ROM:75E7 A9 00					     LDA     #0
ROM:75E9
ROM:75E9	     loc_75E9:							     ; player/saucer sound flag
ROM:75E9 95 6A					     STA     fireSoundFlagPlayer,X
ROM:75EB 60					     RTS
ROM:75EB	     ; End of function update_player_saucer_sound
ROM:75EB
ROM:75EC
ROM:75EC	     ; =============== S U B R O U T I N E =======================================
ROM:75EC
ROM:75EC
ROM:75EC	     sub_75EC:
ROM:75EC 86 0D					     STX     byte_D
ROM:75EE A9 50					     LDA     #50h ; 'P'
ROM:75F0 8D F9 02				     STA     byte_2F9
ROM:75F3 B9 00 02				     LDA     P1RAM,Y
ROM:75F6 29 78					     AND     #78h ; 'x'
ROM:75F8 85 0E					     STA     byte_E
ROM:75FA B9 00 02				     LDA     P1RAM,Y
ROM:75FD 29 07					     AND     #7
ROM:75FF 4A					     LSR     A
ROM:7600 AA					     TAX
ROM:7601 F0 02					     BEQ     loc_7605
ROM:7603 05 0E					     ORA     byte_E
ROM:7605
ROM:7605	     loc_7605:
ROM:7605 99 00 02				     STA     P1RAM,Y
ROM:7608 A5 1C					     LDA     numPlayers		     ; real game?
ROM:760A F0 11					     BEQ     loc_761D		     ; no, skip
ROM:760C A5 0D					     LDA     byte_D
ROM:760E F0 04					     BEQ     loc_7614
ROM:7610 C9 04					     CMP     #4
ROM:7612 90 09					     BCC     loc_761D
ROM:7614
ROM:7614	     loc_7614:							     ; score for this asteroid
ROM:7614 BD 59 76				     LDA     asteroid_score_tbl,X
ROM:7617 A6 19					     LDX     curPlayer_x2	     ; offset to score for player
ROM:7619 18					     CLC
ROM:761A 20 97 73				     JSR     add_A_to_score	     ; add asteroid score
ROM:761D
ROM:761D	     loc_761D:
ROM:761D BE 00 02				     LDX     P1RAM,Y
ROM:7620 F0 34					     BEQ     loc_7656
ROM:7622 20 5A 74				     JSR     sub_745A
ROM:7625 30 2F					     BMI     loc_7656
ROM:7627 EE F6 02				     INC     currentNumberOfAsteroids
ROM:762A 20 9D 6A				     JSR     sub_6A9D
ROM:762D 20 03 72				     JSR     sub_7203
ROM:7630 BD 23 02				     LDA     asteroid_Vh,X
ROM:7633 29 1F					     AND     #1Fh
ROM:7635 0A					     ASL     A
ROM:7636 5D AF 02				     EOR     asteroid_PLh,X
ROM:7639 9D AF 02				     STA     asteroid_PLh,X
ROM:763C 20 5C 74				     JSR     sub_745C
ROM:763F 30 15					     BMI     loc_7656
ROM:7641 EE F6 02				     INC     currentNumberOfAsteroids
ROM:7644 20 9D 6A				     JSR     sub_6A9D
ROM:7647 20 03 72				     JSR     sub_7203
ROM:764A BD 46 02				     LDA     asteroid_Vv,X
ROM:764D 29 1F					     AND     #1Fh
ROM:764F 0A					     ASL     A
ROM:7650 5D D2 02				     EOR     asteroid_PLv,X
ROM:7653 9D D2 02				     STA     asteroid_PLv,X
ROM:7656
ROM:7656	     loc_7656:
ROM:7656 A6 0D					     LDX     byte_D
ROM:7658 60					     RTS
ROM:7658	     ; End of function sub_75EC
ROM:7658
ROM:7658	     ; ---------------------------------------------------------------------------
ROM:7659 10	     asteroid_score_tbl:	     .db  10h			     ; 100pts (small asteroid)
ROM:765A 05					     .db    5			     ; 50pts (medium asteroid)
ROM:765B 02					     .db    2			     ; 20pts (large asteroid)
ROM:765C
ROM:765C	     ; =============== S U B R O U T I N E =======================================
ROM:765C
ROM:765C
ROM:765C	     check_high_score:
ROM:765C A5 1C					     LDA     numPlayers		     ; game active?
ROM:765E 10 38					     BPL     locret_7698	     ; yes, skip
ROM:7660 A2 02					     LDX     #2			     ; 2 players to check
ROM:7662 85 5D					     STA     slowTimer
ROM:7664 85 32					     STA     placeP1HighScore
ROM:7666 85 33					     STA     placeP2HighScore
ROM:7668
ROM:7668	     loc_7668:
ROM:7668 A0 00					     LDY     #0
ROM:766A
ROM:766A	     loc_766A:
ROM:766A B9 1D 00				     LDA     highScoreTable,Y
ROM:766D D5 52					     CMP     p1ScoreTens,X
ROM:766F B9 1E 00				     LDA     (highScoreTable+1),Y
ROM:7672 F5 53					     SBC     p1ScoreThousands,X
ROM:7674 90 23					     BCC     insert_score_in_table   ; high score here,	exit
ROM:7676 C8					     INY
ROM:7677 C8					     INY			     ; next high score entry
ROM:7678 C0 14					     CPY     #20		     ; done all	10 entries (20 bytes)?
ROM:767A 90 EE					     BCC     loc_766A		     ; no, loop
ROM:767C
ROM:767C	     loc_767C:
ROM:767C CA					     DEX
ROM:767D CA					     DEX			     ; set to player 1
ROM:767E 10 E8					     BPL     loc_7668		     ; loop for	player 1
ROM:7680 A5 33					     LDA     placeP2HighScore
ROM:7682 30 0E					     BMI     loc_7692
ROM:7684 C5 32					     CMP     placeP1HighScore
ROM:7686 90 0A					     BCC     loc_7692
ROM:7688 69 02					     ADC     #2
ROM:768A C9 1E					     CMP     #30
ROM:768C 90 02					     BCC     loc_7690
ROM:768E A9 FF					     LDA     #0FFh
ROM:7690
ROM:7690	     loc_7690:
ROM:7690 85 33					     STA     placeP2HighScore
ROM:7692
ROM:7692	     loc_7692:
ROM:7692 A9 00					     LDA     #0
ROM:7694 85 1C					     STA     numPlayers		     ; flag game over
ROM:7696 85 31					     STA     letterHighScoreEntry
ROM:7698
ROM:7698	     locret_7698:
ROM:7698 60					     RTS
ROM:7699	     ; ---------------------------------------------------------------------------
ROM:7699
ROM:7699	     insert_score_in_table:					     ; player 1/2
ROM:7699 86 0B					     STX     byte_B
ROM:769B 84 0C					     STY     byte_C		     ; high score entry	offset
ROM:769D 8A					     TXA
ROM:769E 4A					     LSR     A			     ; 0=p1, 1=p2
ROM:769F AA					     TAX
ROM:76A0 98					     TYA
ROM:76A1 4A					     LSR     A			     ; high score entry	index
ROM:76A2 65 0C					     ADC     byte_C		     ; high score index	* 3
ROM:76A4 85 0D					     STA     byte_D		     ; offset into initials table?
ROM:76A6 95 32					     STA     placeP1HighScore,X
ROM:76A8 A2 1B					     LDX     #27		     ; offset of 10th initials
ROM:76AA A0 12					     LDY     #18
ROM:76AC
ROM:76AC	     loc_76AC:							     ; entry we're after?
ROM:76AC E4 0D					     CPX     byte_D
ROM:76AE F0 1F					     BEQ     loc_76CF		     ; yes, exit
ROM:76B0 B5 31					     LDA     letterHighScoreEntry,X
ROM:76B2 95 34					     STA     highScoreInitials,X
ROM:76B4 B5 32					     LDA     placeP1HighScore,X
ROM:76B6 95 35					     STA     (highScoreInitials+1),X
ROM:76B8 B5 33					     LDA     placeP2HighScore,X
ROM:76BA 95 36					     STA     (highScoreInitials+2),X
ROM:76BC B9 1B 00				     LDA     unk_1B,Y
ROM:76BF 99 1D 00				     STA     highScoreTable,Y
ROM:76C2 B9 1C 00				     LDA     numPlayers,Y
ROM:76C5 99 1E 00				     STA     (highScoreTable+1),Y    ; shift entry down
ROM:76C8 88					     DEY
ROM:76C9 88					     DEY			     ; next high score entry
ROM:76CA CA					     DEX
ROM:76CB CA					     DEX
ROM:76CC CA					     DEX			     ; next initials entry
ROM:76CD D0 DD					     BNE     loc_76AC		     ; not done, loop
ROM:76CF
ROM:76CF	     loc_76CF:							     ; 'A'
ROM:76CF A9 0B					     LDA     #0Bh
ROM:76D1 95 34					     STA     highScoreInitials,X
ROM:76D3 A9 00					     LDA     #0
ROM:76D5 95 35					     STA     (highScoreInitials+1),X
ROM:76D7 95 36					     STA     (highScoreInitials+2),X
ROM:76D9 A9 F0					     LDA     #0F0h ; ''
ROM:76DB 85 5D					     STA     slowTimer
ROM:76DD A6 0B					     LDX     byte_B		     ; player 1/2
ROM:76DF A4 0C					     LDY     byte_C		     ; high score entry	offset
ROM:76E1 B5 53					     LDA     p1ScoreThousands,X
ROM:76E3 99 1E 00				     STA     (highScoreTable+1),Y
ROM:76E6 B5 52					     LDA     p1ScoreTens,X
ROM:76E8 99 1D 00				     STA     highScoreTable,Y	     ; copy score into high score table
ROM:76EB A0 00					     LDY     #0
ROM:76ED F0 8D					     BEQ     loc_767C		     ; continue	with next entry
ROM:76EF
ROM:76EF	     loc_76EF:
ROM:76EF DF 98 10				     DCP     1098h,X
ROM:76EF	     ; End of function check_high_score
ROM:76EF
ROM:76F2 09 20					     ORA     #20h ; ' '
ROM:76F4 08					     PHP
ROM:76F5 77 20					     RRA     20h,X
ROM:76F7 FC 76 4C				     NOP
ROM:76FA 08					     PHP
ROM:76FB 77 A8					     RRA     0A8h,X
ROM:76FD 8A					     TXA
ROM:76FE 10 0E					     BPL     sub_770E
ROM:7700 20 08 77				     JSR     negate_A
ROM:7703 20 0E 77				     JSR     sub_770E
ROM:7706 49 80					     EOR     #80h ; 'Ä'
ROM:7708
ROM:7708	     ; =============== S U B R O U T I N E =======================================
ROM:7708
ROM:7708
ROM:7708	     negate_A:
ROM:7708 49 FF					     EOR     #0FFh
ROM:770A 18					     CLC
ROM:770B 69 01					     ADC     #1
ROM:770D 60					     RTS
ROM:770D	     ; End of function negate_A
ROM:770D
ROM:770E
ROM:770E	     ; =============== S U B R O U T I N E =======================================
ROM:770E
ROM:770E
ROM:770E	     sub_770E:
ROM:770E 85 0C					     STA     byte_C
ROM:7710 98					     TYA
ROM:7711 C5 0C					     CMP     byte_C
ROM:7713 F0 10					     BEQ     loc_7725
ROM:7715 90 11					     BCC     sub_7728
ROM:7717 A4 0C					     LDY     byte_C
ROM:7719 85 0C					     STA     byte_C
ROM:771B 98					     TYA
ROM:771C 20 28 77				     JSR     sub_7728
ROM:771F 38					     SEC
ROM:7720 E9 40					     SBC     #40h ; '@'
ROM:7722 4C 08 77				     JMP     negate_A
ROM:7725	     ; ---------------------------------------------------------------------------
ROM:7725
ROM:7725	     loc_7725:
ROM:7725 A9 20					     LDA     #20h ; ' '
ROM:7727 60					     RTS
ROM:7727	     ; End of function sub_770E
ROM:7727
ROM:7728
ROM:7728	     ; =============== S U B R O U T I N E =======================================
ROM:7728
ROM:7728
ROM:7728	     sub_7728:
ROM:7728 20 6C 77				     JSR     sub_776C
ROM:772B BD 2F 77				     LDA     unk_772F,X
ROM:772E 60					     RTS
ROM:772E	     ; End of function sub_7728
ROM:772E
ROM:772E	     ; ---------------------------------------------------------------------------
ROM:772F 00	     unk_772F:			     .db    0
ROM:7730 02					     .db    2
ROM:7731 05					     .db    5
ROM:7732 07					     .db    7
ROM:7733 0A					     .db  0Ah
ROM:7734 0C					     .db  0Ch
ROM:7735 0F					     .db  0Fh
ROM:7736 11					     .db  11h
ROM:7737 13					     .db  13h
ROM:7738 15					     .db  15h
ROM:7739 17					     .db  17h
ROM:773A 19					     .db  19h
ROM:773B 1A					     .db  1Ah
ROM:773C 1C					     .db  1Ch
ROM:773D 1D					     .db  1Dh
ROM:773E 1F					     .db  1Fh
ROM:773F	     A=buffer, Y=#bytes, X=pad digit
ROM:773F
ROM:773F	     ; =============== S U B R O U T I N E =======================================
ROM:773F
ROM:773F
ROM:773F	     display_numeric:
ROM:773F 08					     PHP
ROM:7740 86 17					     STX     byte_17		     ; store pad digit
ROM:7742 88					     DEY			     ; #bytes-1
ROM:7743 84 16					     STY     byte_16		     ; offset to last byte
ROM:7745 18					     CLC
ROM:7746 65 16					     ADC     byte_16		     ; bytes remaining
ROM:7748 85 15					     STA     byte_15		     ; ptr current byte
ROM:774A 28					     PLP
ROM:774B AA					     TAX			     ; X=buffer
ROM:774C
ROM:774C	     loc_774C:
ROM:774C 08					     PHP
ROM:774D B5 00					     LDA     0,X		     ; get next	byte
ROM:774F 4A					     LSR     A
ROM:7750 4A					     LSR     A
ROM:7751 4A					     LSR     A
ROM:7752 4A					     LSR     A			     ; high nibble -> low
ROM:7753 28					     PLP
ROM:7754 20 85 77				     JSR     display_digit
ROM:7757 A5 16					     LDA     byte_16		     ; bytes remaining?
ROM:7759 D0 01					     BNE     loc_775C		     ; no, skip
ROM:775B 18					     CLC			     ; flag padding
ROM:775C
ROM:775C	     loc_775C:							     ; ptr current byte
ROM:775C A6 15					     LDX     byte_15
ROM:775E B5 00					     LDA     0,X		     ; get byte	(low nibble)
ROM:7760 20 85 77				     JSR     display_digit
ROM:7763 C6 15					     DEC     byte_15		     ; ptr current byte
ROM:7765 A6 15					     LDX     byte_15
ROM:7767 C6 16					     DEC     byte_16		     ; done?
ROM:7769 10 E1					     BPL     loc_774C		     ; no, loop
ROM:776B 60					     RTS
ROM:776B	     ; End of function display_numeric
ROM:776B
ROM:776C
ROM:776C	     ; =============== S U B R O U T I N E =======================================
ROM:776C
ROM:776C
ROM:776C	     sub_776C:
ROM:776C A0 00					     LDY     #0
ROM:776E 84 0B					     STY     byte_B
ROM:7770 A0 04					     LDY     #4
ROM:7772
ROM:7772	     loc_7772:
ROM:7772 26 0B					     ROL     byte_B
ROM:7774 2A					     ROL     A
ROM:7775 C5 0C					     CMP     byte_C
ROM:7777 90 02					     BCC     loc_777B
ROM:7779 E5 0C					     SBC     byte_C
ROM:777B
ROM:777B	     loc_777B:
ROM:777B 88					     DEY
ROM:777C D0 F4					     BNE     loc_7772
ROM:777E A5 0B					     LDA     byte_B
ROM:7780 2A					     ROL     A
ROM:7781 29 0F					     AND     #0Fh
ROM:7783 AA					     TAX
ROM:7784 60					     RTS
ROM:7784	     ; End of function sub_776C
ROM:7784
ROM:7785
ROM:7785	     ; =============== S U B R O U T I N E =======================================
ROM:7785
ROM:7785
ROM:7785	     display_digit:
ROM:7785 90 04					     BCC     display_pad_digit	     ; skip if no pad flagged?
ROM:7787 29 0F					     AND     #0Fh		     ; any pad digit?
ROM:7789 F0 27					     BEQ     loc_77B2		     ; no, skip
ROM:7789	     ; End of function display_digit
ROM:7789
ROM:778B
ROM:778B	     ; =============== S U B R O U T I N E =======================================
ROM:778B
ROM:778B
ROM:778B	     display_pad_digit:
ROM:778B A6 17					     LDX     byte_17		     ; any pad digit?
ROM:778D F0 23					     BEQ     loc_77B2		     ; none, exit
ROM:778F 29 0F					     AND     #0Fh
ROM:7791 18					     CLC
ROM:7792 69 01					     ADC     #1
ROM:7794 08					     PHP
ROM:7795 0A					     ASL     A			     ; x2
ROM:7796 A8					     TAY			     ; word offset
ROM:7797 B9 D4 56				     LDA     (DVGROM+6D4h),Y	     ; chr fn
ROM:779A 0A					     ASL     A
ROM:779B 85 0B					     STA     byte_B
ROM:779D B9 D5 56				     LDA     (DVGROM+6D5h),Y	     ; chr fn
ROM:77A0 2A					     ROL     A
ROM:77A1 29 1F					     AND     #1Fh
ROM:77A3 09 40					     ORA     #40h ; '@'
ROM:77A5 85 0C					     STA     byte_C
ROM:77A7 A9 00					     LDA     #0
ROM:77A9 85 08					     STA     byte_8		     ; flag to flip X
ROM:77AB 85 09					     STA     byte_9		     ; flag to flip Y
ROM:77AD 20 D7 6A				     JSR     copy_vector_to_avgram
ROM:77B0 28					     PLP
ROM:77B1 60					     RTS
ROM:77B2	     ; ---------------------------------------------------------------------------
ROM:77B2
ROM:77B2	     loc_77B2:
ROM:77B2 4C CB 7B				     JMP     loc_7BCB
ROM:77B2	     ; End of function display_pad_digit
ROM:77B2
ROM:77B5
ROM:77B5	     ; =============== S U B R O U T I N E =======================================
ROM:77B5
ROM:77B5
ROM:77B5	     update_prng:
ROM:77B5 06 5F					     ASL     rnd1
ROM:77B7 26 60					     ROL     rnd2		     ; shift left 16-bit value
ROM:77B9 10 02					     BPL     loc_77BD		     ; no shift	out
ROM:77BB E6 5F					     INC     rnd1		     ; shift into low bit
ROM:77BD
ROM:77BD	     loc_77BD:
ROM:77BD A5 5F					     LDA     rnd1
ROM:77BF 2C D1 77				     BIT     byte_77D1		     ; tap on output of	bit0
ROM:77C2 F0 04					     BEQ     loc_77C8		     ; not set,	skip
ROM:77C4 49 01					     EOR     #1			     ; XOR bit0
ROM:77C6 85 5F					     STA     rnd1
ROM:77C8
ROM:77C8	     loc_77C8:							     ; check all 0
ROM:77C8 05 60					     ORA     rnd2
ROM:77CA D0 02					     BNE     loc_77CE		     ; no, skip
ROM:77CC E6 5F					     INC     rnd1		     ; =1
ROM:77CE
ROM:77CE	     loc_77CE:							     ; return low byte
ROM:77CE A5 5F					     LDA     rnd1
ROM:77D0 60					     RTS
ROM:77D0	     ; End of function update_prng
ROM:77D0
ROM:77D0	     ; ---------------------------------------------------------------------------
ROM:77D1 02	     byte_77D1:			     .db 2
ROM:77D2	     ; A=direction, Y=?
ROM:77D2
ROM:77D2	     ; =============== S U B R O U T I N E =======================================
ROM:77D2
ROM:77D2
ROM:77D2	     some_thrust_calc:
ROM:77D2 18					     CLC
ROM:77D3 69 40					     ADC     #40h ; '@'
ROM:77D3	     ; End of function some_thrust_calc
ROM:77D3
ROM:77D5
ROM:77D5	     ; =============== S U B R O U T I N E =======================================
ROM:77D5
ROM:77D5
ROM:77D5	     sub_77D5:
ROM:77D5 10 08					     BPL     sub_77DF
ROM:77D7 29 7F					     AND     #7Fh ; ''
ROM:77D9 20 DF 77				     JSR     sub_77DF
ROM:77DC 4C 08 77				     JMP     negate_A
ROM:77DC	     ; End of function sub_77D5
ROM:77DC
ROM:77DF
ROM:77DF	     ; =============== S U B R O U T I N E =======================================
ROM:77DF
ROM:77DF
ROM:77DF	     sub_77DF:
ROM:77DF C9 41					     CMP     #41h ; 'A'
ROM:77E1 90 04					     BCC     loc_77E7
ROM:77E3 49 7F					     EOR     #7Fh ; ''
ROM:77E5 69 00					     ADC     #0
ROM:77E7
ROM:77E7	     loc_77E7:
ROM:77E7 AA					     TAX
ROM:77E8 BD B9 57				     LDA     (DVGROM+7B9h),X	     ; sine table
ROM:77EB 60					     RTS
ROM:77EB	     ; End of function sub_77DF
ROM:77EB
ROM:77EB	     ; ---------------------------------------------------------------------------
ROM:77EC 00					     .db    0
ROM:77ED 00					     .db    0
ROM:77EE 00					     .db    0
ROM:77EF 00					     .db    0
ROM:77F0 00					     .db    0
ROM:77F1 00					     .db    0
ROM:77F2 00					     .db    0
ROM:77F3 00					     .db    0
ROM:77F4 00					     .db    0
ROM:77F5 00					     .db    0
ROM:77F6	     ; Y=message number
ROM:77F6	     ; 0=English, 1=German, 2=French, 3=Spanish
ROM:77F6
ROM:77F6
ROM:77F6	     ; =============== S U B R O U T I N E =======================================
ROM:77F6
ROM:77F6
ROM:77F6	     PrintPackedMsg:
ROM:77F6 AD 03 28				     LDA     language
ROM:77F9 29 03					     AND     #3			     ; mask off	invalid	bits
ROM:77FB 0A					     ASL     A			     ; convert to word offset
ROM:77FC AA					     TAX
ROM:77FD A9 10					     LDA     #10h
ROM:77FF 85 00					     STA     globalScale
ROM:7801 BD 88 78				     LDA     (msgTablePtrs+1),X
ROM:7804 85 09					     STA     byte_9
ROM:7806 BD 87 78				     LDA     msgTablePtrs,X
ROM:7809 85 08					     STA     byte_8		     ; for this	language
ROM:780B 71 08					     ADC     (8),Y		     ; add message number
ROM:780D 85 08					     STA     byte_8		     ; update offset
ROM:780F 90 02					     BCC     loc_7813		     ; no overflow, skip
ROM:7811 E6 09					     INC     byte_9		     ; adjust high byte
ROM:7813
ROM:7813	     loc_7813:							     ; message number
ROM:7813 98					     TYA
ROM:7814 0A					     ASL     A			     ; convert to word offset
ROM:7815 A8					     TAY
ROM:7816 B9 71 78				     LDA     msgCoords,Y	     ; X
ROM:7819 BE 72 78				     LDX     (msgCoords+1),Y	     ; Y
ROM:781C 20 03 7C				     JSR     write_CURx4_cmd
ROM:781F A9 70					     LDA     #70h ; 'p'
ROM:7821 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:7824 A0 00					     LDY     #0
ROM:7826 A2 00					     LDX     #0
ROM:7828
ROM:7828	     loc_7828:							     ; get message byte
ROM:7828 A1 08					     LDA     (8,X)
ROM:782A 85 0B					     STA     byte_B		     ; temp store
ROM:782C 4A					     LSR     A			     ; X,7-1
ROM:782D 4A					     LSR     A			     ; XX,7-2 (XX76543X)
ROM:782E 20 4D 78				     JSR     inc_msg_ptr_add_chr_fn
ROM:7831 A1 08					     LDA     (8,X)		     ; get next	message	byte
ROM:7833 2A					     ROL     A			     ; 7->C
ROM:7834 26 0B					     ROL     byte_B		     ; 6-0,7
ROM:7836 2A					     ROL     A			     ; 6->C
ROM:7837 A5 0B					     LDA     byte_B		     ; 6-0,7
ROM:7839 2A					     ROL     A			     ; 5-0,7,6
ROM:783A 0A					     ASL     A			     ; 4-0,7,6,5 (XX21076X)
ROM:783B 20 53 78				     JSR     add_chr_fn
ROM:783E A1 08					     LDA     (8,X)		     ; get same	message	byte again
ROM:7840 85 0B					     STA     byte_B		     ; temp store (XX54321X)
ROM:7842 20 4D 78				     JSR     inc_msg_ptr_add_chr_fn
ROM:7845 46 0B					     LSR     byte_B		     ; end of message?
ROM:7847 90 DF					     BCC     loc_7828		     ; no, loop
ROM:7849
ROM:7849	     loc_7849:
ROM:7849 88					     DEY
ROM:784A 4C 39 7C				     JMP     update_avg_curr_addr
ROM:784A	     ; End of function PrintPackedMsg
ROM:784A
ROM:784D
ROM:784D	     ; =============== S U B R O U T I N E =======================================
ROM:784D
ROM:784D
ROM:784D	     inc_msg_ptr_add_chr_fn:
ROM:784D E6 08					     INC     byte_8		     ; inc msg ptr
ROM:784F D0 02					     BNE     add_chr_fn		     ; no overflow, skip
ROM:7851 E6 09					     INC     byte_9		     ; inc msg ptr msb
ROM:7851	     ; End of function inc_msg_ptr_add_chr_fn
ROM:7851
ROM:7853
ROM:7853	     ; =============== S U B R O U T I N E =======================================
ROM:7853
ROM:7853
ROM:7853	     add_chr_fn:
ROM:7853 29 3E					     AND     #3Eh ; '>'              ; get character (bits 5-1)
ROM:7855 D0 04					     BNE     loc_785B		     ; if not space, skip
ROM:7857 68					     PLA
ROM:7858 68					     PLA			     ; pop return address
ROM:7859 D0 EE					     BNE     loc_7849		     ; return, finishing byte pair (3 chars)
ROM:785B
ROM:785B	     loc_785B:							     ; numeric?
ROM:785B C9 0A					     CMP     #0Ah
ROM:785D 90 02					     BCC     loc_7861		     ; yes, skip
ROM:785F 69 0D					     ADC     #0Dh
ROM:7861
ROM:7861	     loc_7861:							     ; X = chr*2 (chr fn offset)
ROM:7861 AA					     TAX
ROM:7862 BD D2 56				     LDA     (DVGROM+6D2h),X	     ; chr fn msb
ROM:7865 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7867 C8					     INY
ROM:7868 BD D3 56				     LDA     (DVGROM+6D3h),X	     ; chr fn lsb
ROM:786B 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:786D C8					     INY
ROM:786E A2 00					     LDX     #0
ROM:7870 60					     RTS
ROM:7870	     ; End of function add_chr_fn
ROM:7870
ROM:7870	     ; ---------------------------------------------------------------------------
ROM:7871 64 B6	     msgCoords:			     .db 64h, 0B6h		     ; "HIGH SCORES"
ROM:7873 64 B6					     .db 64h, 0B6h		     ; "PLAYER"
ROM:7875 0C AA					     .db 0Ch, 0AAh		     ; "YOUR SCORE...TEN BEST"
ROM:7877 0C A2					     .db 0Ch, 0A2h		     ; "PLEASE...INITIALS"
ROM:7879 0C 9A					     .db 0Ch, 9Ah		     ; "PUSH ROTATE...LETTER"
ROM:787B 0C 92					     .db 0Ch, 92h		     ; "PUSH HYPERSPACE...CORRECT"
ROM:787D 64 C6					     .db 64h, 0C6h		     ; "PUSH START"
ROM:787F 64 9D					     .db 64h, 9Dh		     ; "GAME OVER"
ROM:7881 50 39					     .db 50h, 39h		     ; "1 COIN 2 PLAYS"
ROM:7883 50 39					     .db 50h, 39h		     ; "1 COIN 1 PLAY"
ROM:7885 50 39					     .db 50h, 39h		     ; "2 COINS 1 PLAY"
ROM:7887	     ; Offset into Vector ROM for message tables
ROM:7887 1E 57	     msgTablePtrs:		     .dw 571Eh			     ; English
ROM:7889 8F 78					     .dw 788Fh			     ; German
ROM:788B 46 79					     .dw 7946h			     ; French
ROM:788D F3 79					     .dw 79F3h			     ; Spanish
ROM:788F	     ; German
ROM:788F	     ; - offsets
ROM:788F 0B 15 1B 35+				     .db 0Bh, 15h, 1Bh,	35h, 4Dh, 65h, 7Fh, 8Dh, 93h, 9Fh, 0ABh
ROM:789A	     ; - messages
ROM:789A 64 D2 3B 2E+				     .db 64h, 0D2h, 3Bh, 2Eh, 0C2h, 6Ch, 5Ah, 4Ch, 93h,	6Fh, 0BDh, 1Ah,	4Ch, 12h, 0B0h,	40h, 6Bh, 2Ch, 0Ah
ROM:789A C2 6C 5A 4C+				     .db 6Ch, 5Ah, 4Ch,	93h, 6Eh, 0Bh, 6Eh, 0C0h, 52h, 6Ch, 92h, 0B8h, 50h, 4Dh, 82h, 0F2h, 58h, 90h, 4Ch
ROM:789A 93 6F BD 1A+				     .db 4Dh, 0F0h, 4Ch, 80h, 33h, 70h,	0C2h, 42h, 5Ah,	4Ch, 4Ch, 82h, 0BBh, 52h, 0Bh, 58h, 0B2h, 42h, 6Ch
ROM:789A 4C 12 B0 40+				     .db 9Ah, 0C3h, 4Ah, 82h, 64h, 0Ah,	5Ah, 90h, 0, 0F6h, 6Ch,	9, 0B2h, 3Bh, 2Eh, 0C1h, 4Ch, 4Ch, 0B6h, 2Bh
ROM:789A 6B 2C 0A 6C+				     .db 20h, 0Dh, 0A6h, 0C1h, 70h, 48h, 50h, 0B6h, 52h, 3Bh, 0D2h, 90h, 0, 0DAh, 64h, 90h, 4Ch, 0C9h, 0D8h
ROM:789A 5A 4C 93 6E+				     .db 0BEh, 0Ah, 32h, 42h, 9Bh, 0C2h, 67h, 68h, 4Dh,	0AEh, 0A1h, 4Eh, 48h, 50h, 0B6h, 52h, 3Bh, 0D2h, 90h
ROM:789A 0B 6E C0 52+				     .db 0, 0BEh, 0Ah, 0B6h, 1Eh, 94h, 0D2h, 0A2h, 92h,	0Ah, 2Ch, 0CAh,	4Eh, 7Ah, 65h, 0BDh, 1Ah, 4Ch, 12h
ROM:789A 6C 92 B8 50+				     .db 92h, 13h, 18h,	62h, 0CAh, 64h,	0F2h, 42h, 20h,	6Eh, 0A3h, 52h,	82h, 40h, 18h, 62h, 0CAh, 64h, 0F2h
ROM:789A 4D 82 F2 58+				     .db 42h, 18h, 6Eh,	0A3h, 52h, 80h,	0, 20h,	62h, 0CAh, 64h,	0F2h, 64h, 8, 0C2h, 0BDh, 1Ah, 4Ch, 0
ROM:7946	     ; French
ROM:7946	     ; - offsets
ROM:7946 0B 15 19 31+				     .db 0Bh, 15h, 19h,	31h, 41h, 57h, 73h, 7Fh, 89h, 95h, 0A1h
ROM:7951	     ; - messages
ROM:7951 8A 5A 84 12+				     .db 8Ah, 5Ah, 84h,	12h, 0CDh, 82h,	0B9h, 0E6h, 0B2h, 40h, 74h, 0F2h, 4Dh, 83h, 0D4h, 0F0h,	0B2h, 42h
ROM:7951 CD 82 B9 E6+				     .db 0B9h, 0E6h, 0B2h, 42h,	4Dh, 0F0h, 0Eh,	64h, 0Ah, 12h, 0B8h, 46h, 10h, 62h, 4Bh, 60h, 82h, 72h,	0B5h
ROM:7951 B2 40 74 F2+				     .db 0C0h, 0BEh, 0A8h, 0Ah,	64h, 0C5h, 92h,	0F0h, 74h, 9Dh,	0C2h, 6Ch, 9Ah,	0C3h, 4Ah, 82h,	6Fh, 0A4h
ROM:7951 4D 83 D4 F0+				     .db 0F2h, 0BDh, 0D2h, 0F0h, 6Ch, 9Eh, 0Ah,	0C2h, 42h, 0A4h, 0F2h, 0B0h, 74h, 9Dh, 0C2h, 6Ch, 9Ah, 0C3h
ROM:7951 B2 42 B9 E6+				     .db 4Ah, 82h, 6Fh,	0A4h, 0F2h, 0BDh, 0D2h,	0F0h, 58h, 0EDh, 12h, 0B5h, 0E8h, 29h, 0D2h, 0Dh, 72h, 2Ch
ROM:7951 B2 42 4D F0+				     .db 90h, 0Ch, 12h,	0C6h, 2Ch, 48h,	4Eh, 9Dh, 0ACh,	49h, 0F0h, 48h,	0, 2Dh,	28h, 0CFh, 52h,	0B0h, 6Eh
ROM:7951 0E 64 0A 12+				     .db 0CDh, 82h, 0BEh, 0Ah, 0B6h, 0,	53h, 64h, 0Ah, 12h, 0Dh, 0Ah, 0B6h, 1Ah, 48h, 0, 18h, 68h, 6Ah,	4Eh
ROM:7951 B8 46 10 62+				     .db 48h, 48h, 0Bh,	0A6h, 0CAh, 72h, 0B5h, 0C0h, 18h, 68h, 6Ah, 4Eh, 48h, 46h, 0Bh,	0A6h, 0CAh, 72h, 0B0h
ROM:7951 4B 60 82 72+				     .db 0, 20h, 68h, 6Ah, 4Eh,	4Dh, 0C2h, 18h,	5Ch, 9Eh, 52h, 0CDh, 80h
ROM:79F3	     ; Spanish
ROM:79F3	     ; - offsets
ROM:79F3 0B 11 17 31+				     .db 0Bh, 11h, 17h,	31h, 45h, 5Fh, 6Bh, 73h, 7Dh, 89h, 93h
ROM:79FE	     ; - messages
ROM:79FE B2 4E 9D 90+				     .db 0B2h, 4Eh, 9Dh, 90h, 0B8h, 0, 76h, 56h, 2Ah, 26h, 0B0h, 40h, 0BEh, 42h, 0A6h, 64h, 0C1h, 5Ch, 48h
ROM:79FE B8 00 76 56+				     .db 52h, 0BEh, 0Ah, 0Ah, 64h, 0C5h, 92h, 0Ch, 26h,	0B8h, 50h, 6Ah,	7Ch, 0Ch, 52h, 74h, 0ECh, 4Dh, 0C0h
ROM:79FE 2A 26 B0 40+				     .db 0A4h, 0ECh, 0Ah, 8Ah, 0D4h, 0ECh, 0Ah,	64h, 0C5h, 92h,	0Dh, 0F2h, 0B8h, 5Ah, 93h, 4Eh,	69h, 60h
ROM:79FE BE 42 A6 64+				     .db 4Dh, 0C0h, 9Dh, 2Ch, 6Ch, 4Ah,	0Dh, 0A6h, 0C1h, 70h, 48h, 68h,	2Dh, 8Ah, 0Dh, 0D2h, 82h, 4Eh, 3Bh
ROM:79FE C1 5C 48 52+				     .db 66h, 91h, 6Ch,	0Ch, 0Ah, 0Ch, 12h, 0C5h, 8Bh, 9Dh, 2Ch, 6Ch, 4Ah, 0Bh,	3Ah, 0A2h, 6Ch,	0BDh, 0Ah
ROM:79FE BE 0A 0A 64+				     .db 3Ah, 40h, 0A6h, 60h, 0B9h, 6Ch, 0Dh, 0F0h, 2Dh, 0B1h, 76h, 52h, 5Ch, 0C2h, 0C2h, 6Ch, 8Bh, 64h, 2Ah
ROM:79FE C5 92 0C 26+				     .db 27h, 18h, 54h,	69h, 0D8h, 28h,	48h, 0Bh, 0B2h,	4Ah, 0E6h, 0B8h, 0, 18h, 54h, 69h, 0D8h, 28h, 46h
ROM:79FE B8 50 6A 7C+				     .db 0Bh, 0B2h, 4Ah, 0E7h, 20h, 54h, 69h, 0D8h, 2Dh, 0C2h, 18h, 5Ch, 0CAh, 56h, 98h, 0, 52h
ROM:7A93
ROM:7A93	     ; =============== S U B R O U T I N E =======================================
ROM:7A93
ROM:7A93
ROM:7A93	     handle_coin_switches:
ROM:7A93 A2 02					     LDX     #2
ROM:7A95
ROM:7A95	     loc_7A95:							     ; read coinswitch
ROM:7A95 BD 00 24				     LDA     leftCoinSwitch,X
ROM:7A98 0A					     ASL     A
ROM:7A99 B5 7A					     LDA     coin_1_inp_length,X
ROM:7A9B 29 1F					     AND     #1Fh
ROM:7A9D 90 37					     BCC     loc_7AD6
ROM:7A9F F0 10					     BEQ     loc_7AB1
ROM:7AA1 C9 1B					     CMP     #1Bh
ROM:7AA3 B0 0A					     BCS     loc_7AAF
ROM:7AA5 A8					     TAY
ROM:7AA6 A5 5E					     LDA     NMI_count
ROM:7AA8 29 07					     AND     #7
ROM:7AAA C9 07					     CMP     #7
ROM:7AAC 98					     TYA
ROM:7AAD 90 02					     BCC     loc_7AB1
ROM:7AAF
ROM:7AAF	     loc_7AAF:
ROM:7AAF E9 01					     SBC     #1
ROM:7AB1
ROM:7AB1	     loc_7AB1:
ROM:7AB1 95 7A					     STA     coin_1_inp_length,X
ROM:7AB3 AD 06 20				     LDA     slamSwitch
ROM:7AB6 29 80					     AND     #80h ; 'Ä'
ROM:7AB8 F0 04					     BEQ     loc_7ABE
ROM:7ABA A9 F0					     LDA     #0F0h ; ''
ROM:7ABC 85 72					     STA     slamSwitchFlag
ROM:7ABE
ROM:7ABE	     loc_7ABE:
ROM:7ABE A5 72					     LDA     slamSwitchFlag
ROM:7AC0 F0 08					     BEQ     loc_7ACA
ROM:7AC2 C6 72					     DEC     slamSwitchFlag
ROM:7AC4 A9 00					     LDA     #0
ROM:7AC6 95 7A					     STA     coin_1_inp_length,X
ROM:7AC8 95 77					     STA     unk_77,X
ROM:7ACA
ROM:7ACA	     loc_7ACA:
ROM:7ACA 18					     CLC
ROM:7ACB B5 77					     LDA     unk_77,X
ROM:7ACD F0 23					     BEQ     loc_7AF2
ROM:7ACF D6 77					     DEC     unk_77,X
ROM:7AD1 D0 1F					     BNE     loc_7AF2
ROM:7AD3 38					     SEC
ROM:7AD4 B0 1C					     BCS     loc_7AF2
ROM:7AD6
ROM:7AD6	     loc_7AD6:
ROM:7AD6 C9 1B					     CMP     #1Bh
ROM:7AD8 B0 09					     BCS     loc_7AE3
ROM:7ADA B5 7A					     LDA     coin_1_inp_length,X
ROM:7ADC 69 20					     ADC     #20h ; ' '
ROM:7ADE 90 D1					     BCC     loc_7AB1
ROM:7AE0 F0 01					     BEQ     loc_7AE3
ROM:7AE2 18					     CLC
ROM:7AE3
ROM:7AE3	     loc_7AE3:
ROM:7AE3 A9 1F					     LDA     #1Fh
ROM:7AE5 B0 CA					     BCS     loc_7AB1
ROM:7AE7 95 7A					     STA     coin_1_inp_length,X
ROM:7AE9 B5 77					     LDA     unk_77,X
ROM:7AEB F0 01					     BEQ     loc_7AEE
ROM:7AED 38					     SEC
ROM:7AEE
ROM:7AEE	     loc_7AEE:
ROM:7AEE A9 78					     LDA     #78h ; 'x'
ROM:7AF0 95 77					     STA     unk_77,X
ROM:7AF2
ROM:7AF2	     loc_7AF2:
ROM:7AF2 90 23					     BCC     loc_7B17
ROM:7AF4 A9 00					     LDA     #0
ROM:7AF6 E0 01					     CPX     #1
ROM:7AF8 90 16					     BCC     loc_7B10
ROM:7AFA F0 0C					     BEQ     loc_7B08
ROM:7AFC A5 71					     LDA     coinMultCredits
ROM:7AFE 29 0C					     AND     #0Ch
ROM:7B00 4A					     LSR     A
ROM:7B01 4A					     LSR     A
ROM:7B02 F0 0C					     BEQ     loc_7B10
ROM:7B04 69 02					     ADC     #2
ROM:7B06 D0 08					     BNE     loc_7B10
ROM:7B08
ROM:7B08	     loc_7B08:
ROM:7B08 A5 71					     LDA     coinMultCredits
ROM:7B0A 29 10					     AND     #10h
ROM:7B0C F0 02					     BEQ     loc_7B10
ROM:7B0E A9 01					     LDA     #1
ROM:7B10
ROM:7B10	     loc_7B10:
ROM:7B10 38					     SEC
ROM:7B11 65 73					     ADC     totalCoinsForCredits
ROM:7B13 85 73					     STA     totalCoinsForCredits
ROM:7B15 F6 74					     INC     byte_74,X
ROM:7B17
ROM:7B17	     loc_7B17:
ROM:7B17 CA					     DEX
ROM:7B18 30 03					     BMI     loc_7B1D
ROM:7B1A 4C 95 7A				     JMP     loc_7A95		     ; next coin switch
ROM:7B1D	     ; ---------------------------------------------------------------------------
ROM:7B1D
ROM:7B1D	     loc_7B1D:
ROM:7B1D A5 71					     LDA     coinMultCredits
ROM:7B1F 29 03					     AND     #3
ROM:7B21 A8					     TAY
ROM:7B22 F0 12					     BEQ     loc_7B36
ROM:7B24 4A					     LSR     A
ROM:7B25 69 00					     ADC     #0
ROM:7B27 49 FF					     EOR     #0FFh
ROM:7B29 38					     SEC
ROM:7B2A 65 73					     ADC     totalCoinsForCredits
ROM:7B2C 90 0A					     BCC     loc_7B38
ROM:7B2E C0 02					     CPY     #2
ROM:7B30 B0 02					     BCS     loc_7B34
ROM:7B32 E6 70					     INC     CurrNumCredits
ROM:7B34
ROM:7B34	     loc_7B34:
ROM:7B34 E6 70					     INC     CurrNumCredits
ROM:7B36
ROM:7B36	     loc_7B36:
ROM:7B36 85 73					     STA     totalCoinsForCredits
ROM:7B38
ROM:7B38	     loc_7B38:
ROM:7B38 A5 5E					     LDA     NMI_count
ROM:7B3A 4A					     LSR     A
ROM:7B3B B0 27					     BCS     locret_7B64
ROM:7B3D A0 00					     LDY     #0
ROM:7B3F A2 02					     LDX     #2
ROM:7B41
ROM:7B41	     loc_7B41:
ROM:7B41 B5 74					     LDA     byte_74,X
ROM:7B43 F0 09					     BEQ     loc_7B4E
ROM:7B45 C9 10					     CMP     #10h
ROM:7B47 90 05					     BCC     loc_7B4E
ROM:7B49 69 EF					     ADC     #0EFh ; 'Ô'
ROM:7B4B C8					     INY
ROM:7B4C 95 74					     STA     byte_74,X
ROM:7B4E
ROM:7B4E	     loc_7B4E:
ROM:7B4E CA					     DEX
ROM:7B4F 10 F0					     BPL     loc_7B41
ROM:7B51 98					     TYA
ROM:7B52 D0 10					     BNE     locret_7B64
ROM:7B54 A2 02					     LDX     #2
ROM:7B56
ROM:7B56	     loc_7B56:
ROM:7B56 B5 74					     LDA     byte_74,X
ROM:7B58 F0 07					     BEQ     loc_7B61
ROM:7B5A 18					     CLC
ROM:7B5B 69 EF					     ADC     #0EFh ; 'Ô'
ROM:7B5D 95 74					     STA     byte_74,X
ROM:7B5F 30 03					     BMI     locret_7B64
ROM:7B61
ROM:7B61	     loc_7B61:
ROM:7B61 CA					     DEX
ROM:7B62 10 F2					     BPL     loc_7B56
ROM:7B64
ROM:7B64	     locret_7B64:
ROM:7B64 60					     RTS
ROM:7B64	     ; End of function handle_coin_switches
ROM:7B64
ROM:7B65	     ; ---------------------------------------------------------------------------
ROM:7B65	     ; NMI: 250Hz interrupt
ROM:7B65
ROM:7B65	     NMI:
ROM:7B65 48					     PHA
ROM:7B66 98					     TYA
ROM:7B67 48					     PHA
ROM:7B68 8A					     TXA
ROM:7B69 48					     PHA
ROM:7B6A D8					     CLD
ROM:7B6B AD FF 01				     LDA     stack+0FFh
ROM:7B6E 0D D0 01				     ORA     stack+0D0h		     ; check stack guard bytes
ROM:7B71
ROM:7B71	     loc_7B71:							     ; stack overflow -	loop
ROM:7B71 D0 FE					     BNE     loc_7B71
ROM:7B73 E6 5E					     INC     NMI_count
ROM:7B75 A5 5E					     LDA     NMI_count
ROM:7B77 29 03					     AND     #3			     ; every 4th NMI - 62.5Hz (roughly VBLANK)
ROM:7B79 D0 08					     BNE     loc_7B83		     ; no, skip
ROM:7B7B E6 5B					     INC     VBLANK_triggered
ROM:7B7D A5 5B					     LDA     VBLANK_triggered
ROM:7B7F C9 04					     CMP     #4			     ; reached 4?
ROM:7B81
ROM:7B81	     loc_7B81:							     ; yes, spin (hang)
ROM:7B81 B0 FE					     BCS     loc_7B81
ROM:7B83
ROM:7B83	     loc_7B83:
ROM:7B83 20 93 7A				     JSR     handle_coin_switches
ROM:7B86 A5 6F					     LDA     io3200ShadowRegister
ROM:7B88 29 C7					     AND     #0C7h ; '«'
ROM:7B8A 24 74					     BIT     byte_74
ROM:7B8C 10 02					     BPL     loc_7B90
ROM:7B8E 09 08					     ORA     #8			     ; left coin counter
ROM:7B90
ROM:7B90	     loc_7B90:
ROM:7B90 24 75					     BIT     byte_75
ROM:7B92 10 02					     BPL     loc_7B96
ROM:7B94 09 10					     ORA     #10h		     ; centre coin counter
ROM:7B96
ROM:7B96	     loc_7B96:
ROM:7B96 24 76					     BIT     byte_76
ROM:7B98 10 02					     BPL     loc_7B9C
ROM:7B9A 09 20					     ORA     #20h ; ' '              ; right coin counter
ROM:7B9C
ROM:7B9C	     loc_7B9C:
ROM:7B9C 85 6F					     STA     io3200ShadowRegister
ROM:7B9E 8D 00 32				     STA     3200h		     ; output
ROM:7BA1 A5 72					     LDA     slamSwitchFlag
ROM:7BA3 F0 04					     BEQ     loc_7BA9
ROM:7BA5 A9 80					     LDA     #80h ; 'Ä'
ROM:7BA7 D0 0E					     BNE     loc_7BB7
ROM:7BA9
ROM:7BA9	     loc_7BA9:
ROM:7BA9 A5 68					     LDA     timerBonusShipSound
ROM:7BAB F0 0A					     BEQ     loc_7BB7
ROM:7BAD A5 5C					     LDA     fastTimer
ROM:7BAF 6A					     ROR     A
ROM:7BB0 90 02					     BCC     loc_7BB4
ROM:7BB2 C6 68					     DEC     timerBonusShipSound
ROM:7BB4
ROM:7BB4	     loc_7BB4:
ROM:7BB4 6A					     ROR     A
ROM:7BB5 6A					     ROR     A
ROM:7BB6 6A					     ROR     A
ROM:7BB7
ROM:7BB7	     loc_7BB7:							     ; sound (bonus life)
ROM:7BB7 8D 05 3C				     STA     3C05h
ROM:7BBA 68					     PLA
ROM:7BBB AA					     TAX
ROM:7BBC 68					     PLA
ROM:7BBD A8					     TAY
ROM:7BBE 68					     PLA
ROM:7BBF 40					     RTI
ROM:7BC0
ROM:7BC0	     ; =============== S U B R O U T I N E =======================================
ROM:7BC0
ROM:7BC0
ROM:7BC0	     halt_dvg:
ROM:7BC0 A9 B0					     LDA     #0B0h ; '∞'
ROM:7BC2 A0 00					     LDY     #0
ROM:7BC4 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7BC6 C8					     INY
ROM:7BC7 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7BC9 D0 6E					     BNE     update_avg_curr_addr
ROM:7BCB
ROM:7BCB	     loc_7BCB:
ROM:7BCB 90 04					     BCC     display_digit_A
ROM:7BCD 29 0F					     AND     #0Fh		     ; numeric only
ROM:7BCF F0 05					     BEQ     loc_7BD6		     ; space, skip
ROM:7BCF	     ; End of function halt_dvg
ROM:7BCF
ROM:7BD1	     A = character
ROM:7BD1
ROM:7BD1	     ; =============== S U B R O U T I N E =======================================
ROM:7BD1
ROM:7BD1
ROM:7BD1	     display_digit_A:
ROM:7BD1 29 0F					     AND     #0Fh		     ; numeric only
ROM:7BD3 18					     CLC
ROM:7BD4 69 01					     ADC     #1			     ; convert to char code
ROM:7BD6
ROM:7BD6	     loc_7BD6:
ROM:7BD6 08					     PHP
ROM:7BD7 0A					     ASL     A			     ; x2 (word	offset)
ROM:7BD8 A0 00					     LDY     #0
ROM:7BDA AA					     TAX
ROM:7BDB BD D4 56				     LDA     (DVGROM+6D4h),X	     ; chr fn msb
ROM:7BDE 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7BE0 BD D5 56				     LDA     (DVGROM+6D5h),X	     ; chr fn lsb
ROM:7BE3 C8					     INY
ROM:7BE4 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7BE6 20 39 7C				     JSR     update_avg_curr_addr
ROM:7BE9 28					     PLP
ROM:7BEA 60					     RTS
ROM:7BEA	     ; End of function display_digit_A
ROM:7BEA
ROM:7BEB	     ; ---------------------------------------------------------------------------
ROM:7BEB 4A					     LSR     A			     ; adjust address
ROM:7BEC 29 0F					     AND     #0Fh		     ; clear cmd nibble
ROM:7BEE 09 E0					     ORA     #0E0h ; '‡'             ; JMP command
ROM:7BF0	     ; START OF	FUNCTION CHUNK FOR write_JSR_cmd
ROM:7BF0
ROM:7BF0	     write_JMP_JSR_cmd:
ROM:7BF0 A0 01					     LDY     #1
ROM:7BF2 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7BF4 88					     DEY
ROM:7BF5 8A					     TXA
ROM:7BF6 6A					     ROR     A			     ; adjust address
ROM:7BF7 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7BF9 C8					     INY
ROM:7BFA D0 3D					     BNE     update_avg_curr_addr
ROM:7BFA	     ; END OF FUNCTION CHUNK FOR write_JSR_cmd
ROM:7BFC	     ; A:X = address
ROM:7BFC
ROM:7BFC	     ; =============== S U B R O U T I N E =======================================
ROM:7BFC
ROM:7BFC
ROM:7BFC	     write_JSR_cmd:
ROM:7BFC
ROM:7BFC	     ; FUNCTION	CHUNK AT ROM:7BF0 SIZE 0000000C	BYTES
ROM:7BFC
ROM:7BFC 4A					     LSR     A			     ; adjust address
ROM:7BFD 29 0F					     AND     #0Fh		     ; clear cmd nibble
ROM:7BFF 09 C0					     ORA     #0C0h ; '¿'             ; JSR command
ROM:7C01 D0 ED					     BNE     write_JMP_JSR_cmd
ROM:7C01	     ; End of function write_JSR_cmd
ROM:7C01
ROM:7C03	     ; A=X coord, X=Y coord
ROM:7C03
ROM:7C03	     ; =============== S U B R O U T I N E =======================================
ROM:7C03
ROM:7C03
ROM:7C03	     write_CURx4_cmd:
ROM:7C03 A0 00					     LDY     #0
ROM:7C05 84 05					     STY     byte_5
ROM:7C07 84 07					     STY     byte_7
ROM:7C09 0A					     ASL     A
ROM:7C0A 26 05					     ROL     byte_5
ROM:7C0C 0A					     ASL     A
ROM:7C0D 26 05					     ROL     byte_5		     ; X*4 (msb)
ROM:7C0F 85 04					     STA     byte_4		     ; X*4 (lsb)
ROM:7C11 8A					     TXA
ROM:7C12 0A					     ASL     A
ROM:7C13 26 07					     ROL     byte_7
ROM:7C15 0A					     ASL     A
ROM:7C16 26 07					     ROL     byte_7		     ; Y*4 (msb)
ROM:7C18 85 06					     STA     byte_6		     ; Y*4 (lsb)
ROM:7C1A A2 04					     LDX     #4
ROM:7C1A	     ; End of function write_CURx4_cmd
ROM:7C1A
ROM:7C1C
ROM:7C1C	     ; =============== S U B R O U T I N E =======================================
ROM:7C1C
ROM:7C1C
ROM:7C1C	     write_CUR_cmd:
ROM:7C1C B5 02					     LDA     2,X		     ; @$6 = Y*4 (lsb)
ROM:7C1E A0 00					     LDY     #0
ROM:7C20 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7C22 B5 03					     LDA     3,X		     ; @$7 = Y*4 (msb)
ROM:7C24 29 0F					     AND     #0Fh		     ; clear command nibble
ROM:7C26 09 A0					     ORA     #0A0h ; '†'             ; CUR command
ROM:7C28 C8					     INY
ROM:7C29 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7C2B B5 00					     LDA     0,X		     ; @$4 = X*4 (lsb)
ROM:7C2D C8					     INY
ROM:7C2E 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7C30 B5 01					     LDA     1,X		     ; @$5 = X*4 (msb)
ROM:7C32 29 0F					     AND     #0Fh		     ; clear scale nibble
ROM:7C34 05 00					     ORA     globalScale	     ; global scale
ROM:7C36 C8					     INY
ROM:7C37 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7C37	     ; End of function write_CUR_cmd
ROM:7C37
ROM:7C39
ROM:7C39	     ; =============== S U B R O U T I N E =======================================
ROM:7C39
ROM:7C39
ROM:7C39	     update_avg_curr_addr:
ROM:7C39 98					     TYA			     ; #bytes this operation
ROM:7C3A 38					     SEC
ROM:7C3B 65 02					     ADC     dvg_curr_addr_lsb
ROM:7C3D 85 02					     STA     dvg_curr_addr_lsb
ROM:7C3F 90 02					     BCC     locret_7C43	     ; no overflow, skip
ROM:7C41 E6 03					     INC     dvg_curr_addr_msb
ROM:7C43
ROM:7C43	     locret_7C43:
ROM:7C43 60					     RTS
ROM:7C43	     ; End of function update_avg_curr_addr
ROM:7C43
ROM:7C43	     ; ---------------------------------------------------------------------------
ROM:7C44 A9					     .db 0A9h ;	©
ROM:7C45 D0					     .db 0D0h ;	–
ROM:7C46 4C					     .db  4Ch ;	L
ROM:7C47 C2					     .db 0C2h ;	¬
ROM:7C48 7B					     .db  7Bh ;	{
ROM:7C49
ROM:7C49	     ; =============== S U B R O U T I N E =======================================
ROM:7C49
ROM:7C49
ROM:7C49	     sub_7C49:
ROM:7C49 A5 05					     LDA     byte_5
ROM:7C4B C9 80					     CMP     #80h ; 'Ä'
ROM:7C4D 90 11					     BCC     loc_7C60
ROM:7C4F 49 FF					     EOR     #0FFh
ROM:7C51 85 05					     STA     byte_5
ROM:7C53 A5 04					     LDA     byte_4
ROM:7C55 49 FF					     EOR     #0FFh
ROM:7C57 69 00					     ADC     #0
ROM:7C59 85 04					     STA     byte_4
ROM:7C5B 90 02					     BCC     loc_7C5F
ROM:7C5D E6 05					     INC     byte_5
ROM:7C5F
ROM:7C5F	     loc_7C5F:
ROM:7C5F 38					     SEC
ROM:7C60
ROM:7C60	     loc_7C60:
ROM:7C60 26 08					     ROL     byte_8
ROM:7C62 A5 07					     LDA     byte_7
ROM:7C64 C9 80					     CMP     #80h ; 'Ä'
ROM:7C66 90 11					     BCC     loc_7C79
ROM:7C68 49 FF					     EOR     #0FFh
ROM:7C6A 85 07					     STA     byte_7
ROM:7C6C A5 06					     LDA     byte_6
ROM:7C6E 49 FF					     EOR     #0FFh
ROM:7C70 69 00					     ADC     #0
ROM:7C72 85 06					     STA     byte_6
ROM:7C74 90 02					     BCC     loc_7C78
ROM:7C76 E6 07					     INC     byte_7
ROM:7C78
ROM:7C78	     loc_7C78:
ROM:7C78 38					     SEC
ROM:7C79
ROM:7C79	     loc_7C79:
ROM:7C79 26 08					     ROL     byte_8
ROM:7C7B A5 05					     LDA     byte_5
ROM:7C7D 05 07					     ORA     byte_7
ROM:7C7F F0 0A					     BEQ     loc_7C8B
ROM:7C81 A2 00					     LDX     #0
ROM:7C83 C9 02					     CMP     #2
ROM:7C85 B0 24					     BCS     loc_7CAB
ROM:7C87 A0 01					     LDY     #1
ROM:7C89 D0 10					     BNE     loc_7C9B
ROM:7C8B
ROM:7C8B	     loc_7C8B:
ROM:7C8B A0 02					     LDY     #2
ROM:7C8D A2 09					     LDX     #9
ROM:7C8F A5 04					     LDA     byte_4
ROM:7C91 05 06					     ORA     byte_6
ROM:7C93 F0 16					     BEQ     loc_7CAB
ROM:7C95 30 04					     BMI     loc_7C9B
ROM:7C97
ROM:7C97	     loc_7C97:
ROM:7C97 C8					     INY
ROM:7C98 0A					     ASL     A
ROM:7C99 10 FC					     BPL     loc_7C97
ROM:7C9B
ROM:7C9B	     loc_7C9B:
ROM:7C9B 98					     TYA
ROM:7C9C AA					     TAX
ROM:7C9D A5 05					     LDA     byte_5
ROM:7C9F
ROM:7C9F	     loc_7C9F:
ROM:7C9F 06 04					     ASL     byte_4
ROM:7CA1 2A					     ROL     A
ROM:7CA2 06 06					     ASL     byte_6
ROM:7CA4 26 07					     ROL     byte_7
ROM:7CA6 88					     DEY
ROM:7CA7 D0 F6					     BNE     loc_7C9F
ROM:7CA9 85 05					     STA     byte_5
ROM:7CAB
ROM:7CAB	     loc_7CAB:
ROM:7CAB 8A					     TXA
ROM:7CAC 38					     SEC
ROM:7CAD E9 0A					     SBC     #0Ah
ROM:7CAF 49 FF					     EOR     #0FFh
ROM:7CB1 0A					     ASL     A
ROM:7CB2 66 08					     ROR     byte_8
ROM:7CB4 2A					     ROL     A
ROM:7CB5 66 08					     ROR     byte_8
ROM:7CB7 2A					     ROL     A
ROM:7CB8 0A					     ASL     A
ROM:7CB9 85 08					     STA     byte_8
ROM:7CBB A0 00					     LDY     #0
ROM:7CBD A5 06					     LDA     byte_6
ROM:7CBF 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7CC1 A5 08					     LDA     byte_8
ROM:7CC3 29 F4					     AND     #0F4h ; 'Ù'
ROM:7CC5 05 07					     ORA     byte_7
ROM:7CC7 C8					     INY
ROM:7CC8 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7CCA A5 04					     LDA     byte_4
ROM:7CCC C8					     INY
ROM:7CCD 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7CCF A5 08					     LDA     byte_8
ROM:7CD1 29 02					     AND     #2
ROM:7CD3 0A					     ASL     A
ROM:7CD4 05 01					     ORA     byte_1
ROM:7CD6 05 05					     ORA     byte_5
ROM:7CD8 C8					     INY
ROM:7CD9 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7CDB 4C 39 7C				     JMP     update_avg_curr_addr
ROM:7CDB	     ; End of function sub_7C49
ROM:7CDB
ROM:7CDE
ROM:7CDE	     ; =============== S U B R O U T I N E =======================================
ROM:7CDE
ROM:7CDE
ROM:7CDE	     set_scale_A_bright_0:
ROM:7CDE A2 00					     LDX     #0			     ; Y=0
ROM:7CDE	     ; End of function set_scale_A_bright_0
ROM:7CDE
ROM:7CE0
ROM:7CE0	     ; =============== S U B R O U T I N E =======================================
ROM:7CE0
ROM:7CE0
ROM:7CE0	     set_scale_A_bright_X:
ROM:7CE0 A0 01					     LDY     #1
ROM:7CE2 91 02					     STA     (2),Y		     ; store (SSSS -mYY)=A in avg ram
ROM:7CE4 88					     DEY
ROM:7CE5 98					     TYA
ROM:7CE6 91 02					     STA     (2),Y		     ; store (YYYY YYYY)=0 in avg ram
ROM:7CE8 C8					     INY
ROM:7CE9 C8					     INY
ROM:7CEA 91 02					     STA     (2),Y		     ; store (XXXX XXXX)=0 in avg ram
ROM:7CEC C8					     INY
ROM:7CED 8A					     TXA
ROM:7CEE 91 02					     STA     (2),Y		     ; store (BBBB -mXX)=X in avg ram
ROM:7CF0 4C 39 7C				     JMP     update_avg_curr_addr
ROM:7CF0	     ; End of function set_scale_A_bright_X
ROM:7CF0
ROM:7CF3	     ; ---------------------------------------------------------------------------
ROM:7CF3
ROM:7CF3	     RESET:							     ; Set stack to...
ROM:7CF3 A2 FE					     LDX     #0FEh ; '˛'
ROM:7CF5 9A					     TXS			     ; ...1FE (leave 1FF as an underflow indicator)
ROM:7CF6 D8					     CLD			     ; Clear decimal mode
ROM:7CF7 A9 00					     LDA     #0			     ; Clearing	RAM
ROM:7CF9 AA					     TAX			     ; Offset to X
ROM:7CFA
ROM:7CFA	     loc_7CFA:							     ; Count down from 256
ROM:7CFA CA					     DEX
ROM:7CFB 9D 00 03				     STA     300h,X		     ; Clear bank 2 (0300-03FF)
ROM:7CFE 9D 00 02				     STA     200h,X		     ; Clear bank 1 (0200-02FF)
ROM:7D01 9D 00 01				     STA     100h,X		     ; Clear RAM (0100-01FF)
ROM:7D04 95 00					     STA     0,X		     ; Clear RAM (0000-00FF)
ROM:7D06 D0 F2					     BNE     loc_7CFA		     ; Do all 256 in each area
ROM:7D08 AC 07 20				     LDY     selfTest		     ; Read IN1
ROM:7D0B 30 43					     BMI     ServiceMode	     ; Upper bit set...	go handle service mode
ROM:7D0D E8					     INX			     ; X=1
ROM:7D0E 8E 00 40				     STX     DVGRAM
ROM:7D11 A9 E2					     LDA     #0E2h ; '‚'             ; JMP $0402
ROM:7D13 8D 01 40				     STA     DVGRAM+1
ROM:7D16 A9 B0					     LDA     #0B0h ; '∞'             ; HALT
ROM:7D18 8D 03 40				     STA     DVGRAM+3
ROM:7D1B 85 32					     STA     placeP1HighScore
ROM:7D1D 85 33					     STA     placeP2HighScore
ROM:7D1F A9 03					     LDA     #3
ROM:7D21 85 6F					     STA     io3200ShadowRegister
ROM:7D23 8D 00 32				     STA     3200h		     ; Turn on player 1	& 2 start lamps
ROM:7D26 2D 00 28				     AND     coinage		     ; coinage only
ROM:7D29 85 71					     STA     coinMultCredits
ROM:7D2B AD 01 28				     LDA     rightCoinMultiplier
ROM:7D2E 29 03					     AND     #3			     ; multiplier bits only
ROM:7D30 0A					     ASL     A
ROM:7D31 0A					     ASL     A			     ; -> bits 3..2
ROM:7D32 05 71					     ORA     coinMultCredits
ROM:7D34 85 71					     STA     coinMultCredits
ROM:7D36 AD 02 28				     LDA     centerCoinMultiplierAndLives
ROM:7D39 29 02					     AND     #2			     ; multiplier bit only
ROM:7D3B 0A					     ASL     A
ROM:7D3C 0A					     ASL     A
ROM:7D3D 0A					     ASL     A			     ; -> bit 4
ROM:7D3E 05 71					     ORA     coinMultCredits
ROM:7D40 85 71					     STA     coinMultCredits
ROM:7D42 4C 03 68				     JMP     START
ROM:7D45
ROM:7D45	     ; =============== S U B R O U T I N E =======================================
ROM:7D45
ROM:7D45
ROM:7D45	     write_AX_to_avgram:
ROM:7D45 A0 00					     LDY     #0
ROM:7D47 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7D49 C8					     INY
ROM:7D4A 8A					     TXA
ROM:7D4B 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7D4D 4C 39 7C				     JMP     update_avg_curr_addr
ROM:7D4D	     ; End of function write_AX_to_avgram
ROM:7D4D
ROM:7D50	     ; ---------------------------------------------------------------------------
ROM:7D50
ROM:7D50	     ServiceMode:						     ; Clear...
ROM:7D50 9D 00 40				     STA     4000h,X
ROM:7D53 9D 00 41				     STA     4100h,X		     ; ... all...
ROM:7D56 9D 00 42				     STA     4200h,X		     ; ... of...
ROM:7D59 9D 00 43				     STA     4300h,X		     ; ...
ROM:7D5C 9D 00 44				     STA     4400h,X		     ; ...
ROM:7D5F 9D 00 45				     STA     4500h,X		     ; ...
ROM:7D62 9D 00 46				     STA     4600h,X		     ; ...
ROM:7D65 9D 00 47				     STA     4700h,X		     ; ...
ROM:7D68 E8					     INX			     ; ...
ROM:7D69 D0 E5					     BNE     ServiceMode	     ; ... vector RAM
ROM:7D6B 8D 00 34				     STA     3400h		     ; Kick watchdog
ROM:7D6E A2 00					     LDX     #0
ROM:7D70
ROM:7D70	     loc_7D70:
ROM:7D70 B5 00					     LDA     0,X
ROM:7D72 D0 47					     BNE     loc_7DBB
ROM:7D74 A9 11					     LDA     #11h
ROM:7D76
ROM:7D76	     loc_7D76:
ROM:7D76 95 00					     STA     0,X
ROM:7D78 A8					     TAY
ROM:7D79 55 00					     EOR     0,X
ROM:7D7B D0 3E					     BNE     loc_7DBB
ROM:7D7D 98					     TYA
ROM:7D7E 0A					     ASL     A
ROM:7D7F 90 F5					     BCC     loc_7D76
ROM:7D81 E8					     INX
ROM:7D82 D0 EC					     BNE     loc_7D70
ROM:7D84 8D 00 34				     STA     3400h		     ; Kick watchdog
ROM:7D87 8A					     TXA
ROM:7D88 85 00					     STA     globalScale
ROM:7D8A 2A					     ROL     A
ROM:7D8B
ROM:7D8B	     loc_7D8B:
ROM:7D8B 85 01					     STA     byte_1
ROM:7D8D A0 00					     LDY     #0
ROM:7D8F
ROM:7D8F	     loc_7D8F:
ROM:7D8F A2 11					     LDX     #11h
ROM:7D91 B1 00					     LDA     (0),Y
ROM:7D93 D0 2A					     BNE     loc_7DBF
ROM:7D95
ROM:7D95	     loc_7D95:
ROM:7D95 8A					     TXA
ROM:7D96 91 00					     STA     (0),Y
ROM:7D98 51 00					     EOR     (0),Y
ROM:7D9A D0 23					     BNE     loc_7DBF
ROM:7D9C 8A					     TXA
ROM:7D9D 0A					     ASL     A
ROM:7D9E AA					     TAX
ROM:7D9F 90 F4					     BCC     loc_7D95
ROM:7DA1 C8					     INY
ROM:7DA2 D0 EB					     BNE     loc_7D8F
ROM:7DA4 8D 00 34				     STA     3400h		     ; Kick watchdog
ROM:7DA7 E6 01					     INC     byte_1
ROM:7DA9 A6 01					     LDX     byte_1
ROM:7DAB E0 04					     CPX     #4
ROM:7DAD 90 E0					     BCC     loc_7D8F
ROM:7DAF A9 40					     LDA     #40h ; '@'
ROM:7DB1 E0 40					     CPX     #40h ; '@'
ROM:7DB3 90 D6					     BCC     loc_7D8B
ROM:7DB5 E0 48					     CPX     #48h ; 'H'
ROM:7DB7 90 D6					     BCC     loc_7D8F
ROM:7DB9 B0 69					     BCS     loc_7E24
ROM:7DBB
ROM:7DBB	     loc_7DBB:
ROM:7DBB A0 00					     LDY     #0
ROM:7DBD F0 0E					     BEQ     loc_7DCD
ROM:7DBF
ROM:7DBF	     loc_7DBF:
ROM:7DBF A0 00					     LDY     #0
ROM:7DC1 A6 01					     LDX     byte_1
ROM:7DC3 E0 04					     CPX     #4
ROM:7DC5 90 06					     BCC     loc_7DCD
ROM:7DC7 C8					     INY
ROM:7DC8 E0 44					     CPX     #44h ; 'D'
ROM:7DCA 90 01					     BCC     loc_7DCD
ROM:7DCC C8					     INY
ROM:7DCD
ROM:7DCD	     loc_7DCD:
ROM:7DCD C9 10					     CMP     #10h
ROM:7DCF 2A					     ROL     A
ROM:7DD0 29 1F					     AND     #1Fh
ROM:7DD2 C9 02					     CMP     #2
ROM:7DD4 2A					     ROL     A
ROM:7DD5 29 03					     AND     #3
ROM:7DD7
ROM:7DD7	     loc_7DD7:
ROM:7DD7 88					     DEY
ROM:7DD8 30 04					     BMI     loc_7DDE
ROM:7DDA 0A					     ASL     A
ROM:7DDB 0A					     ASL     A
ROM:7DDC 90 F9					     BCC     loc_7DD7
ROM:7DDE
ROM:7DDE	     loc_7DDE:
ROM:7DDE 4A					     LSR     A
ROM:7DDF A2 14					     LDX     #14h
ROM:7DE1 90 02					     BCC     loc_7DE5
ROM:7DE3 A2 1D					     LDX     #1Dh
ROM:7DE5
ROM:7DE5	     loc_7DE5:							     ; sound (thump) on
ROM:7DE5 8E 00 3A				     STX     3A00h
ROM:7DE8 A2 00					     LDX     #0			     ; inner loop = 256
ROM:7DEA A0 08					     LDY     #8			     ; outer loop = 8
ROM:7DEC
ROM:7DEC	     thump_on_loop:
ROM:7DEC 2C 01 20				     BIT     freq3kHz
ROM:7DEF 10 FB					     BPL     thump_on_loop
ROM:7DF1
ROM:7DF1	     loc_7DF1:
ROM:7DF1 2C 01 20				     BIT     freq3kHz
ROM:7DF4 30 FB					     BMI     loc_7DF1
ROM:7DF6 CA					     DEX
ROM:7DF7 8D 00 34				     STA     3400h		     ; Kick watchdog
ROM:7DFA D0 F0					     BNE     thump_on_loop
ROM:7DFC 88					     DEY
ROM:7DFD D0 ED					     BNE     thump_on_loop
ROM:7DFF 8E 00 3A				     STX     3A00h		     ; sound (thump) off
ROM:7E02 A0 08					     LDY     #8
ROM:7E04
ROM:7E04	     thump_off_loop:
ROM:7E04 2C 01 20				     BIT     freq3kHz
ROM:7E07 10 FB					     BPL     thump_off_loop
ROM:7E09
ROM:7E09	     loc_7E09:
ROM:7E09 2C 01 20				     BIT     freq3kHz
ROM:7E0C 30 FB					     BMI     loc_7E09
ROM:7E0E CA					     DEX
ROM:7E0F 8D 00 34				     STA     3400h		     ; Kick watchdog
ROM:7E12 D0 F0					     BNE     thump_off_loop
ROM:7E14 88					     DEY
ROM:7E15 D0 ED					     BNE     thump_off_loop
ROM:7E17 AA					     TAX
ROM:7E18 D0 C4					     BNE     loc_7DDE
ROM:7E1A
ROM:7E1A	     loc_7E1A:							     ; Kick watchdog
ROM:7E1A 8D 00 34				     STA     3400h
ROM:7E1D AD 07 20				     LDA     selfTest
ROM:7E20 30 F8					     BMI     loc_7E1A		     ; wait for	switch to be released
ROM:7E22
ROM:7E22	     loc_7E22:
ROM:7E22 10 FE					     BPL     loc_7E22
ROM:7E24
ROM:7E24	     loc_7E24:
ROM:7E24 A9 00					     LDA     #0
ROM:7E26 A8					     TAY
ROM:7E27 AA					     TAX
ROM:7E28 85 08					     STA     byte_8
ROM:7E2A A9 50					     LDA     #50h ; 'P'
ROM:7E2C
ROM:7E2C	     loc_7E2C:
ROM:7E2C 85 09					     STA     byte_9
ROM:7E2E A9 04					     LDA     #4
ROM:7E30 85 0B					     STA     byte_B
ROM:7E32 A9 FF					     LDA     #0FFh
ROM:7E34
ROM:7E34	     loc_7E34:
ROM:7E34 51 08					     EOR     (8),Y
ROM:7E36 C8					     INY
ROM:7E37 D0 FB					     BNE     loc_7E34
ROM:7E39 E6 09					     INC     byte_9
ROM:7E3B C6 0B					     DEC     byte_B
ROM:7E3D D0 F5					     BNE     loc_7E34
ROM:7E3F 95 0D					     STA     0Dh,X
ROM:7E41 E8					     INX
ROM:7E42 8D 00 34				     STA     3400h		     ; Kick watchdog
ROM:7E45 A5 09					     LDA     byte_9
ROM:7E47 C9 58					     CMP     #58h ; 'X'
ROM:7E49 90 E1					     BCC     loc_7E2C
ROM:7E4B D0 02					     BNE     loc_7E4F
ROM:7E4D A9 68					     LDA     #68h ; 'h'
ROM:7E4F
ROM:7E4F	     loc_7E4F:
ROM:7E4F C9 80					     CMP     #80h ; 'Ä'
ROM:7E51 90 D9					     BCC     loc_7E2C
ROM:7E53 8D 00 03				     STA     P2RAM
ROM:7E56 A2 04					     LDX     #4			     ; RAMSEL
ROM:7E58 8E 00 32				     STX     3200h		     ; output
ROM:7E5B 86 15					     STX     byte_15
ROM:7E5D A2 00					     LDX     #0
ROM:7E5F CD 00 02				     CMP     P1RAM
ROM:7E62 F0 01					     BEQ     loc_7E65
ROM:7E64 E8					     INX
ROM:7E65
ROM:7E65	     loc_7E65:
ROM:7E65 AD 00 03				     LDA     P2RAM
ROM:7E68 C9 88					     CMP     #88h ; 'à'
ROM:7E6A F0 01					     BEQ     loc_7E6D
ROM:7E6C E8					     INX
ROM:7E6D
ROM:7E6D	     loc_7E6D:
ROM:7E6D 86 16					     STX     byte_16
ROM:7E6F A9 10					     LDA     #10h
ROM:7E71 85 00					     STA     globalScale
ROM:7E73
ROM:7E73	     loc_7E73:
ROM:7E73 A2 24					     LDX     #24h ; '$'
ROM:7E75
ROM:7E75	     loc_7E75:
ROM:7E75 AD 01 20				     LDA     freq3kHz
ROM:7E78 10 FB					     BPL     loc_7E75
ROM:7E7A
ROM:7E7A	     loc_7E7A:
ROM:7E7A AD 01 20				     LDA     freq3kHz
ROM:7E7D 30 FB					     BMI     loc_7E7A
ROM:7E7F CA					     DEX
ROM:7E80 10 F3					     BPL     loc_7E75
ROM:7E82
ROM:7E82	     loc_7E82:
ROM:7E82 2C 02 20				     BIT     halt
ROM:7E85 30 FB					     BMI     loc_7E82
ROM:7E87 8D 00 34				     STA     3400h		     ; Kick watchdog
ROM:7E8A A9 00					     LDA     #0
ROM:7E8C 85 02					     STA     dvg_curr_addr_lsb
ROM:7E8E A9 40					     LDA     #40h ; '@'
ROM:7E90 85 03					     STA     dvg_curr_addr_msb
ROM:7E92 AD 05 20				     LDA     diagStep
ROM:7E95 10 5B					     BPL     loc_7EF2
ROM:7E97 A6 15					     LDX     byte_15
ROM:7E99 AD 03 20				     LDA     hyperspaceSwitch
ROM:7E9C 10 0A					     BPL     loc_7EA8
ROM:7E9E 4D 09 00				     EOR     byte_9
ROM:7EA1 10 05					     BPL     loc_7EA8
ROM:7EA3 CA					     DEX
ROM:7EA4 F0 02					     BEQ     loc_7EA8
ROM:7EA6 86 15					     STX     byte_15
ROM:7EA8
ROM:7EA8	     loc_7EA8:
ROM:7EA8 BC BB 7E				     LDY     (loc_7EB9+2),X
ROM:7EAB A9 B0					     LDA     #0B0h ; '∞'
ROM:7EAD 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7EAF 88					     DEY
ROM:7EB0 88					     DEY
ROM:7EB1
ROM:7EB1	     loc_7EB1:
ROM:7EB1 B9 C0 7E				     LDA     unk_7EC0,Y
ROM:7EB4 91 02					     STA     (2),Y		     ; store in	avg ram
ROM:7EB6 88					     DEY
ROM:7EB7 10 F8					     BPL     loc_7EB1
ROM:7EB9
ROM:7EB9	     loc_7EB9:
ROM:7EB9 4C 9D 7F				     JMP     loc_7F9D
ROM:7EB9	     ; ---------------------------------------------------------------------------
ROM:7EBC 33					     .db  33h ;	3
ROM:7EBD 1D					     .db  1Dh
ROM:7EBE 17					     .db  17h
ROM:7EBF 0D					     .db  0Dh
ROM:7EC0 80	     unk_7EC0:			     .db  80h ;	Ä
ROM:7EC1 A0					     .db 0A0h ;	†
ROM:7EC2 00					     .db    0
ROM:7EC3 00					     .db    0
ROM:7EC4 00					     .db    0
ROM:7EC5 70					     .db  70h ;	p
ROM:7EC6 00					     .db    0
ROM:7EC7 00					     .db    0
ROM:7EC8 FF					     .db 0FFh
ROM:7EC9 92					     .db  92h ;	í
ROM:7ECA FF					     .db 0FFh
ROM:7ECB 73					     .db  73h ;	s
ROM:7ECC D0					     .db 0D0h ;	–
ROM:7ECD A1					     .db 0A1h ;	°
ROM:7ECE 30					     .db  30h ;	0
ROM:7ECF 02					     .db    2
ROM:7ED0 00					     .db    0
ROM:7ED1 70					     .db  70h ;	p
ROM:7ED2 00					     .db    0
ROM:7ED3 00					     .db    0
ROM:7ED4 7F					     .db  7Fh ;	
ROM:7ED5 FB					     .db 0FBh ;	˚
ROM:7ED6 0D					     .db  0Dh
ROM:7ED7 E0					     .db 0E0h ;	‡
ROM:7ED8 00					     .db    0
ROM:7ED9 B0					     .db 0B0h ;	∞
ROM:7EDA 7E					     .db  7Eh ;	~
ROM:7EDB FA					     .db 0FAh ;	˙
ROM:7EDC 11					     .db  11h
ROM:7EDD C0					     .db 0C0h ;	¿
ROM:7EDE 78					     .db  78h ;	x
ROM:7EDF FE					     .db 0FEh ;	˛
ROM:7EE0 00					     .db    0
ROM:7EE1 B0					     .db 0B0h ;	∞
ROM:7EE2 13					     .db  13h
ROM:7EE3 C0					     .db 0C0h ;	¿
ROM:7EE4 00					     .db    0
ROM:7EE5 D0					     .db 0D0h ;	–
ROM:7EE6 15					     .db  15h
ROM:7EE7 C0					     .db 0C0h ;	¿
ROM:7EE8 00					     .db    0
ROM:7EE9 D0					     .db 0D0h ;	–
ROM:7EEA 17					     .db  17h
ROM:7EEB C0					     .db 0C0h ;	¿
ROM:7EEC 00					     .db    0
ROM:7EED D0					     .db 0D0h ;	–
ROM:7EEE 7A					     .db  7Ah ;	z
ROM:7EEF F8					     .db 0F8h ;	¯
ROM:7EF0 00					     .db    0
ROM:7EF1 D0					     .db 0D0h ;	–
ROM:7EF2	     ; ---------------------------------------------------------------------------
ROM:7EF2
ROM:7EF2	     loc_7EF2:
ROM:7EF2 A9 50					     LDA     #50h ; 'P'
ROM:7EF4 A2 00					     LDX     #0			     ; addr = 0x5000
ROM:7EF6 20 FC 7B				     JSR     write_JSR_cmd	     ; draw test pattern
ROM:7EF9 A9 69					     LDA     #69h ; 'i'
ROM:7EFB A2 93					     LDX     #93h ; 'ì'
ROM:7EFD 20 03 7C				     JSR     write_CURx4_cmd
ROM:7F00 A9 30					     LDA     #30h ; '0'
ROM:7F02 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:7F05 A2 03					     LDX     #3			     ; 4 dipswitches to	read
ROM:7F07
ROM:7F07	     read_dsw1:							     ; read next dipswitch
ROM:7F07 BD 00 28				     LDA     2800h,X
ROM:7F0A 29 01					     AND     #1			     ; bit0 only
ROM:7F0C 86 0B					     STX     byte_B
ROM:7F0E 20 D1 7B				     JSR     display_digit_A
ROM:7F11 A6 0B					     LDX     byte_B
ROM:7F13 BD 00 28				     LDA     2800h,X		     ; read dipswitch again
ROM:7F16 29 02					     AND     #2			     ; bit1 only
ROM:7F18 4A					     LSR     A			     ; ->bit0
ROM:7F19 20 D1 7B				     JSR     display_digit_A
ROM:7F1C A6 0B					     LDX     byte_B
ROM:7F1E CA					     DEX			     ; done all	dipswitches?
ROM:7F1F 10 E6					     BPL     read_dsw1		     ; no, loop
ROM:7F21 A9 7A					     LDA     #7Ah ; 'z'
ROM:7F23 A2 9D					     LDX     #9Dh ; 'ù'
ROM:7F25 20 03 7C				     JSR     write_CURx4_cmd
ROM:7F28 A9 10					     LDA     #10h
ROM:7F2A 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:7F2D AD 02 28				     LDA     centerCoinMultiplierAndLives
ROM:7F30 29 02					     AND     #2			     ; Coin Multiplier
ROM:7F32 4A					     LSR     A
ROM:7F33 69 01					     ADC     #1
ROM:7F35 20 D1 7B				     JSR     display_digit_A
ROM:7F38 AD 01 28				     LDA     rightCoinMultiplier
ROM:7F3B 29 03					     AND     #3			     ; mask off	invalid	bits
ROM:7F3D AA					     TAX
ROM:7F3E BD F5 7F				     LDA     rightCoinMultiplierTable,X
ROM:7F41 20 D1 7B				     JSR     display_digit_A
ROM:7F44 A5 16					     LDA     byte_16
ROM:7F46 F0 07					     BEQ     loc_7F4F
ROM:7F48 A2 88					     LDX     #88h ; 'à'
ROM:7F4A A9 50					     LDA     #50h ; 'P'              ; addr = 0x5088
ROM:7F4C 20 FC 7B				     JSR     write_JSR_cmd	     ; more test pattern?
ROM:7F4F
ROM:7F4F	     loc_7F4F:
ROM:7F4F A2 96					     LDX     #96h ; 'ñ'
ROM:7F51 8E 0C 00				     STX     byte_C
ROM:7F54 A2 07					     LDX     #7
ROM:7F56
ROM:7F56	     loc_7F56:
ROM:7F56 B5 0D					     LDA     0Dh,X
ROM:7F58 F0 37					     BEQ     loc_7F91
ROM:7F5A 48					     PHA
ROM:7F5B 8E 0B 00				     STX     byte_B
ROM:7F5E AE 0C 00				     LDX     byte_C
ROM:7F61 8A					     TXA
ROM:7F62 38					     SEC
ROM:7F63 E9 08					     SBC     #8
ROM:7F65 8D 0C 00				     STA     byte_C
ROM:7F68 A9 20					     LDA     #20h ; ' '
ROM:7F6A 20 03 7C				     JSR     write_CURx4_cmd
ROM:7F6D A9 70					     LDA     #70h ; 'p'
ROM:7F6F 20 DE 7C				     JSR     set_scale_A_bright_0
ROM:7F72 AD 0B 00				     LDA     byte_B
ROM:7F75 20 D1 7B				     JSR     display_digit_A
ROM:7F78 AD D4 56				     LDA     DVGROM+6D4h
ROM:7F7B AE D5 56				     LDX     DVGROM+6D5h
ROM:7F7E 20 45 7D				     JSR     write_AX_to_avgram
ROM:7F81 68					     PLA
ROM:7F82 48					     PHA
ROM:7F83 4A					     LSR     A
ROM:7F84 4A					     LSR     A
ROM:7F85 4A					     LSR     A
ROM:7F86 4A					     LSR     A
ROM:7F87 20 D1 7B				     JSR     display_digit_A
ROM:7F8A 68					     PLA
ROM:7F8B 20 D1 7B				     JSR     display_digit_A
ROM:7F8E AE 0B 00				     LDX     byte_B
ROM:7F91
ROM:7F91	     loc_7F91:
ROM:7F91 CA					     DEX
ROM:7F92 10 C2					     BPL     loc_7F56
ROM:7F94 A9 7F					     LDA     #7Fh ; ''
ROM:7F96 AA					     TAX
ROM:7F97 20 03 7C				     JSR     write_CURx4_cmd
ROM:7F9A 20 C0 7B				     JSR     halt_dvg
ROM:7F9D
ROM:7F9D	     loc_7F9D:
ROM:7F9D A9 00					     LDA     #0
ROM:7F9F A2 04					     LDX     #4			     ; 5 switches to read
ROM:7FA1
ROM:7FA1	     read_in0:							     ; read next switch
ROM:7FA1 3E 03 20				     ROL     hyperspaceSwitch,X
ROM:7FA4 6A					     ROR     A			     ; shift into bit7
ROM:7FA5 CA					     DEX			     ; done all	switches?
ROM:7FA6 10 F9					     BPL     read_in0		     ; no, loop
ROM:7FA8 A8					     TAY
ROM:7FA9 A2 07					     LDX     #7			     ; 8 switches to read
ROM:7FAB
ROM:7FAB	     read_in1:							     ; read next switch
ROM:7FAB 3E 00 24				     ROL     leftCoinSwitch,X
ROM:7FAE 2A					     ROL     A			     ; shift into bit7
ROM:7FAF CA					     DEX			     ; done all	switches?
ROM:7FB0 10 F9					     BPL     read_in1		     ; no, loop
ROM:7FB2 AA					     TAX
ROM:7FB3 45 08					     EOR     byte_8
ROM:7FB5 86 08					     STX     byte_8
ROM:7FB7 08					     PHP
ROM:7FB8 A9 04					     LDA     #4			     ; RAMSEL
ROM:7FBA 8D 00 32				     STA     3200h		     ; output
ROM:7FBD 2E 03 20				     ROL     hyperspaceSwitch
ROM:7FC0 2A					     ROL     A
ROM:7FC1 2E 04 20				     ROL     FireSwitch
ROM:7FC4 2A					     ROL     A
ROM:7FC5 2E 07 24				     ROL     rotateLeftSwitch
ROM:7FC8 2A					     ROL     A
ROM:7FC9 2E 06 24				     ROL     rotateRightSwitch
ROM:7FCC 2A					     ROL     A
ROM:7FCD 2E 05 24				     ROL     thrustSwitch
ROM:7FD0 2A					     ROL     A
ROM:7FD1 AA					     TAX
ROM:7FD2 28					     PLP
ROM:7FD3 D0 09					     BNE     loc_7FDE
ROM:7FD5 45 0A					     EOR     byte_A
ROM:7FD7 D0 05					     BNE     loc_7FDE
ROM:7FD9 98					     TYA
ROM:7FDA 45 09					     EOR     byte_9
ROM:7FDC F0 02					     BEQ     loc_7FE0
ROM:7FDE
ROM:7FDE	     loc_7FDE:
ROM:7FDE A9 80					     LDA     #80h ; 'Ä'
ROM:7FE0
ROM:7FE0	     loc_7FE0:							     ; sound (bonus life)
ROM:7FE0 8D 05 3C				     STA     3C05h
ROM:7FE3 8D 00 32				     STA     3200h		     ; output
ROM:7FE6 8D 00 30				     STA     3000h		     ; AVG/DVG go
ROM:7FE9 86 0A					     STX     byte_A
ROM:7FEB 84 09					     STY     byte_9
ROM:7FED AD 07 20				     LDA     selfTest
ROM:7FF0
ROM:7FF0	     loc_7FF0:							     ; infinite	loop
ROM:7FF0 10 FE					     BPL     loc_7FF0
ROM:7FF2 4C 73 7E				     JMP     loc_7E73
ROM:7FF2	     ; ---------------------------------------------------------------------------
ROM:7FF5 01 04 05 06 rightCoinMultiplierTable:	     .db 1, 4, 5, 6
ROM:7FF9 4E					     .db  4Eh ;	N
ROM:7FFA 65 7B					     .dw NMI			     ; NMI vector
ROM:7FFC F3 7C					     .dw RESET			     ; RESET vector
ROM:7FFE F3 7C					     .dw RESET			     ; IRQ/BRK vector (unused)
ROM:7FFE	     ; end of 'ROM'
ROM:7FFE
ROM:7FFE
ROM:7FFE					     .end
