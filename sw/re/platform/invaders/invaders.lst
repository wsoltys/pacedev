ROM:0000	     ;
ROM:0000	     ; +-------------------------------------------------------------------------+
ROM:0000	     ; |   This	file has been generated	by The Interactive Disassembler	(IDA)	 |
ROM:0000	     ; |	   Copyright (c) 2015 Hex-Rays,	<support@hex-rays.com>		 |
ROM:0000	     ; |		      License info: 48-B437-7294-77			 |
ROM:0000	     ; |			Chris Nott, Virtual Logic			 |
ROM:0000	     ; +-------------------------------------------------------------------------+
ROM:0000	     ;
ROM:0000	     ; ---------------------------------------------------------------------------
ROM:0000	     ;
ROM:0000	     ; +--------------------------------------------------+
ROM:0000	     ; |	 Space Invaders	Disassembly v1.00	  |
ROM:0000	     ; |	  - by tcdev (msmcdoug@gmail.com)	  |
ROM:0000	     ; +--------------------------------------------------+
ROM:0000	     ;
ROM:0000	     ; Memory Map
ROM:0000	     ; ==========
ROM:0000	     ; $0000-$1FFF  Program ROM	(8KB)
ROM:0000	     ; $2000-$23FF  RAM	(1KB)
ROM:0000	     ; $2400-$3FFF  Video RAM (7KB)
ROM:0000
ROM:0000
ROM:0000	     ; Processor       : z80 []
ROM:0000	     ; Target assembler: ASxxxx	by Alan	R. Baldwin v1.5
ROM:0000		    .area   idaseg (ABS)
ROM:0000		    .hd64 ; this is needed only	for HD64180
ROM:0000
ROM:0000	     ; ===========================================================================
ROM:0000
ROM:0000	     ; Segment type: Pure code
ROM:0000
ROM:0000	     reset:
ROM:0000 00			     nop
ROM:0001 00			     nop
ROM:0002 00			     nop
ROM:0003 C3 D4 18		     jp	     start
ROM:0006	     ; ---------------------------------------------------------------------------
ROM:0006 00			     nop
ROM:0007 00			     nop
ROM:0008
ROM:0008	     RST8:							     ; vblank interrupt
ROM:0008 F5			     push    af
ROM:0009 C5			     push    bc
ROM:000A D5			     push    de
ROM:000B E5			     push    hl
ROM:000C C3 8C 00		     jp	     rst8_body
ROM:000F	     ; ---------------------------------------------------------------------------
ROM:000F 00			     nop
ROM:0010	     ; start of	VBLANK (line 224)
ROM:0010
ROM:0010	     RST10:							     ; general 60Hz interrupt
ROM:0010 F5			     push    af
ROM:0011 C5			     push    bc
ROM:0012 D5			     push    de
ROM:0013 E5			     push    hl
ROM:0014 3E 80			     ld	     a,	#0x80 ;	'€'                          ; $80 = RST10
ROM:0016 32 72 20		     ld	     (which_intr), a			     ; flag inside RST10
ROM:0019 21 C0 20		     ld	     hl, #isr_delay			     ; timer
ROM:001C 35			     dec     (hl)				     ; count down
ROM:001D CD CD 17		     call    handle_tilt			     ; (not coming back)
ROM:0020 DB 01			     in	     a,	(1)				     ; read controller 1
ROM:0022 0F			     rrca					     ; any credits?
ROM:0023 DA 67 00		     jp	     C,	debounce_credit			     ; yes, debounce
ROM:0026 3A EA 20		     ld	     a,	(debounced_credit_flag)		     ; debounced credits
ROM:0029 A7			     and     a					     ; any credits?
ROM:002A CA 42 00		     jp	     Z,	loc_0_42			     ; yes, skip
ROM:002D 3A EB 20		     ld	     a,	(num_credits)			     ; get number of credits
ROM:0030 FE 99			     cp	     #0x99 ; '™'                             ; maximum?
ROM:0032 CA 3E 00		     jp	     Z,	loc_0_3E			     ; yes, skip
ROM:0035 C6 01			     add     a,	#1				     ; add credit
ROM:0037 27			     daa
ROM:0038
ROM:0038	     ; =============== S U B R O U T I N E =======================================
ROM:0038
ROM:0038
ROM:0038	     sub_0_38:
ROM:0038 32 EB 20		     ld	     (num_credits), a			     ; save
ROM:003B CD 47 19		     call    draw_credits
ROM:003E
ROM:003E	     loc_0_3E:							     ; reset debounced credit flag
ROM:003E AF			     xor     a
ROM:003F
ROM:003F	     loc_0_3F:
ROM:003F 32 EA 20		     ld	     (debounced_credit_flag), a
ROM:0042
ROM:0042	     loc_0_42:
ROM:0042 3A E9 20		     ld	     a,	(enable_vblank_code)
ROM:0045 A7			     and     a					     ; are we expecting	a vblank intr?
ROM:0046 CA 82 00		     jp	     Z,	exit_intr			     ; yes, exit
ROM:0049 3A EF 20		     ld	     a,	(game_in_progress)
ROM:004C A7			     and     a					     ; game in progress?
ROM:004D C2 6F 00		     jp	     NZ, update_game			     ; yes, handle game	mechanics
ROM:0050 3A EB 20		     ld	     a,	(num_credits)
ROM:0053 A7			     and     a					     ; any credits?
ROM:0054 C2 5D 00		     jp	     NZ, prompt_player_to_start		     ; yes, skip
ROM:0057 CD BF 0A		     call    update_attract_animations		     ; anything	that involves moving invaders
ROM:005A C3 82 00		     jp	     exit_intr				     ; exit NMI
ROM:005D	     ; ---------------------------------------------------------------------------
ROM:005D
ROM:005D	     prompt_player_to_start:					     ; already started game?
ROM:005D 3A 93 20		     ld	     a,	(coined_up)
ROM:0060 A7			     and     a
ROM:0061 C2 82 00		     jp	     NZ, exit_intr			     ; yes, exit NMI
ROM:0064 C3 65 07		     jp	     show_PUSH_PLAYER_BUTTON
ROM:0067	     ; ---------------------------------------------------------------------------
ROM:0067
ROM:0067	     debounce_credit:						     ; catches falling edge of credit pulse
ROM:0067 3E 01			     ld	     a,	#1
ROM:0069 32 EA 20		     ld	     (debounced_credit_flag), a
ROM:006C C3 3F 00		     jp	     loc_0_3F				     ; back to loop
ROM:006F	     ; ---------------------------------------------------------------------------
ROM:006F
ROM:006F	     update_game:
ROM:006F CD 40 17		     call    do_update_invader_sound
ROM:0072
ROM:0072	     loc_0_72:
ROM:0072 3A 32 20		     ld	     a,	(obj2_timer_extra)
ROM:0075 32 80 20		     ld	     (shot_sync), a
ROM:0078 CD 00 01		     call    draw_invader
ROM:007B CD 48 02		     call    dispatch_vector_table@$2010	     ; dispatch	to jump	vector
ROM:007E CD 13 09		     call    handle_next_ufo_timer
ROM:0081 00			     nop
ROM:0082
ROM:0082	     exit_intr:
ROM:0082 E1			     pop     hl
ROM:0083 D1			     pop     de
ROM:0084 C1			     pop     bc
ROM:0085 F1			     pop     af
ROM:0086 FB			     ei
ROM:0087 C9			     ret
ROM:0087	     ; End of function sub_0_38
ROM:0087
ROM:0087	     ; ---------------------------------------------------------------------------
ROM:0088 00 00 00 00		     .db 0, 0, 0, 0
ROM:008C	     ; ---------------------------------------------------------------------------
ROM:008C
ROM:008C	     rst8_body:							     ; $00 = vblank intr
ROM:008C AF			     xor     a
ROM:008D 32 72 20		     ld	     (which_intr), a			     ; flag inside RST8
ROM:0090 3A E9 20		     ld	     a,	(enable_vblank_code)
ROM:0093 A7			     and     a					     ; vblank code enabled?
ROM:0094 CA 82 00		     jp	     Z,	exit_intr			     ; no, exit
ROM:0097 3A EF 20		     ld	     a,	(game_in_progress)
ROM:009A A7			     and     a					     ; game already started?
ROM:009B C2 A5 00		     jp	     NZ, dispatch_vector_table@$2020	     ; yes, skip
ROM:009E 3A C1 20		     ld	     a,	(animation_type)
ROM:00A1 0F			     rrca					     ; is there	an animation in	progress?
ROM:00A2 D2 82 00		     jp	     NC, exit_intr			     ; no, exit
ROM:00A5
ROM:00A5	     dispatch_vector_table@$2020:
ROM:00A5 21 20 20		     ld	     hl, #obj1_timer_msb
ROM:00A8 CD 4B 02		     call    dispatch_jump_vector		     ; dispatch	to jump	vector
ROM:00AB CD 41 01		     call    update_next_invader_check_invasi	     ; updates the next	invader	and
ROM:00AB									     ; checks for an invasion
ROM:00AE C3 82 00		     jp	     exit_intr				     ; exit NMI
ROM:00B1
ROM:00B1	     ; =============== S U B R O U T I N E =======================================
ROM:00B1
ROM:00B1
ROM:00B1	     restore_invader_params:
ROM:00B1 CD 86 08		     call    ptr_curr_p_bl_invader_coords	     ; get pointer to invader coords
ROM:00B4 E5			     push    hl
ROM:00B5 7E			     ld	     a,	(hl)				     ; get x coord
ROM:00B6 23			     inc     hl
ROM:00B7 66			     ld	     h,	(hl)				     ; get y coord
ROM:00B8 6F			     ld	     l,	a
ROM:00B9 22 09 20		     ld	     (bottom_left_invader_y), hl	     ; init invader coords
ROM:00BC 22 0B 20		     ld	     (curr_invader_y), hl		     ; init current invader coords
ROM:00BF E1			     pop     hl
ROM:00C0 2B			     dec     hl
ROM:00C1 7E			     ld	     a,	(hl)				     ; get invader x increment
ROM:00C2 FE 03			     cp	     #3
ROM:00C4 C2 C8 00		     jp	     NZ, loc_0_C8
ROM:00C7 3D			     dec     a
ROM:00C8
ROM:00C8	     loc_0_C8:							     ; init invader x inc
ROM:00C8 32 08 20		     ld	     (invader_x_inc), a
ROM:00CB FE FE			     cp	     #0xFE ; 'þ'                             ; left?
ROM:00CD 3E 00			     ld	     a,	#0				     ; flag invaders moving left
ROM:00CF C2 D3 00		     jp	     NZ, loc_0_D3			     ; no, skip
ROM:00D2 3C			     inc     a					     ; flag invaders moving right
ROM:00D3
ROM:00D3	     loc_0_D3:							     ; store
ROM:00D3 32 0D 20		     ld	     (invader_left_right), a
ROM:00D6 C9			     ret
ROM:00D6	     ; End of function restore_invader_params
ROM:00D6
ROM:00D7
ROM:00D7	     ; =============== S U B R O U T I N E =======================================
ROM:00D7
ROM:00D7
ROM:00D7	     init_invader_xinc_wipe_2p_score:
ROM:00D7 3E 02			     ld	     a,	#2
ROM:00D9 32 FB 21		     ld	     (p1_invader_x_inc), a		     ; init p1 invader x inc
ROM:00DC 32 FB 22		     ld	     (p2_invader_x_inc), a		     ; init p2 invader x inc
ROM:00DF C3 E4 08		     jp	     wipe_2p_score
ROM:00DF	     ; End of function init_invader_xinc_wipe_2p_score
ROM:00DF
ROM:00DF	     ; ---------------------------------------------------------------------------
ROM:00E2 00 00 00 00+		     .db 0, 0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0
ROM:00E2 00 00 00 00+		     .db 0, 0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 0, 0
ROM:0100
ROM:0100	     ; =============== S U B R O U T I N E =======================================
ROM:0100
ROM:0100
ROM:0100	     draw_invader:
ROM:0100 21 02 20		     ld	     hl, #player_shot_something		     ; ptr flag	that player shot something
ROM:0103 7E			     ld	     a,	(hl)
ROM:0104 A7			     and     a					     ; has player shot something?
ROM:0105 C2 38 15		     jp	     NZ, check_invader_finished_exploding    ; yes, skip
ROM:0105									     ; - interesting - invaders	actually stop moving
ROM:0105									     ;	 while one of them is exploding
ROM:0108 E5			     push    hl
ROM:0109 3A 06 20		     ld	     a,	(next_invader_to_update)	     ; get invader number (1-55)
ROM:010C 6F			     ld	     l,	a
ROM:010D 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:0110 67			     ld	     h,	a				     ; hl = invader in invader map
ROM:0111 7E			     ld	     a,	(hl)				     ; invader still alive?
ROM:0112 A7			     and     a
ROM:0113 E1			     pop     hl
ROM:0114 CA 36 01		     jp	     Z,	loc_0_136			     ; no, exit
ROM:0117 23			     inc     hl
ROM:0118 23			     inc     hl
ROM:0119 7E			     ld	     a,	(hl)				     ; get invader row
ROM:011A 23			     inc     hl
ROM:011B 46			     ld	     b,	(hl)				     ; invader sprite (animation) # (0 or 1)
ROM:011C E6 FE			     and     #0xFE ; 'þ'                             ; derive type from row (0/2/4)
ROM:011E 07			     rlca
ROM:011F 07			     rlca
ROM:0120 07			     rlca					     ; x8 == type x 16
ROM:0121 5F			     ld	     e,	a
ROM:0122 16 00			     ld	     d,	#0				     ; de = offset of invader sprite
ROM:0124 21 00 1C		     ld	     hl, #gfx_table			     ; invader gfx table
ROM:0127 19			     add     hl, de
ROM:0128 EB			     ex	     de, hl				     ; de = invader sprite #1
ROM:0129 78			     ld	     a,	b				     ; sprite #
ROM:012A A7			     and     a					     ; draw sprite #2?
ROM:012B C4 3B 01		     call    NZ, add_30h_to_de			     ; yes - sprite #2
ROM:012E 2A 0B 20		     ld	     hl, (curr_invader_y)		     ; get pixel offset	of invader
ROM:0131 06 10			     ld	     b,	#0x10				     ; invader bitmap length
ROM:0133 CD D3 15		     call    draw_shifted_bitmap
ROM:0136
ROM:0136	     loc_0_136:							     ; flag invader as not yet updated (drawn)
ROM:0136 AF			     xor     a
ROM:0137 32 00 20		     ld	     (curr_invader_needs_drawing), a
ROM:013A C9			     ret
ROM:013A	     ; End of function draw_invader
ROM:013A
ROM:013B
ROM:013B	     ; =============== S U B R O U T I N E =======================================
ROM:013B
ROM:013B
ROM:013B	     add_30h_to_de:
ROM:013B 21 30 00		     ld	     hl, #0x30 ; '0'
ROM:013E 19			     add     hl, de
ROM:013F EB			     ex	     de, hl
ROM:0140 C9			     ret
ROM:0140	     ; End of function add_30h_to_de
ROM:0140
ROM:0141
ROM:0141	     ; =============== S U B R O U T I N E =======================================
ROM:0141
ROM:0141
ROM:0141	     update_next_invader_check_invasi:
ROM:0141 3A 68 20		     ld	     a,	(player_ok)
ROM:0144 A7			     and     a
ROM:0145 C8			     ret     Z
ROM:0146 3A 00 20		     ld	     a,	(curr_invader_needs_drawing)
ROM:0149 A7			     and     a					     ; has the current invader been drawn yet?
ROM:014A C0			     ret     NZ					     ; no, exit
ROM:014B 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:014E 67			     ld	     h,	a				     ; get ptr to current player data
ROM:014F 3A 06 20		     ld	     a,	(next_invader_to_update)
ROM:0152 16 02			     ld	     d,	#2				     ; don't want to trigger movement from here
ROM:0152									     ; - see check_time_to_move_bl_invader
ROM:0154
ROM:0154	     find_next_alive_invader:
ROM:0154 3C			     inc     a
ROM:0155 FE 37			     cp	     #55				     ; updated all invaders?
ROM:0157 CC A1 01		     call    Z,	check_time_to_move_bl_invader	     ; yes, reset logic
ROM:015A 6F			     ld	     l,	a				     ; next invader to update
ROM:015B 46			     ld	     b,	(hl)				     ; this invader in invader map
ROM:015C 05			     dec     b					     ; still alive?
ROM:015D C2 54 01		     jp	     NZ, find_next_alive_invader	     ; no, next	invader
ROM:0160 32 06 20		     ld	     (next_invader_to_update), a	     ; set current invader to update
ROM:0163 CD 7A 01		     call    get_alien_coords
ROM:0166 61			     ld	     h,	c				     ; x coord
ROM:0167 22 0B 20		     ld	     (curr_invader_y), hl		     ; save x and y coords of curr invader
ROM:016A 7D			     ld	     a,	l				     ; y coord
ROM:016B FE 28			     cp	     #40				     ; have we been invaded?
ROM:016D DA 71 19		     jp	     C,	handle_invasion			     ; yes, handle
ROM:0170 7A			     ld	     a,	d				     ; invader row
ROM:0171 32 04 20		     ld	     (curr_invader_updated_row), a	     ; store as	current	row
ROM:0174 3E 01			     ld	     a,	#1				     ; flag invader as needing to be drawn
ROM:0176 32 00 20		     ld	     (curr_invader_needs_drawing), a
ROM:0179 C9			     ret
ROM:0179	     ; End of function update_next_invader_check_invasi
ROM:0179
ROM:017A
ROM:017A	     ; =============== S U B R O U T I N E =======================================
ROM:017A
ROM:017A
ROM:017A	     get_alien_coords:
ROM:017A 16 00			     ld	     d,	#0
ROM:017C 7D			     ld	     a,	l				     ; invader offset in map
ROM:017D 21 09 20		     ld	     hl, #bottom_left_invader_y		     ; ptr bottom left invader y coord
ROM:0180 46			     ld	     b,	(hl)				     ; get y coord
ROM:0181 23			     inc     hl
ROM:0182 4E			     ld	     c,	(hl)				     ; get x coord
ROM:0183
ROM:0183	     find_alien_y:						     ; on this row?
ROM:0183 FE 0B			     cp	     #11
ROM:0185 FA 94 01		     jp	     M,	find_alien_x			     ; yes, skip
ROM:0188 DE 0B			     sbc     a,	#11				     ; up 1 row
ROM:018A 5F			     ld	     e,	a
ROM:018B 78			     ld	     a,	b				     ; y coord
ROM:018C C6 10			     add     a,	#0x10				     ; update to next row
ROM:018E 47			     ld	     b,	a
ROM:018F 7B			     ld	     a,	e
ROM:0190 14			     inc     d					     ; inc row counter
ROM:0191 C3 83 01		     jp	     find_alien_y			     ; loop
ROM:0194	     ; ---------------------------------------------------------------------------
ROM:0194
ROM:0194	     find_alien_x:						     ; save y coord of invader for return
ROM:0194 68			     ld	     l,	b
ROM:0195
ROM:0195	     find_alien_loop:						     ; left-hand edge alien?
ROM:0195 A7			     and     a
ROM:0196 C8			     ret     Z					     ; yes, done - return
ROM:0197 5F			     ld	     e,	a				     ; invader offset (1-10)
ROM:0198 79			     ld	     a,	c
ROM:0199 C6 10			     add     a,	#0x10				     ; next alien along
ROM:019B 4F			     ld	     c,	a				     ; save x coord of invader for return
ROM:019C 7B			     ld	     a,	e
ROM:019D 3D			     dec     a					     ; found alien?
ROM:019E C3 95 01		     jp	     find_alien_loop			     ; no, loop
ROM:019E	     ; End of function get_alien_coords
ROM:019E
ROM:01A1
ROM:01A1	     ; =============== S U B R O U T I N E =======================================
ROM:01A1
ROM:01A1
ROM:01A1	     check_time_to_move_bl_invader:
ROM:01A1 15			     dec     d					     ; do we want to move inavders at this point?
ROM:01A2 CA CD 01		     jp	     Z,	pop_and_ret			     ; no, return to parent context
ROM:01A5 21 06 20		     ld	     hl, #next_invader_to_update	     ; next invader to update
ROM:01A8 36 00			     ld	     (hl), #0				     ; reset invader update counter
ROM:01AA 23			     inc     hl
ROM:01AB 4E			     ld	     c,	(hl)				     ; get invader y increment
ROM:01AC 36 00			     ld	     (hl), #0				     ; next time will be zero
ROM:01AE CD D9 01		     call    add_c_hl1_hl2_hl3			     ; update bottom left invader x,y coords
ROM:01B1 21 05 20		     ld	     hl, #invader_animation_frame_no	     ; ptr invader animation frame no.
ROM:01B4 7E			     ld	     a,	(hl)
ROM:01B5 3C			     inc     a
ROM:01B6 E6 01			     and     #1					     ; toggle animation	frame 0/1
ROM:01B8 77			     ld	     (hl), a				     ; save it
ROM:01B9 AF			     xor     a					     ; ? gets over-written by callers?
ROM:01BA 21 67 20		     ld	     hl, #ptr_curr_player_data		     ; ptr curr	player data
ROM:01BD 66			     ld	     h,	(hl)				     ; get offset (==player)
ROM:01BE C9			     ret
ROM:01BE	     ; End of function check_time_to_move_bl_invader
ROM:01BE
ROM:01BF	     ; ---------------------------------------------------------------------------
ROM:01BF 00			     nop
ROM:01C0
ROM:01C0	     ; =============== S U B R O U T I N E =======================================
ROM:01C0
ROM:01C0
ROM:01C0	     init_p1_invader_map:
ROM:01C0 21 00 21		     ld	     hl, #p1_invader_map		     ; player 1	invader	map
ROM:01C3
ROM:01C3	     init_invader_map:						     ; 55 invaders
ROM:01C3 06 37			     ld	     b,	#55
ROM:01C5
ROM:01C5	     fill_hl_with_1:
ROM:01C5 36 01			     ld	     (hl), #1
ROM:01C7 23			     inc     hl
ROM:01C8 05			     dec     b
ROM:01C9 C2 C5 01		     jp	     NZ, fill_hl_with_1
ROM:01CC C9			     ret
ROM:01CC	     ; End of function init_p1_invader_map
ROM:01CC
ROM:01CD	     ; ---------------------------------------------------------------------------
ROM:01CD
ROM:01CD	     pop_and_ret:
ROM:01CD E1			     pop     hl
ROM:01CE C9			     ret
ROM:01CF
ROM:01CF	     ; =============== S U B R O U T I N E =======================================
ROM:01CF
ROM:01CF
ROM:01CF	     draw_base_line:
ROM:01CF 3E 01			     ld	     a,	#1
ROM:01D1 06 E0			     ld	     b,	#0xE0 ;	'à'                          ; fill 224 bytes
ROM:01D3 21 02 24		     ld	     hl, # vram+2			     ; start of	visible	display
ROM:01D6 C3 CC 14		     jp	     fill_chr_hl_b_
ROM:01D6	     ; End of function draw_base_line
ROM:01D6
ROM:01D9
ROM:01D9	     ; =============== S U B R O U T I N E =======================================
ROM:01D9
ROM:01D9
ROM:01D9	     add_c_hl1_hl2_hl3:
ROM:01D9 23			     inc     hl
ROM:01DA 46			     ld	     b,	(hl)				     ; b = [hl+1]
ROM:01DB 23			     inc     hl
ROM:01DC 79			     ld	     a,	c
ROM:01DD 86			     add     a,	(hl)
ROM:01DE 77			     ld	     (hl), a				     ; [hl+2] =	[hl+2] + c
ROM:01DF 23			     inc     hl
ROM:01E0 78			     ld	     a,	b
ROM:01E1 86			     add     a,	(hl)
ROM:01E2 77			     ld	     (hl), a				     ; [hl+3] =	[hl+3] + [hl+1]
ROM:01E3 C9			     ret
ROM:01E3	     ; End of function add_c_hl1_hl2_hl3
ROM:01E3
ROM:01E4
ROM:01E4	     ; =============== S U B R O U T I N E =======================================
ROM:01E4
ROM:01E4
ROM:01E4	     init_vars_192:
ROM:01E4 06 C0			     ld	     b,	#0xC0 ;	'À'                          ; 192 bytes to copy
ROM:01E4	     ; End of function init_vars_192
ROM:01E4
ROM:01E6
ROM:01E6	     ; =============== S U B R O U T I N E =======================================
ROM:01E6
ROM:01E6
ROM:01E6	     init_vars_b_:
ROM:01E6 11 00 1B		     ld	     de, #byte_0_1B00
ROM:01E9 21 00 20		     ld	     hl, #curr_invader_needs_drawing	     ; work ram
ROM:01EC C3 32 1A		     jp	     memcpy_hl_de_b_			     ; init variables
ROM:01EC	     ; End of function init_vars_b_
ROM:01EC
ROM:01EF
ROM:01EF	     ; =============== S U B R O U T I N E =======================================
ROM:01EF
ROM:01EF
ROM:01EF	     init_p1_shields:
ROM:01EF 21 42 21		     ld	     hl, #p1_shields
ROM:01F2 C3 F8 01		     jp	     init_shields
ROM:01F5	     ; ---------------------------------------------------------------------------
ROM:01F5
ROM:01F5	     init_p2_shields:
ROM:01F5 21 42 22		     ld	     hl, #p2_sheids
ROM:01F8
ROM:01F8	     init_shields:						     ; 4 shields
ROM:01F8 0E 04			     ld	     c,	#4
ROM:01FA 11 20 1D		     ld	     de, #shield_gfx_data		     ; source data
ROM:01FD
ROM:01FD	     init_1_shield:
ROM:01FD D5			     push    de
ROM:01FE 06 2C			     ld	     b,	#44				     ; copy 44 bytes
ROM:0200 CD 32 1A		     call    memcpy_hl_de_b_
ROM:0203 D1			     pop     de
ROM:0204 0D			     dec     c
ROM:0205 C2 FD 01		     jp	     NZ, init_1_shield			     ; done? - no, loop
ROM:0208 C9			     ret
ROM:0208	     ; End of function init_p1_shields
ROM:0208
ROM:0209
ROM:0209	     ; =============== S U B R O U T I N E =======================================
ROM:0209
ROM:0209
ROM:0209	     save_p1_shields:
ROM:0209 3E 01			     ld	     a,	#1				     ; flag to save shields
ROM:020B C3 1B 02		     jp	     draw_or_save_p1_shields
ROM:020B	     ; End of function save_p1_shields
ROM:020B
ROM:020E
ROM:020E	     ; =============== S U B R O U T I N E =======================================
ROM:020E
ROM:020E
ROM:020E	     save_p2_shields:
ROM:020E 3E 01			     ld	     a,	#1				     ; flag to save shields
ROM:0210 C3 14 02		     jp	     draw_or_save_p2_shields
ROM:0210	     ; End of function save_p2_shields
ROM:0210
ROM:0213
ROM:0213	     ; =============== S U B R O U T I N E =======================================
ROM:0213
ROM:0213
ROM:0213	     draw_p2_shields:
ROM:0213 AF			     xor     a					     ; flag to restore shields
ROM:0214
ROM:0214	     draw_or_save_p2_shields:					     ; ptr player 2 shields
ROM:0214 11 42 22		     ld	     de, #p2_sheids
ROM:0217 C3 1E 02		     jp	     draw_or_save_shields
ROM:0217	     ; End of function draw_p2_shields
ROM:0217
ROM:021A
ROM:021A	     ; =============== S U B R O U T I N E =======================================
ROM:021A
ROM:021A
ROM:021A	     draw_p1_shields:
ROM:021A AF			     xor     a					     ; flag to restore shields
ROM:021B
ROM:021B	     draw_or_save_p1_shields:					     ; ptr player 1 shields
ROM:021B 11 42 21		     ld	     de, #p1_shields
ROM:021E
ROM:021E	     draw_or_save_shields:					     ; save flag
ROM:021E 32 81 20		     ld	     (draw_or_restore_shields_flag), a
ROM:0221 01 02 16		     ld	     bc, # loc_0_1601+1			     ; 22(b)x2(c)=44 bytes per shield
ROM:0224 21 06 28		     ld	     hl, # vram+0x406			     ; screen loc of 1st shields
ROM:0227 3E 04			     ld	     a,	#4				     ; 4 shields
ROM:0229
ROM:0229	     start_shield:
ROM:0229 F5			     push    af
ROM:022A C5			     push    bc
ROM:022B 3A 81 20		     ld	     a,	(draw_or_restore_shields_flag)
ROM:022E A7			     and     a					     ; drawing?
ROM:022F C2 42 02		     jp	     NZ, loc_0_242			     ; no, skip	to save	routine
ROM:0232 CD 69 1A		     call    restore_1_shield
ROM:0235
ROM:0235	     next_shield:
ROM:0235 C1			     pop     bc
ROM:0236 F1			     pop     af
ROM:0237 3D			     dec     a					     ; next shield
ROM:0238 C8			     ret     Z					     ; return if done
ROM:0239 D5			     push    de
ROM:023A 11 E0 02		     ld	     de, #736				     ; offset on screen	to next	shield
ROM:023D 19			     add     hl, de				     ; screen loc of next shield
ROM:023E D1			     pop     de
ROM:023F C3 29 02		     jp	     start_shield			     ; loop
ROM:0242	     ; ---------------------------------------------------------------------------
ROM:0242
ROM:0242	     loc_0_242:
ROM:0242 CD 7C 14		     call    save_1_shield
ROM:0245 C3 35 02		     jp	     next_shield
ROM:0245	     ; End of function draw_p1_shields
ROM:0245
ROM:0248	     ; ---------------------------------------------------------------------------
ROM:0248
ROM:0248	     dispatch_vector_table@$2010:				     ; ptr jump	vector table
ROM:0248 21 10 20		     ld	     hl, #obj0_timer_msb
ROM:024B
ROM:024B	     dispatch_jump_vector:
ROM:024B 7E			     ld	     a,	(hl)
ROM:024C FE FF			     cp	     #0xFF				     ; execute this vector?
ROM:024E C8			     ret     Z					     ; no, exit
ROM:024F FE FE			     cp	     #0xFE ; 'þ'                             ; execute next vector?
ROM:0251 CA 81 02		     jp	     Z,	get_ptr_next_vector		     ; yes, handle
ROM:0254 23			     inc     hl					     ; $2011
ROM:0255 46			     ld	     b,	(hl)
ROM:0256 4F			     ld	     c,	a
ROM:0257 B0			     or	     b
ROM:0258 79			     ld	     a,	c
ROM:0259 C2 77 02		     jp	     NZ, loc_0_277
ROM:025C 23			     inc     hl					     ; $2012
ROM:025D 7E			     ld	     a,	(hl)
ROM:025E A7			     and     a
ROM:025F C2 88 02		     jp	     NZ, loc_0_288
ROM:0262 23			     inc     hl					     ; $2013
ROM:0263 5E			     ld	     e,	(hl)
ROM:0264 23			     inc     hl
ROM:0265 56			     ld	     d,	(hl)				     ; de = [$2013] (jump vector - see below)
ROM:0265									     ; hl = $2014
ROM:0266 E5			     push    hl					     ; stack: $2014
ROM:0267 EB			     ex	     de, hl				     ; de = $2014, hl =	[$2013]
ROM:0268 E5			     push    hl					     ; stack: [$2013] $2014
ROM:0269 21 6F 02		     ld	     hl, #0x26F
ROM:026C E3			     ex	     (sp), hl				     ; stack: $26F $2014
ROM:026D D5			     push    de					     ; stack: $2014 $26F $2014
ROM:026E E9			     jp	     (hl)				     ; jp [$2013]
ROM:026F	     ; ---------------------------------------------------------------------------
ROM:026F E1			     pop     hl					     ; $2014
ROM:0270 11 0C 00		     ld	     de, #0xC
ROM:0273 19			     add     hl, de				     ; next jump vector
ROM:0274 C3 4B 02		     jp	     dispatch_jump_vector		     ; loop
ROM:0277	     ; ---------------------------------------------------------------------------
ROM:0277
ROM:0277	     loc_0_277:
ROM:0277 05			     dec     b
ROM:0278 04			     inc     b
ROM:0279 C2 7D 02		     jp	     NZ, loc_0_27D
ROM:027C 3D			     dec     a
ROM:027D
ROM:027D	     loc_0_27D:
ROM:027D 05			     dec     b
ROM:027E 70			     ld	     (hl), b
ROM:027F 2B			     dec     hl
ROM:0280 77			     ld	     (hl), a
ROM:0281
ROM:0281	     get_ptr_next_vector:
ROM:0281 11 10 00		     ld	     de, #0x10
ROM:0284 19			     add     hl, de
ROM:0285 C3 4B 02		     jp	     dispatch_jump_vector
ROM:0288	     ; ---------------------------------------------------------------------------
ROM:0288
ROM:0288	     loc_0_288:
ROM:0288 35			     dec     (hl)
ROM:0289 2B			     dec     hl
ROM:028A 2B			     dec     hl
ROM:028B C3 81 02		     jp	     get_ptr_next_vector
ROM:028E	     ; ---------------------------------------------------------------------------
ROM:028E E1			     pop     hl					     ; jump vector #1
ROM:028F 23			     inc     hl
ROM:0290 7E			     ld	     a,	(hl)				     ; get explosion #
ROM:0291 FE FF			     cp	     #0xFF
ROM:0293 CA 3B 03		     jp	     Z,	loc_0_33B
ROM:0296 23			     inc     hl
ROM:0297 35			     dec     (hl)
ROM:0298 C0			     ret     NZ
ROM:0299 47			     ld	     b,	a				     ; save explosion #
ROM:029A AF			     xor     a
ROM:029B 32 68 20		     ld	     (player_ok), a
ROM:029E 32 69 20		     ld	     (enable_alien_fire), a
ROM:02A1 3E 30			     ld	     a,	#48
ROM:02A3 32 6A 20		     ld	     (alien_fire_delay), a
ROM:02A6 78			     ld	     a,	b				     ; restore explosion #
ROM:02A7 36 05			     ld	     (hl), #5
ROM:02A9 23			     inc     hl
ROM:02AA 35			     dec     (hl)				     ; finished	explosion?
ROM:02AB C2 9B 03		     jp	     NZ, handle_ship_explosion		     ; no, handle it
ROM:02AE 2A 1A 20		     ld	     hl, (player_ship_coord)
ROM:02B1 06 10			     ld	     b,	#16				     ; bitmap length
ROM:02B3 CD 24 14		     call    clear_shifted_bitmap		     ; wipe player ship
ROM:02B6 21 10 20		     ld	     hl, #obj0_timer_msb
ROM:02B9 11 10 1B		     ld	     de, # byte_0_1B00+0x10
ROM:02BC 06 10			     ld	     b,	#16
ROM:02BE CD 32 1A		     call    memcpy_hl_de_b_			     ; re-init vars (16	bytes)
ROM:02C1 06 00			     ld	     b,	#0				     ; stop all	port 3 sounds
ROM:02C3 CD DC 19		     call    stop_port3_sound
ROM:02C6 3A 6D 20		     ld	     a,	(invaded)			     ; ptr invaded flag
ROM:02C9 A7			     and     a					     ; invaded?
ROM:02CA C0			     ret     NZ					     ; yes, let	other code handle this
ROM:02CB 3A EF 20		     ld	     a,	(game_in_progress)
ROM:02CE A7			     and     a					     ; game in progress?
ROM:02CF C8			     ret     Z					     ; no, exit
ROM:02D0 31 00 24		     ld	     sp, #vram
ROM:02D3 FB			     ei						     ; reset context
ROM:02D4 CD D7 19		     call    disable_vblank_code
ROM:02D7 CD 2E 09		     call    get_curr_player_num_ships
ROM:02DA A7			     and     a					     ; any ships left?
ROM:02DB CA 6D 16		     jp	     Z,	prt_0_ships_left		     ; no, exit
ROM:02DE CD E7 18		     call    get_ptr_num_ships_other_player
ROM:02E1 7E			     ld	     a,	(hl)
ROM:02E2 A7			     and     a					     ; any ships left?
ROM:02E3 CA 2C 03		     jp	     Z,	show_ships_and_ret		     ; no, exit
ROM:02E6 3A CE 20		     ld	     a,	(two_p_game)
ROM:02E9 A7			     and     a					     ; only 1 player?
ROM:02EA CA 2C 03		     jp	     Z,	show_ships_and_ret		     ; yes, exit
ROM:02ED
ROM:02ED	     save_player_state:
ROM:02ED 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:02F0 F5			     push    af					     ; player data ($21=1,$22=2)
ROM:02F1 0F			     rrca
ROM:02F2 DA 32 03		     jp	     C,	c_save_p1_shields		     ; save p1 shields
ROM:02F5 CD 0E 02		     call    save_p2_shields			     ; save p2 shields
ROM:02F8
ROM:02F8	     shields_saved:
ROM:02F8 CD 78 08		     call    get_curr_and_player_invader_coor
ROM:02FB 73			     ld	     (hl), e				     ; save bottom left	invader	y coord
ROM:02FC 23			     inc     hl
ROM:02FD 72			     ld	     (hl), d				     ; save bottom left	invader	x coord
ROM:02FE 2B			     dec     hl
ROM:02FF 2B			     dec     hl
ROM:0300 70			     ld	     (hl), b				     ; save invader x increment
ROM:0301 00			     nop
ROM:0302 CD E4 01		     call    init_vars_192
ROM:0305 F1			     pop     af					     ; ptr player data
ROM:0306 0F			     rrca
ROM:0307 3E 21			     ld	     a,	#0x21 ;	'!'                          ; set player = 1
ROM:0309 06 00			     ld	     b,	#0
ROM:030B D2 12 03		     jp	     NC, loc_0_312			     ; was p2, skip
ROM:030E 06 20			     ld	     b,	#0x20 ;	' '                          ; flip screen
ROM:0310 3E 22			     ld	     a,	#0x22 ;	'"'                          ; set player = 2
ROM:0312
ROM:0312	     loc_0_312:							     ; set ptr to player data ($21=1,$22=2)
ROM:0312 32 67 20		     ld	     (ptr_curr_player_data), a
ROM:0315 CD B6 0A		     call    two_sec_delay
ROM:0318 AF			     xor     a
ROM:0319 32 11 20		     ld	     (obj0_timer_lsb), a
ROM:031C 78			     ld	     a,	b				     ; flip screen bit
ROM:031D D3 05			     out     (5), a				     ; set screen flip
ROM:031F 3C			     inc     a					     ; fleet #1	sound?
ROM:0320 32 98 20		     ld	     (port_5_sound_shadow_reg),	a	     ; port5 sound register shadow
ROM:0323 CD D6 09		     call    clear_visible_display
ROM:0326 CD 7F 1A		     call    show_ships_left
ROM:0329 C3 F9 07		     jp	     start_player_new_ship
ROM:032C	     ; ---------------------------------------------------------------------------
ROM:032C
ROM:032C	     show_ships_and_ret:
ROM:032C CD 7F 1A		     call    show_ships_left
ROM:032F C3 17 08		     jp	     loc_0_817
ROM:0332	     ; ---------------------------------------------------------------------------
ROM:0332
ROM:0332	     c_save_p1_shields:
ROM:0332 CD 09 02		     call    save_p1_shields
ROM:0335 C3 F8 02		     jp	     shields_saved
ROM:0338	     ; ---------------------------------------------------------------------------
ROM:0338 00			     nop
ROM:0339 00			     nop
ROM:033A 00			     nop
ROM:033B
ROM:033B	     loc_0_33B:
ROM:033B 21 68 20		     ld	     hl, #player_ok
ROM:033E 36 01			     ld	     (hl), #1
ROM:0340 23			     inc     hl
ROM:0341 7E			     ld	     a,	(hl)
ROM:0342 A7			     and     a
ROM:0343 C3 B0 03		     jp	     loc_0_3B0
ROM:0346	     ; ---------------------------------------------------------------------------
ROM:0346
ROM:0346	     loc_0_346:
ROM:0346 00			     nop
ROM:0347 2B			     dec     hl
ROM:0348 36 01			     ld	     (hl), #1
ROM:034A
ROM:034A	     handle_ship:
ROM:034A 3A 1B 20		     ld	     a,	(player_ship_coord_lsb_)
ROM:034D 47			     ld	     b,	a
ROM:034E 3A EF 20		     ld	     a,	(game_in_progress)
ROM:0351 A7			     and     a					     ; is someone playing?
ROM:0352 C2 63 03		     jp	     NZ, handle_joystick		     ; yes - use real controls
ROM:0355 3A 1D 20		     ld	     a,	(demo_joystick_input)		     ; read simulated controller inputs
ROM:0358 0F			     rrca					     ; move right?
ROM:0359 DA 81 03		     jp	     C,	handle_joystick_right		     ; yes, handle
ROM:035C 0F			     rrca					     ; move left?
ROM:035D DA 8E 03		     jp	     C,	handle_joystick_left		     ; yes, handle
ROM:0360 C3 6F 03		     jp	     ship_coord_updated
ROM:0363	     ; ---------------------------------------------------------------------------
ROM:0363
ROM:0363	     handle_joystick:
ROM:0363 CD C0 17		     call    read_player_controller
ROM:0366 07			     rlca
ROM:0367 07			     rlca
ROM:0368 DA 81 03		     jp	     C,	handle_joystick_right		     ; joystick	right
ROM:036B 07			     rlca
ROM:036C DA 8E 03		     jp	     C,	handle_joystick_left		     ; joystick	left
ROM:036F
ROM:036F	     ship_coord_updated:					     ; player ship info
ROM:036F 21 18 20		     ld	     hl, #player_ship_info
ROM:0372 CD 3B 1A		     call    extract_DE_HL_B
ROM:0375 CD 47 1A		     call    calc_vram_addr_from_pixel_offset
ROM:0378 CD 39 14		     call    draw_simp_sprite			     ; draw player ship
ROM:037B 3E 00			     ld	     a,	#0
ROM:037D 32 12 20		     ld	     (obj0_timer_extra), a
ROM:0380 C9			     ret
ROM:0381	     ; ---------------------------------------------------------------------------
ROM:0381
ROM:0381	     handle_joystick_right:					     ; player ship coord
ROM:0381 78			     ld	     a,	b
ROM:0382 FE D9			     cp	     #217				     ; extreme right of	screen?
ROM:0384 CA 6F 03		     jp	     Z,	ship_coord_updated		     ; yes, exit
ROM:0387 3C			     inc     a					     ; increment coord
ROM:0388 32 1B 20		     ld	     (player_ship_coord_lsb_), a	     ; save
ROM:038B C3 6F 03		     jp	     ship_coord_updated			     ; done
ROM:038E	     ; ---------------------------------------------------------------------------
ROM:038E
ROM:038E	     handle_joystick_left:					     ; player ship coord
ROM:038E 78			     ld	     a,	b
ROM:038F FE 30			     cp	     #0x30 ; '0'                             ; extreme left?
ROM:0391 CA 6F 03		     jp	     Z,	ship_coord_updated		     ; yes, exit
ROM:0394 3D			     dec     a					     ; decrement coord
ROM:0395 32 1B 20		     ld	     (player_ship_coord_lsb_), a	     ; save
ROM:0398 C3 6F 03		     jp	     ship_coord_updated			     ; done
ROM:039B	     ; ---------------------------------------------------------------------------
ROM:039B
ROM:039B	     handle_ship_explosion:					     ; next explosion #
ROM:039B 3C			     inc     a
ROM:039C E6 01			     and     #1					     ; only 2 of them
ROM:039E 32 15 20		     ld	     (gameplay_ticker),	a		     ; get explosion #
ROM:03A1 07			     rlca
ROM:03A2 07			     rlca
ROM:03A3 07			     rlca
ROM:03A4 07			     rlca					     ; x16
ROM:03A5 21 70 1C		     ld	     hl, #explosion_1			     ; ship explosion #1
ROM:03A8 85			     add     a,	l
ROM:03A9 6F			     ld	     l,	a				     ; hl = ptr	explosion bitmap
ROM:03AA 22 18 20		     ld	     (player_ship_info), hl		     ; store as	player ship bitmap
ROM:03AD C3 6F 03		     jp	     ship_coord_updated
ROM:03B0	     ; ---------------------------------------------------------------------------
ROM:03B0
ROM:03B0	     loc_0_3B0:
ROM:03B0 C2 4A 03		     jp	     NZ, handle_ship
ROM:03B3 23			     inc     hl
ROM:03B4 35			     dec     (hl)
ROM:03B5 C2 4A 03		     jp	     NZ, handle_ship
ROM:03B8 C3 46 03		     jp	     loc_0_346
ROM:03BB	     ; ---------------------------------------------------------------------------
ROM:03BB 11 2A 20		     ld	     de, #player_shot_x_coord		     ; called by jump vector #2
ROM:03BB									     ; player shot x coord
ROM:03BE CD 06 1A		     call    sub_0_1A06
ROM:03C1 E1			     pop     hl
ROM:03C2 D0			     ret     NC
ROM:03C3 23			     inc     hl
ROM:03C4 7E			     ld	     a,	(hl)				     ; get fire	progress state
ROM:03C5 A7			     and     a					     ; firing?
ROM:03C6 C8			     ret     Z					     ; no, exit
ROM:03C7 FE 01			     cp	     #1					     ; just fired?
ROM:03C9 CA FA 03		     jp	     Z,	start_firing_sequence		     ; yes, init firing	sequence
ROM:03CC FE 02			     cp	     #2					     ; bullet in flight?
ROM:03CE CA 0A 04		     jp	     Z,	update_player_shot		     ; yes, handle
ROM:03D1 23			     inc     hl
ROM:03D2 FE 03			     cp	     #3					     ; hit an invader or UFO?
ROM:03D4 C2 2A 04		     jp	     NZ, loc_0_42A			     ; yes, skip
ROM:03D7 35			     dec     (hl)				     ; $2026
ROM:03D8 CA 36 04		     jp	     Z,	loc_0_436
ROM:03DB 7E			     ld	     a,	(hl)				     ; $2026
ROM:03DC FE 0F			     cp	     #15
ROM:03DE C0			     ret     NZ
ROM:03DF E5			     push    hl
ROM:03E0 CD 30 04		     call    get_p_bullet_expl_params
ROM:03E3 CD 52 14		     call    wipe_shifted_bitmap_pixels		     ; ?? only if hit non-invader
ROM:03E6 E1			     pop     hl
ROM:03E7 23			     inc     hl
ROM:03E8 34			     inc     (hl)
ROM:03E9 23			     inc     hl
ROM:03EA 23			     inc     hl
ROM:03EB 35			     dec     (hl)				     ; player shot y coord???
ROM:03EC 35			     dec     (hl)				     ; player shot y coord???
ROM:03ED 23			     inc     hl
ROM:03EE 35			     dec     (hl)
ROM:03EF 35			     dec     (hl)
ROM:03F0 35			     dec     (hl)				     ; ? player	shot x coord???
ROM:03F1 23			     inc     hl
ROM:03F2 36 08			     ld	     (hl), #8
ROM:03F4 CD 30 04		     call    get_p_bullet_expl_params		     ; here if hit non-invader or just as shooting
ROM:03F7 C3 00 14		     jp	     OR_shifted_bitmap_to_vram
ROM:03FA	     ; ---------------------------------------------------------------------------
ROM:03FA
ROM:03FA	     start_firing_sequence:					     ; update shot progress (=2)
ROM:03FA 3C			     inc     a
ROM:03FB 77			     ld	     (hl), a				     ; save
ROM:03FC 3A 1B 20		     ld	     a,	(player_ship_coord_lsb_)	     ; get ship	coord
ROM:03FF C6 08			     add     a,	#8				     ; calc centre coord
ROM:0401 32 2A 20		     ld	     (player_shot_x_coord), a		     ; save bullet x coord
ROM:0404 CD 30 04		     call    get_p_bullet_expl_params
ROM:0407 C3 00 14		     jp	     OR_shifted_bitmap_to_vram
ROM:040A	     ; ---------------------------------------------------------------------------
ROM:040A
ROM:040A	     update_player_shot:
ROM:040A CD 30 04		     call    get_p_bullet_expl_params
ROM:040D D5			     push    de
ROM:040E E5			     push    hl
ROM:040F C5			     push    bc
ROM:0410 CD 52 14		     call    wipe_shifted_bitmap_pixels		     ; wipe player bullet
ROM:0413 C1			     pop     bc
ROM:0414 E1			     pop     hl
ROM:0415 D1			     pop     de
ROM:0416 3A 2C 20		     ld	     a,	(player_shot_y_inc)		     ; bullet movement y offset
ROM:0419 85			     add     a,	l				     ; calc new	screen bullet loc
ROM:041A 6F			     ld	     l,	a
ROM:041B 32 29 20		     ld	     (player_shot_y_coord), a		     ; save new	bullet coord
ROM:041E CD 91 14		     call    draw_and_detect_collision		     ; draw player bullet and see if anything was hit
ROM:0421 3A 61 20		     ld	     a,	(something_hit)
ROM:0424 A7			     and     a					     ; was something hit?
ROM:0425 C8			     ret     Z					     ; no, exit
ROM:0426 32 02 20		     ld	     (player_shot_something), a		     ; flag player having shot something (anything)
ROM:0429 C9			     ret
ROM:042A	     ; ---------------------------------------------------------------------------
ROM:042A
ROM:042A	     loc_0_42A:							     ; finished	firing?
ROM:042A FE 05			     cp	     #5
ROM:042C C8			     ret     Z					     ; yes, exit
ROM:042D C3 36 04		     jp	     loc_0_436				     ; here if hit an invader
ROM:0430
ROM:0430	     ; =============== S U B R O U T I N E =======================================
ROM:0430
ROM:0430
ROM:0430	     get_p_bullet_expl_params:
ROM:0430 21 27 20		     ld	     hl, #obj1_image			     ; ptr player bullet/explosion
ROM:0433 C3 3B 1A		     jp	     extract_DE_HL_B			     ; get graphics object params
ROM:0433	     ; End of function get_p_bullet_expl_params
ROM:0433
ROM:0436	     ; ---------------------------------------------------------------------------
ROM:0436
ROM:0436	     loc_0_436:							     ; extract bullet/explosion	object params
ROM:0436 CD 30 04		     call    get_p_bullet_expl_params
ROM:0439 CD 52 14		     call    wipe_shifted_bitmap_pixels		     ; clear bullet/explosion
ROM:043C 21 25 20		     ld	     hl, #fire_progress_state		     ; fire progress state
ROM:043F 11 25 1B		     ld	     de, # byte_0_1B00+0x25		     ; initialised values
ROM:0442 06 07			     ld	     b,	#7				     ; (re)init	player bullet params
ROM:0444 CD 32 1A		     call    memcpy_hl_de_b_			     ; init 7 bytes
ROM:0447 2A 8D 20		     ld	     hl, (???_counter)			     ; shot counter
ROM:044A 2C			     inc     l					     ; inc
ROM:044B 7D			     ld	     a,	l
ROM:044C FE 63			     cp	     #99				     ; 99 shots?
ROM:044E DA 53 04		     jp	     C,	loc_0_453			     ; no, skip
ROM:0451 2E 54			     ld	     l,	#84				     ; start again from	84
ROM:0453
ROM:0453	     loc_0_453:							     ; save shot counter
ROM:0453 22 8D 20		     ld	     (???_counter), hl
ROM:0456 2A 8F 20		     ld	     hl, (shot_count_lsb)		     ; get address whose b0 determines ufo side
ROM:0459 2C			     inc     l					     ; inc for next time
ROM:045A 22 8F 20		     ld	     (shot_count_lsb), hl		     ; save
ROM:045D 3A 84 20		     ld	     a,	(ufo_visible)			     ; is the ufo already visible?
ROM:0460 A7			     and     a
ROM:0461 C0			     ret     NZ					     ; yes, exit
ROM:0462 7E			     ld	     a,	(hl)				     ; get byte	from ROM code, whose b0
ROM:0462									     ; determines ufo from left/right
ROM:0463 E6 01			     and     #1					     ; from left or right?
ROM:0465 01 29 02		     ld	     bc, #0x229				     ; start at	left edge, x inc = 2
ROM:0468 C2 6E 04		     jp	     NZ, init_ufo_coords		     ; left, skip
ROM:046B 01 E0 FE		     ld	     bc, #0xFEE0			     ; start at	right edge, x inc = -2
ROM:046E
ROM:046E	     init_ufo_coords:						     ; ptr ufo x coord
ROM:046E 21 8A 20		     ld	     hl, #ufo_x
ROM:0471 71			     ld	     (hl), c				     ; set ufo x coord
ROM:0472 23			     inc     hl
ROM:0473 23			     inc     hl					     ; ptr ufo x inc
ROM:0474 70			     ld	     (hl), b				     ; set ufo x inc
ROM:0475 C9			     ret
ROM:0476	     ; ---------------------------------------------------------------------------
ROM:0476 E1			     pop     hl					     ; called by jump vector #3
ROM:0477 3A 32 1B		     ld	     a,	(byte_0_1B00+0x32)
ROM:047A 32 32 20		     ld	     (obj2_timer_extra), a		     ; re-init ?
ROM:047D 2A 38 20		     ld	     hl, (rol_shot_track)
ROM:0480 7D			     ld	     a,	l
ROM:0481 B4			     or	     h
ROM:0482 C2 8A 04		     jp	     NZ, loc_0_48A
ROM:0485 2B			     dec     hl
ROM:0486 22 38 20		     ld	     (rol_shot_track), hl
ROM:0489 C9			     ret
ROM:048A	     ; ---------------------------------------------------------------------------
ROM:048A
ROM:048A	     loc_0_48A:							     ; ptr alien bomb 1	data
ROM:048A 11 35 20		     ld	     de, #alien_bomb_1_data
ROM:048D 3E F9			     ld	     a,	#0xF9 ;	'ù'                          ; lsb of last bomb bitmap in table
ROM:048F CD 50 05		     call    copy_alien_bomb_data_2_curr	     ; copy to current
ROM:0492 3A 46 20		     ld	     a,	(plu_shot_step_cnt)		     ; byte 1 of bomb 2
ROM:0495 32 70 20		     ld	     (other_shot_1), a
ROM:0498 3A 56 20		     ld	     a,	(squ_shot_step_cnt)		     ; byte 1 of bomb 3
ROM:049B 32 71 20		     ld	     (other_shot_2), a
ROM:049E CD 63 05		     call    handle_alien_bombing
ROM:04A1 3A 78 20		     ld	     a,	(a_shot_blow_cnt)		     ; alien bomb explosion timer
ROM:04A4 A7			     and     a
ROM:04A5 21 35 20		     ld	     hl, #alien_bomb_1_data		     ; alien bomb 1 data
ROM:04A8 C2 5B 05		     jp	     NZ, save_curr_alien_bomb_data
ROM:04AB 11 30 1B		     ld	     de, # byte_0_1B00+0x30
ROM:04AE 21 30 20		     ld	     hl, #obj2_timer_msb
ROM:04B1 06 10			     ld	     b,	#0x10				     ; re-init data
ROM:04B3 C3 32 1A		     jp	     memcpy_hl_de_b_
ROM:04B6	     ; ---------------------------------------------------------------------------
ROM:04B6 E1			     pop     hl					     ; called by jump vector #4
ROM:04B6									     ; update alien bomb #2
ROM:04B7 3A 6E 20		     ld	     a,	(skip_plunger)
ROM:04BA A7			     and     a
ROM:04BB C0			     ret     NZ
ROM:04BC 3A 80 20		     ld	     a,	(shot_sync)
ROM:04BF FE 01			     cp	     #1
ROM:04C1 C0			     ret     NZ
ROM:04C2 11 45 20		     ld	     de, #alien_bomb_2_data		     ; ptr alien bomb 2	data
ROM:04C5 3E ED			     ld	     a,	#0xED ;	'í'                          ; lsb of last bomb bitmap in table
ROM:04C7 CD 50 05		     call    copy_alien_bomb_data_2_curr	     ; copy to current
ROM:04CA 3A 36 20		     ld	     a,	(rol_shot_set_cnt)		     ; byte 1 of bomb 1
ROM:04CD 32 70 20		     ld	     (other_shot_1), a
ROM:04D0 3A 56 20		     ld	     a,	(squ_shot_step_cnt)		     ; byte 1 of bomb 3
ROM:04D3 32 71 20		     ld	     (other_shot_2), a
ROM:04D6 CD 63 05		     call    handle_alien_bombing
ROM:04D9 3A 76 20		     ld	     a,	(ptr_bomb_random_table)
ROM:04DC FE 10			     cp	     #16
ROM:04DE DA E7 04		     jp	     C,	loc_0_4E7
ROM:04E1 3A 48 1B		     ld	     a,	(byte_0_1B00+0x48)		     ; (0) re-init ptr bomb random table
ROM:04E4 32 76 20		     ld	     (ptr_bomb_random_table), a
ROM:04E7
ROM:04E7	     loc_0_4E7:							     ; alien bomb explosion timer
ROM:04E7 3A 78 20		     ld	     a,	(a_shot_blow_cnt)
ROM:04EA A7			     and     a
ROM:04EB 21 45 20		     ld	     hl, #alien_bomb_2_data		     ; alien bomb 2 data
ROM:04EE C2 5B 05		     jp	     NZ, save_curr_alien_bomb_data	     ; save current here
ROM:04F1 11 40 1B		     ld	     de, # byte_0_1B00+0x40
ROM:04F4 21 40 20		     ld	     hl, # rol_shot_blow_cnt+6
ROM:04F7 06 10			     ld	     b,	#0x10				     ; re-init 16 bytes
ROM:04F9 CD 32 1A		     call    memcpy_hl_de_b_
ROM:04FC 3A 82 20		     ld	     a,	(num_invaders_left)
ROM:04FF 3D			     dec     a					     ; any invaders left?
ROM:0500 C2 08 05		     jp	     NZ, loc_0_508			     ; yes, skip
ROM:0503 3E 01			     ld	     a,	#1
ROM:0505 32 6E 20		     ld	     (skip_plunger), a
ROM:0508
ROM:0508	     loc_0_508:
ROM:0508 2A 76 20		     ld	     hl, (ptr_bomb_random_table)
ROM:050B C3 7E 06		     jp	     loc_0_67E
ROM:050E	     ; ---------------------------------------------------------------------------
ROM:050E
ROM:050E	     game_obj_4:
ROM:050E E1			     pop     hl
ROM:050F
ROM:050F	     handle_alien_bomb_3:					     ; ptr alien bomb 3	data
ROM:050F 11 55 20		     ld	     de, #alien_bomb_3_data
ROM:0512 3E DB			     ld	     a,	#0xDB ;	'Û'                          ; lsb of last bomb bitmap in table
ROM:0514 CD 50 05		     call    copy_alien_bomb_data_2_curr	     ; copy to current
ROM:0517 3A 46 20		     ld	     a,	(plu_shot_step_cnt)		     ; byte 1 of bomb 2
ROM:051A 32 70 20		     ld	     (other_shot_1), a
ROM:051D 3A 36 20		     ld	     a,	(rol_shot_set_cnt)		     ; byte 1 of bomb 1
ROM:0520 32 71 20		     ld	     (other_shot_2), a
ROM:0523 CD 63 05		     call    handle_alien_bombing
ROM:0526 3A 76 20		     ld	     a,	(ptr_bomb_random_table)		     ; lsb of random bomb table	ptr
ROM:0529 FE 15			     cp	     #0x15
ROM:052B DA 34 05		     jp	     C,	loc_0_534
ROM:052E 3A 58 1B		     ld	     a,	(byte_0_1B00+0x58)		     ; $06 - re-init bomb random table ptr
ROM:0531 32 76 20		     ld	     (ptr_bomb_random_table), a
ROM:0534
ROM:0534	     loc_0_534:							     ; alien bomb explosion timer
ROM:0534 3A 78 20		     ld	     a,	(a_shot_blow_cnt)
ROM:0537 A7			     and     a
ROM:0538 21 55 20		     ld	     hl, #alien_bomb_3_data		     ; ptr alien bomb 3	data
ROM:053B C2 5B 05		     jp	     NZ, save_curr_alien_bomb_data	     ; save curr here
ROM:053E 11 50 1B		     ld	     de, # byte_0_1B00+0x50
ROM:0541 21 50 20		     ld	     hl, # plu_shot_blow_cnt+6
ROM:0544 06 10			     ld	     b,	#0x10				     ; re-init 16 bytes
ROM:0546 CD 32 1A		     call    memcpy_hl_de_b_
ROM:0549 2A 76 20		     ld	     hl, (ptr_bomb_random_table)
ROM:054C 22 58 20		     ld	     (squ_shot_col_fire_tbl), hl
ROM:054F C9			     ret
ROM:0550
ROM:0550	     ; =============== S U B R O U T I N E =======================================
ROM:0550
ROM:0550
ROM:0550	     copy_alien_bomb_data_2_curr:
ROM:0550 32 7F 20		     ld	     (alien_pic_end), a			     ; save lsb	of last	bomb bitmap in table
ROM:0553 21 73 20		     ld	     hl, #curr_alien_bomb_data		     ; ptr curr	alien bomb data	block
ROM:0556 06 0B			     ld	     b,	#0xB				     ; 11 bytes
ROM:0558 C3 32 1A		     jp	     memcpy_hl_de_b_			     ; copy alien bomb data to current
ROM:0558	     ; End of function copy_alien_bomb_data_2_curr
ROM:0558
ROM:055B	     ; ---------------------------------------------------------------------------
ROM:055B
ROM:055B	     save_curr_alien_bomb_data:					     ; ptr curr	alien bomb data
ROM:055B 11 73 20		     ld	     de, #curr_alien_bomb_data
ROM:055E 06 0B			     ld	     b,	#0xB				     ; 11 bytes
ROM:0560 C3 32 1A		     jp	     memcpy_hl_de_b_			     ; save curr bomb data
ROM:0563
ROM:0563	     ; =============== S U B R O U T I N E =======================================
ROM:0563
ROM:0563
ROM:0563	     handle_alien_bombing:
ROM:0563 21 73 20		     ld	     hl, #curr_alien_bomb_data		     ; ptr curr	alien bomb data
ROM:0566 7E			     ld	     a,	(hl)
ROM:0567 E6 80			     and     #0x80 ; '€'                             ; needs updating?
ROM:0569 C2 C1 05		     jp	     NZ, update_alien_bomb		     ; yes, skip
ROM:056C 3A C1 20		     ld	     a,	(animation_type)
ROM:056F FE 04			     cp	     #4					     ; bomb-c animation?
ROM:0571 3A 69 20		     ld	     a,	(enable_alien_fire)		     ; ??? some	sort of	randomizer?
ROM:0574 CA B7 05		     jp	     Z,	flag_bomb_needs_update		     ; yes, handle
ROM:0577 A7			     and     a
ROM:0578 C8			     ret     Z
ROM:0579 23			     inc     hl					     ; $2074
ROM:057A 36 00			     ld	     (hl), #0				     ; == $2074	for other bomb #1
ROM:057C 3A 70 20		     ld	     a,	(other_shot_1)
ROM:057F A7			     and     a
ROM:0580 CA 89 05		     jp	     Z,	handle_start_alien_bomb
ROM:0583 47			     ld	     b,	a
ROM:0584 3A CF 20		     ld	     a,	(bomb_frequency)
ROM:0587 B8			     cp	     b					     ; time to drop another bomb?
ROM:0588 D0			     ret     NC					     ; no, exit
ROM:0589
ROM:0589	     handle_start_alien_bomb:					     ; == $2074	of other bomb #2
ROM:0589 3A 71 20		     ld	     a,	(other_shot_2)
ROM:058C A7			     and     a
ROM:058D CA 96 05		     jp	     Z,	loc_0_596
ROM:0590 47			     ld	     b,	a
ROM:0591 3A CF 20		     ld	     a,	(bomb_frequency)
ROM:0594 B8			     cp	     b					     ; time to drop another bomb?
ROM:0595 D0			     ret     NC					     ; no, exit
ROM:0596
ROM:0596	     loc_0_596:							     ; $2075
ROM:0596 23			     inc     hl
ROM:0597 7E			     ld	     a,	(hl)
ROM:0598 A7			     and     a
ROM:0599 CA 1B 06		     jp	     Z,	decide_invader_to_bomb
ROM:059C 2A 76 20		     ld	     hl, (ptr_bomb_random_table)	     ; ptr into	random table for bomb dropping
ROM:059F 4E			     ld	     c,	(hl)				     ; get invader column to drop bomb
ROM:05A0 23			     inc     hl					     ; next entry
ROM:05A1 00			     nop
ROM:05A2 22 76 20		     ld	     (ptr_bomb_random_table), hl	     ; save it
ROM:05A5
ROM:05A5	     loc_0_5A5:							     ; is there	an invader left	in this	column?
ROM:05A5 CD 2F 06		     call    is_invader_left_in_column_c_
ROM:05A8 D0			     ret     NC					     ; no, exit
ROM:05A9 CD 7A 01		     call    get_alien_coords			     ; l = index in invader map
ROM:05AC 79			     ld	     a,	c				     ; x coord
ROM:05AD C6 07			     add     a,	#7				     ; adjust to middle	of invader
ROM:05AF 67			     ld	     h,	a
ROM:05B0 7D			     ld	     a,	l				     ; y coord
ROM:05B1 D6 0A			     sub     #10				     ; bomb starts just	below invader
ROM:05B3 6F			     ld	     l,	a
ROM:05B4 22 7B 20		     ld	     (alien_bomb_screen_loc), hl	     ; init alien bomb screen loc
ROM:05B7
ROM:05B7	     flag_bomb_needs_update:					     ; ptr curr	alien bomb info
ROM:05B7 21 73 20		     ld	     hl, #curr_alien_bomb_data
ROM:05BA 7E			     ld	     a,	(hl)
ROM:05BB F6 80			     or	     #0x80 ; '€'                             ; flag bomb requires updating
ROM:05BD 77			     ld	     (hl), a
ROM:05BE 23			     inc     hl
ROM:05BF 34			     inc     (hl)				     ; ??? bomb	life counter?
ROM:05C0 C9			     ret
ROM:05C1	     ; ---------------------------------------------------------------------------
ROM:05C1
ROM:05C1	     update_alien_bomb:						     ; msb of alien bomb vram addr
ROM:05C1 11 7C 20		     ld	     de, # alien_bomb_screen_loc+1
ROM:05C4 CD 06 1A		     call    sub_0_1A06
ROM:05C7 D0			     ret     NC
ROM:05C8 23			     inc     hl					     ; $2073 - ptr curr	alien bomb data
ROM:05C9 7E			     ld	     a,	(hl)
ROM:05CA E6 01			     and     #1					     ; aliens already hit something?
ROM:05CC C2 44 06		     jp	     NZ, explode_alien_bomb		     ; yes, skip
ROM:05CF 23			     inc     hl					     ; $2074
ROM:05D0 34			     inc     (hl)				     ; ??? bomb	life counter?
ROM:05D1 CD 75 06		     call    wipe_alien_bomb
ROM:05D4 3A 79 20		     ld	     a,	(alien_bomb_bitmap_addr)	     ; bitmap address lsb
ROM:05D7 C6 03			     add     a,	#3				     ; next bomb bitmap
ROM:05D9 21 7F 20		     ld	     hl, #alien_pic_end			     ; lsb of last bitmap address in table
ROM:05DC BE			     cp	     (hl)				     ; past end	of table?
ROM:05DD DA E2 05		     jp	     C,	loc_0_5E2			     ; no, skip
ROM:05E0 D6 0C			     sub     #0xC				     ; reset bitmap to start of	table
ROM:05E2
ROM:05E2	     loc_0_5E2:							     ; save bitmap lsb address
ROM:05E2 32 79 20		     ld	     (alien_bomb_bitmap_addr), a
ROM:05E5 3A 7B 20		     ld	     a,	(alien_bomb_screen_loc)		     ; bomb y coordinate
ROM:05E8 47			     ld	     b,	a
ROM:05E9 3A 7E 20		     ld	     a,	(alien_bomb_y_inc)		     ; get number y coord offset
ROM:05EC 80			     add     a,	b				     ; update y	coord
ROM:05ED 32 7B 20		     ld	     (alien_bomb_screen_loc), a		     ; save
ROM:05F0 CD 6C 06		     call    draw_and_test_alien_bomb		     ; draw invader bomb
ROM:05F3 3A 7B 20		     ld	     a,	(alien_bomb_screen_loc)		     ; bomb y coord
ROM:05F6 FE 15			     cp	     #0x15				     ; too low to hit player?
ROM:05F8 DA 12 06		     jp	     C,	loc_0_612			     ; yes, exit
ROM:05FB 3A 61 20		     ld	     a,	(something_hit)
ROM:05FE A7			     and     a					     ; was something hit?
ROM:05FF C8			     ret     Z					     ; no, exit
ROM:0600 3A 7B 20		     ld	     a,	(alien_bomb_screen_loc)		     ; bomb y coord
ROM:0603 FE 1E			     cp	     #0x1E				     ; level with player ship?
ROM:0605 DA 12 06		     jp	     C,	loc_0_612			     ; no, exit
ROM:0608 FE 27			     cp	     #0x27 ; '''                             ; hit a base?
ROM:060A 00			     nop
ROM:060B D2 12 06		     jp	     NC, loc_0_612			     ; yes, exit
ROM:060E 97			     sub     a					     ; player ship has been hit
ROM:060F 32 15 20		     ld	     (gameplay_ticker),	a
ROM:0612
ROM:0612	     loc_0_612:
ROM:0612 3A 73 20		     ld	     a,	(curr_alien_bomb_data)
ROM:0615 F6 01			     or	     #1					     ; flag aliens hit something
ROM:0617 32 73 20		     ld	     (curr_alien_bomb_data), a
ROM:061A C9			     ret
ROM:061B	     ; ---------------------------------------------------------------------------
ROM:061B
ROM:061B	     decide_invader_to_bomb:					     ; get coord of player ship
ROM:061B 3A 1B 20		     ld	     a,	(player_ship_coord_lsb_)
ROM:061E C6 08			     add     a,	#8				     ; get coord of middle
ROM:0620 67			     ld	     h,	a				     ; save
ROM:0621 CD 6F 15		     call    find_hit_invader_column		     ; ??? some	sort of	randomiser based on ship coord
ROM:0624 79			     ld	     a,	c				     ; get chosen column
ROM:0625 FE 0C			     cp	     #12				     ; valid range (column 1-11)?
ROM:0627 DA A5 05		     jp	     C,	loc_0_5A5			     ; yes, skip
ROM:062A 0E 0B			     ld	     c,	#11				     ; column 11 to drop bomb
ROM:062C C3 A5 05		     jp	     loc_0_5A5				     ; return
ROM:062C	     ; End of function handle_alien_bombing
ROM:062C
ROM:062F
ROM:062F	     ; =============== S U B R O U T I N E =======================================
ROM:062F
ROM:062F
ROM:062F	     is_invader_left_in_column_c_:
ROM:062F 0D			     dec     c					     ; column number to	drop bomb
ROM:0630 3A 67 20		     ld	     a,	(ptr_curr_player_data)		     ; get ptr player data
ROM:0633 67			     ld	     h,	a
ROM:0634 69			     ld	     l,	c				     ; hl = ptr	top row	invader	in chosen column
ROM:0635 16 05			     ld	     d,	#5				     ; 5 rows of invaders
ROM:0637
ROM:0637	     loc_0_637:							     ; get invader
ROM:0637 7E			     ld	     a,	(hl)
ROM:0638 A7			     and     a					     ; alive?
ROM:0639
ROM:0639	     loc_0_639:
ROM:0639 37			     scf
ROM:063A C0			     ret     NZ					     ; yes, exit
ROM:063B 7D			     ld	     a,	l
ROM:063C C6 0B			     add     a,	#11				     ; 11 invaders/row
ROM:063E 6F			     ld	     l,	a				     ; ptr next	row of invaders
ROM:063F 15			     dec     d					     ; done all	rows?
ROM:0640 C2 37 06		     jp	     NZ, loc_0_637			     ; no, loop
ROM:0643 C9			     ret
ROM:0643	     ; End of function is_invader_left_in_column_c_
ROM:0643
ROM:0644	     ; ---------------------------------------------------------------------------
ROM:0644
ROM:0644	     explode_alien_bomb:					     ; alien bomb explosion timer
ROM:0644 21 78 20		     ld	     hl, #a_shot_blow_cnt
ROM:0647 35			     dec     (hl)				     ; tick down
ROM:0648 7E			     ld	     a,	(hl)
ROM:0649 FE 03			     cp	     #3					     ; only starting to	explode?
ROM:064B C2 67 06		     jp	     NZ, test_end_alien_bomb_explosion	     ; no, skip
ROM:064E CD 75 06		     call    wipe_alien_bomb
ROM:0651 21 DC 1C		     ld	     hl, #0x1CDC			     ; ptr bitmap for explosion
ROM:0654 22 79 20		     ld	     (alien_bomb_bitmap_addr), hl	     ; save it as bomb bitmap
ROM:0657 21 7C 20		     ld	     hl, # alien_bomb_screen_loc+1	     ; bomb x coord
ROM:065A 35			     dec     (hl)
ROM:065B 35			     dec     (hl)				     ; move left 2 pixels (for wider bitmap)
ROM:065C 2B			     dec     hl					     ; bomb y coord
ROM:065D 35			     dec     (hl)
ROM:065E 35			     dec     (hl)				     ; move up 2 pixels	(for taller bitmap)
ROM:065F 3E 06			     ld	     a,	#6				     ; set explosion bitmap length
ROM:0661 32 7D 20		     ld	     (alien_bomb_bitmap_length), a	     ; save as bomb bitmap length
ROM:0664 C3 6C 06		     jp	     draw_and_test_alien_bomb
ROM:0667	     ; ---------------------------------------------------------------------------
ROM:0667
ROM:0667	     test_end_alien_bomb_explosion:				     ; time to end explosion?
ROM:0667 A7			     and     a
ROM:0668 C0			     ret     NZ					     ; no, return
ROM:0669 C3 75 06		     jp	     wipe_alien_bomb
ROM:066C
ROM:066C	     ; =============== S U B R O U T I N E =======================================
ROM:066C
ROM:066C
ROM:066C	     draw_and_test_alien_bomb:
ROM:066C 21 79 20		     ld	     hl, #alien_bomb_bitmap_addr	     ; ptr alien bomb object
ROM:066F CD 3B 1A		     call    extract_DE_HL_B			     ; extract bomb object parameters
ROM:0672 C3 91 14		     jp	     draw_and_detect_collision
ROM:0672	     ; End of function draw_and_test_alien_bomb
ROM:0672
ROM:0675
ROM:0675	     ; =============== S U B R O U T I N E =======================================
ROM:0675
ROM:0675
ROM:0675	     wipe_alien_bomb:
ROM:0675 21 79 20		     ld	     hl, #alien_bomb_bitmap_addr	     ; ptr alien bomb object
ROM:0678 CD 3B 1A		     call    extract_DE_HL_B			     ; extract bomb object parameters
ROM:067B C3 52 14		     jp	     wipe_shifted_bitmap_pixels
ROM:067B	     ; End of function wipe_alien_bomb
ROM:067B
ROM:067E	     ; ---------------------------------------------------------------------------
ROM:067E
ROM:067E	     loc_0_67E:
ROM:067E 22 48 20		     ld	     (plu_shot_col_fire_tbl), hl
ROM:0681 C9			     ret
ROM:0682	     ; ---------------------------------------------------------------------------
ROM:0682 E1			     pop     hl					     ; called by jump vector #5
ROM:0683 3A 80 20		     ld	     a,	(shot_sync)
ROM:0686 FE 02			     cp	     #2
ROM:0688 C0			     ret     NZ
ROM:0689 21 83 20		     ld	     hl, #time_for_ufo			     ; ptr flag	time for ufo
ROM:068C 7E			     ld	     a,	(hl)
ROM:068D A7			     and     a					     ; is it time for the ufo to appear?
ROM:068E CA 0F 05		     jp	     Z,	handle_alien_bomb_3		     ; no, skip
ROM:0691 3A 56 20		     ld	     a,	(squ_shot_step_cnt)
ROM:0694 A7			     and     a
ROM:0695 C2 0F 05		     jp	     NZ, handle_alien_bomb_3
ROM:0698 23			     inc     hl
ROM:0699 7E			     ld	     a,	(hl)				     ; ptr ufo visible flag
ROM:069A A7			     and     a					     ; is the ufo already visible?
ROM:069B C2 AB 06		     jp	     NZ, loc_0_6AB			     ; yes, skip
ROM:069E 3A 82 20		     ld	     a,	(num_invaders_left)
ROM:06A1 FE 08			     cp	     #8					     ; less than 8 invaders left?
ROM:06A3 DA 0F 05		     jp	     C,	handle_alien_bomb_3		     ; yes, don't allow it to appear
ROM:06A6 36 01			     ld	     (hl), #1				     ; flag ufo	visible
ROM:06A8 CD 3C 07		     call    draw_ufo				     ; draw UFO
ROM:06AB
ROM:06AB	     loc_0_6AB:							     ; ufo x coordinate
ROM:06AB 11 8A 20		     ld	     de, #ufo_x
ROM:06AE CD 06 1A		     call    sub_0_1A06
ROM:06B1 D0			     ret     NC
ROM:06B2 21 85 20		     ld	     hl, #ufo_hit			     ; ptr ufo hit flag
ROM:06B5 7E			     ld	     a,	(hl)
ROM:06B6 A7			     and     a					     ; has the ufo been	hit?
ROM:06B7 C2 D6 06		     jp	     NZ, handle_ufo_hit			     ; yes, handle
ROM:06BA 21 8A 20		     ld	     hl, #ufo_x				     ; object screen loc x
ROM:06BD 7E			     ld	     a,	(hl)
ROM:06BE 23			     inc     hl
ROM:06BF 23			     inc     hl					     ; ptr object x move offset
ROM:06C0 86			     add     a,	(hl)				     ; calc new	x coord
ROM:06C1 32 8A 20		     ld	     (ufo_x), a				     ; update object x coord
ROM:06C4 CD 3C 07		     call    draw_ufo				     ; draw UFO
ROM:06C7 21 8A 20		     ld	     hl, #ufo_x				     ; object screen loc x
ROM:06CA 7E			     ld	     a,	(hl)				     ; get screen loc
ROM:06CB FE 28			     cp	     #40				     ; lh edge of screen?
ROM:06CD DA F9 06		     jp	     C,	wipe_ufo			     ; yes, wipe it
ROM:06D0 FE E1			     cp	     #225				     ; rhs of screen?
ROM:06D2 D2 F9 06		     jp	     NC, wipe_ufo			     ; yes, wipe it
ROM:06D5 C9			     ret
ROM:06D6	     ; ---------------------------------------------------------------------------
ROM:06D6
ROM:06D6	     handle_ufo_hit:						     ; mask out	ufo sound
ROM:06D6 06 FE			     ld	     b,	#0xFE ;	'þ'
ROM:06D8 CD DC 19		     call    stop_port3_sound			     ; stop ufo	sound
ROM:06DB 23			     inc     hl					     ; ptr countdown after ufo hit (init=32)
ROM:06DC 35			     dec     (hl)				     ; count down
ROM:06DD 7E			     ld	     a,	(hl)
ROM:06DE FE 1F			     cp	     #31				     ; time to explode?
ROM:06E0 CA 4B 07		     jp	     Z,	handle_ufo_explosion		     ; yes, handle
ROM:06E3 FE 18			     cp	     #24				     ; time to show score?
ROM:06E5 CA 0C 07		     jp	     Z,	handle_ufo_score		     ; yes, handle
ROM:06E8 A7			     and     a					     ; countdown finished?
ROM:06E9 C0			     ret     NZ					     ; no, exit
ROM:06EA 06 EF			     ld	     b,	#0xEF ;	'ï'                          ; mask out ufo hit sound
ROM:06EC 21 98 20		     ld	     hl, #port_5_sound_shadow_reg	     ; port 5 sound register shadow
ROM:06EF 7E			     ld	     a,	(hl)
ROM:06F0 A0			     and     b					     ; turn off	ufo hit	sound
ROM:06F1 77			     ld	     (hl), a				     ; save
ROM:06F2 E6 20			     and     #0x20 ; ' '                             ; only screen flip bit
ROM:06F4 D3 05			     out     (5), a				     ; set screen flip
ROM:06F6 00			     nop
ROM:06F7 00			     nop
ROM:06F8 00			     nop
ROM:06F9
ROM:06F9	     wipe_ufo:							     ; calc ufo	text score params
ROM:06F9 CD 42 07		     call    calc_vram_ufo
ROM:06FC CD CB 14		     call    clear_small_sprite			     ; clear ufo text score
ROM:06FF 21 83 20		     ld	     hl, #time_for_ufo			     ; ptr ufo data
ROM:0702 06 0A			     ld	     b,	#10				     ; re-init 10 bytes
ROM:0704 CD 5F 07		     call    re_init_ufo_data			     ; re-init ufo data
ROM:0707
ROM:0707	     stop_ufo_sound:						     ; mask out	ufo sound
ROM:0707 06 FE			     ld	     b,	#0xFE ;	'þ'
ROM:0709 C3 DC 19		     jp	     stop_port3_sound			     ; stop ufo	sound
ROM:070C	     ; ---------------------------------------------------------------------------
ROM:070C
ROM:070C	     handle_ufo_score:						     ; set flag	that score needs updating
ROM:070C 3E 01			     ld	     a,	#1
ROM:070E 32 F1 20		     ld	     (any_points_to_add), a
ROM:0711 2A 8D 20		     ld	     hl, (???_counter)
ROM:0714 46			     ld	     b,	(hl)				     ; b = ??? counter
ROM:0715 0E 04			     ld	     c,	#4				     ; 4 entries in table
ROM:0717 21 50 1D		     ld	     hl, #byte_0_1D50			     ; table of	ufo score text strings
ROM:071A 11 4C 1D		     ld	     de, #ufo_score_tbl			     ; table of	UFO scores
ROM:071D
ROM:071D	     loc_0_71D:							     ; lookup table
ROM:071D 1A			     ld	     a,	(de)
ROM:071E B8			     cp	     b					     ; had this	many shots yet?
ROM:071F CA 28 07		     jp	     Z,	loc_0_728			     ; yes, skip
ROM:0722 23			     inc     hl
ROM:0723 13			     inc     de					     ; next entry
ROM:0724 0D			     dec     c					     ; any entries left?
ROM:0725 C2 1D 07		     jp	     NZ, loc_0_71D			     ; yes, loop
ROM:0728
ROM:0728	     loc_0_728:							     ; get lsb of score	string address
ROM:0728 7E			     ld	     a,	(hl)
ROM:0729 32 87 20		     ld	     (ptr_ufo_bitmap), a		     ; save it
ROM:072C 26 00			     ld	     h,	#0
ROM:072E 68			     ld	     l,	b				     ; hl = ???	count
ROM:072F 29			     add     hl, hl
ROM:0730 29			     add     hl, hl
ROM:0731 29			     add     hl, hl
ROM:0732 29			     add     hl, hl				     ; x16 = X10 (BCD)
ROM:0733 22 F2 20		     ld	     (points_to_add), hl		     ; save points to add to score
ROM:0736 CD 42 07		     call    calc_vram_ufo			     ; calculate screen	loc for	text score
ROM:0739 C3 F1 08		     jp	     draw_str_hl_de_3_			     ; draw it and exit
ROM:073C
ROM:073C	     ; =============== S U B R O U T I N E =======================================
ROM:073C
ROM:073C
ROM:073C	     draw_ufo:
ROM:073C CD 42 07		     call    calc_vram_ufo
ROM:073F C3 39 14		     jp	     draw_simp_sprite
ROM:073F	     ; End of function draw_ufo
ROM:073F
ROM:0742
ROM:0742	     ; =============== S U B R O U T I N E =======================================
ROM:0742
ROM:0742
ROM:0742	     calc_vram_ufo:
ROM:0742 21 87 20		     ld	     hl, #ptr_ufo_bitmap
ROM:0745 CD 3B 1A		     call    extract_DE_HL_B
ROM:0748 C3 47 1A		     jp	     calc_vram_addr_from_pixel_offset
ROM:0748	     ; End of function calc_vram_ufo
ROM:0748
ROM:074B	     ; ---------------------------------------------------------------------------
ROM:074B
ROM:074B	     handle_ufo_explosion:					     ; saucer hit sound
ROM:074B 06 10			     ld	     b,	#0x10
ROM:074D 21 98 20		     ld	     hl, #port_5_sound_shadow_reg	     ; port 5 sound shadow reg
ROM:0750 7E			     ld	     a,	(hl)
ROM:0751 B0			     or	     b					     ; mix in saucer hit
ROM:0752 77			     ld	     (hl), a				     ; save
ROM:0753 CD 70 17		     call    start_stop_ufo_hit_sound
ROM:0756 21 7C 1D		     ld	     hl, #byte_0_1D7C			     ; ptr ufo explosion bitmap
ROM:0759 22 87 20		     ld	     (ptr_ufo_bitmap), hl		     ; set ufo bitmap address
ROM:075C C3 3C 07		     jp	     draw_ufo				     ; draw it
ROM:075F
ROM:075F	     ; =============== S U B R O U T I N E =======================================
ROM:075F
ROM:075F
ROM:075F	     re_init_ufo_data:
ROM:075F 11 83 1B		     ld	     de, #ufo_init_data			     ; ptr ufo data
ROM:0762 C3 32 1A		     jp	     memcpy_hl_de_b_
ROM:0762	     ; End of function re_init_ufo_data
ROM:0762
ROM:0765	     ; ---------------------------------------------------------------------------
ROM:0765
ROM:0765	     show_PUSH_PLAYER_BUTTON:					     ; set coined up flag so NMI doesn't re-enter
ROM:0765 3E 01			     ld	     a,	#1
ROM:0767 32 93 20		     ld	     (coined_up), a
ROM:076A 31 00 24		     ld	     sp, #vram				     ; forget the fact that we were...
ROM:076D FB			     ei						     ; inside an NMI
ROM:076E CD 79 19		     call    draw_credit_display
ROM:0771 CD D6 09		     call    clear_visible_display
ROM:0774 21 13 30		     ld	     hl, # vram+0xC13			     ; screen loc
ROM:0777 11 F3 1F		     ld	     de, #aPUSH				     ; "PUSH"
ROM:077A 0E 04			     ld	     c,	#4				     ; length
ROM:077C CD F3 08		     call    draw_str_hl_de_
ROM:077F
ROM:077F	     wait_start_button:
ROM:077F 3A EB 20		     ld	     a,	(num_credits)
ROM:0782 3D			     dec     a
ROM:0783 21 10 28		     ld	     hl, # vram+0x410			     ; screen loc
ROM:0786 0E 14			     ld	     c,	#0x14				     ; length
ROM:0788 C2 57 08		     jp	     NZ, show_1_2_PLAYERS_BUTTON	     ; >1 credit - skip
ROM:078B 11 CF 1A		     ld	     de, #message_1_only		     ; "ONLY 1PLAYER BUTTON"
ROM:078E CD F3 08		     call    draw_str_hl_de_
ROM:0791 DB 01			     in	     a,	(1)				     ; read controller 1
ROM:0793 E6 04			     and     #4					     ; 1P start?
ROM:0795 CA 7F 07		     jp	     Z,	wait_start_button		     ; no - loop
ROM:0798
ROM:0798	     start_1p:							     ; (BCD)-1
ROM:0798 06 99			     ld	     b,	#0x99 ;	'™'
ROM:079A AF			     xor     a					     ; 1 player
ROM:079B
ROM:079B	     start_playing:						     ; num players - 1
ROM:079B 32 CE 20		     ld	     (two_p_game), a
ROM:079E 3A EB 20		     ld	     a,	(num_credits)			     ; get credits
ROM:07A1 80			     add     a,	b				     ; sub 1 (bcd arithmetic)
ROM:07A2 27			     daa
ROM:07A3 32 EB 20		     ld	     (num_credits), a			     ; save credits
ROM:07A6 CD 47 19		     call    draw_credits
ROM:07A9 21 00 00		     ld	     hl, #0
ROM:07AC 22 F8 20		     ld	     (p1_score), hl			     ; init p1 score
ROM:07AF 22 FC 20		     ld	     (p2_score), hl			     ; init p2 score
ROM:07B2 CD 25 19		     call    draw_p1_score
ROM:07B5 CD 2B 19		     call    draw_p2_score
ROM:07B8 CD D7 19		     call    disable_vblank_code
ROM:07BB 21 01 01		     ld	     hl, #0x101				     ; some flag initialisers
ROM:07BE 7C			     ld	     a,	h
ROM:07BF 32 EF 20		     ld	     (game_in_progress), a		     ; set game	in progress
ROM:07C2 22 E7 20		     ld	     (num_men_p1), hl			     ; init for	both p1	& p2
ROM:07C5 22 E5 20		     ld	     (yet_to_earn_bonus_ship), hl	     ; flag bonus not yet earnt	and &&&
ROM:07C8 CD 56 19		     call    update_screen_text			     ; draw all	the text on the	screen
ROM:07CB CD EF 01		     call    init_p1_shields			     ; copy fresh shields from ROM
ROM:07CE CD F5 01		     call    init_p2_shields			     ; copy fresh shields from ROM
ROM:07D1 CD D1 08		     call    read_num_lives_from_dips
ROM:07D4 32 FF 21		     ld	     (p1_ships_left), a			     ; init p1 ships
ROM:07D7 32 FF 22		     ld	     (p2_ships_left), a			     ; init p2 ships
ROM:07DA CD D7 00		     call    init_invader_xinc_wipe_2p_score	     ; bl invader coords, x inc
ROM:07DD AF			     xor     a					     ; set wave=0
ROM:07DE 32 FE 21		     ld	     (p1_wave_number), a		     ; init p1 wave
ROM:07E1 32 FE 22		     ld	     (p2_wave_number), a		     ; init p2 wave
ROM:07E4 CD C0 01		     call    init_p1_invader_map
ROM:07E7 CD 04 19		     call    init_p2_invader_map
ROM:07EA 21 78 38		     ld	     hl, # vram+0x1478			     ; 56, 120
ROM:07ED 22 FC 21		     ld	     (p1_bl_invader_coords), hl		     ; init p1 bl invader coords
ROM:07F0 22 FC 22		     ld	     (p2_bl_invader_coords), hl		     ; init p2 bl invader coords
ROM:07F3 CD E4 01		     call    init_vars_192
ROM:07F6 CD 7F 1A		     call    show_ships_left
ROM:07F9
ROM:07F9	     start_player_new_ship:
ROM:07F9 CD 8D 08		     call    show_PLAY_PLAYER
ROM:07FC CD D6 09		     call    clear_visible_display
ROM:07FF 00			     nop
ROM:0800 AF			     xor     a					     ; reset animation
ROM:0801 32 C1 20		     ld	     (animation_type), a
ROM:0804
ROM:0804	     start_player_new_ship_2:
ROM:0804 CD CF 01		     call    draw_base_line
ROM:0807 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:080A 0F			     rrca					     ; player 1?
ROM:080B DA 72 08		     jp	     C,	loc_0_872			     ; no, skip
ROM:080E CD 13 02		     call    draw_p2_shields			     ; draw p2 shields
ROM:0811 CD CF 01		     call    draw_base_line			     ; again?!?
ROM:0814
ROM:0814	     loc_0_814:							     ; bl invader coords, x inc
ROM:0814 CD B1 00		     call    restore_invader_params
ROM:0817
ROM:0817	     loc_0_817:
ROM:0817 CD D1 19		     call    do_enable_vblank_code
ROM:081A 06 20			     ld	     b,	#0x20 ;	' '                          ; not documented/handled in MAME!
ROM:081C CD FA 18		     call    start_port3_sound
ROM:081F
ROM:081F	     player_playing_loop:
ROM:081F CD 18 16		     call    poll_fire_button
ROM:0822 CD 0A 19		     call    update_player_bullet_invader_dir	     ; handle firing and invader direction
ROM:0825 CD F3 15		     call    count_invaders_left
ROM:0828 CD 88 09		     call    update_score_and_draw		     ; update score
ROM:082B 3A 82 20		     ld	     a,	(num_invaders_left)
ROM:082E A7			     and     a					     ; any invaders left?
ROM:082F CA EF 09		     jp	     Z,	end_of_wave			     ; no, handle end of wave
ROM:0832 CD 0E 17		     call    update_bomb_frequency
ROM:0835 CD 35 09		     call    handle_bonus_ship
ROM:0838 CD D8 08		     call    check_and_update_bomb_speed	     ; speed up	bombs if <9 invaders
ROM:083B CD 2C 17		     call    start_stop_shot_sound
ROM:083E CD 59 0A		     call    check_player_hit			     ; player been hit?
ROM:0841 CA 49 08		     jp	     Z,	player_not_hit			     ; no, skip
ROM:0844 06 04			     ld	     b,	#4				     ; base hit	sound
ROM:0846 CD FA 18		     call    start_port3_sound
ROM:0849
ROM:0849	     player_not_hit:
ROM:0849 CD 75 17		     call    check_update_invader_sound
ROM:084C D3 06			     out     (6), a				     ; not document/implemented	in MAME!
ROM:084E CD 04 18		     call    start_stop_ufo_sound
ROM:0851 C3 1F 08		     jp	     player_playing_loop
ROM:0854	     ; ---------------------------------------------------------------------------
ROM:0854 00			     nop
ROM:0855 00			     nop
ROM:0856 00			     nop
ROM:0857
ROM:0857	     show_1_2_PLAYERS_BUTTON:					     ; "1 OR 2PLAYERS BUTTON"
ROM:0857 11 BA 1A		     ld	     de, #message_b_1_or_2
ROM:085A CD F3 08		     call    draw_str_hl_de_
ROM:085D 06 98			     ld	     b,	#0x98 ;	'˜'
ROM:085F DB 01			     in	     a,	(1)				     ; read controller 1
ROM:0861 0F			     rrca
ROM:0862 0F			     rrca					     ; 2P start?
ROM:0863 DA 6D 08		     jp	     C,	start_2p			     ; yes - jump
ROM:0866 0F			     rrca					     ; 1P start?
ROM:0867 DA 98 07		     jp	     C,	start_1p			     ; yes - jump
ROM:086A C3 7F 07		     jp	     wait_start_button
ROM:086D	     ; ---------------------------------------------------------------------------
ROM:086D
ROM:086D	     start_2p:							     ; 2 players
ROM:086D 3E 01			     ld	     a,	#1
ROM:086F C3 9B 07		     jp	     start_playing
ROM:0872	     ; ---------------------------------------------------------------------------
ROM:0872
ROM:0872	     loc_0_872:
ROM:0872 CD 1A 02		     call    draw_p1_shields
ROM:0875 C3 14 08		     jp	     loc_0_814
ROM:0878
ROM:0878	     ; =============== S U B R O U T I N E =======================================
ROM:0878
ROM:0878
ROM:0878	     get_curr_and_player_invader_coor:
ROM:0878 3A 08 20		     ld	     a,	(invader_x_inc)
ROM:087B 47			     ld	     b,	a				     ; b = invader x inc
ROM:087C 2A 09 20		     ld	     hl, (bottom_left_invader_y)
ROM:087F EB			     ex	     de, hl				     ; de = bottom left	invader	coords
ROM:0880 C3 86 08		     jp	     ptr_curr_p_bl_invader_coords
ROM:0880	     ; End of function get_curr_and_player_invader_coor
ROM:0880
ROM:0883	     ; ---------------------------------------------------------------------------
ROM:0883 00			     nop
ROM:0884 00			     nop
ROM:0885 00			     nop
ROM:0886
ROM:0886	     ; =============== S U B R O U T I N E =======================================
ROM:0886
ROM:0886
ROM:0886	     ptr_curr_p_bl_invader_coords:
ROM:0886 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:0889 67			     ld	     h,	a
ROM:088A 2E FC			     ld	     l,	#0xFC ;	'ü'                          ; ptr player bl invader coords
ROM:088C C9			     ret
ROM:088C	     ; End of function ptr_curr_p_bl_invader_coords
ROM:088C
ROM:088D
ROM:088D	     ; =============== S U B R O U T I N E =======================================
ROM:088D
ROM:088D
ROM:088D	     show_PLAY_PLAYER:
ROM:088D 21 11 2B		     ld	     hl, # vram+0x711			     ; screen loc
ROM:0890 11 70 1B		     ld	     de, #aPLAYPLAYER1			     ; "PLAY PLAYER<1>"
ROM:0893 0E 0E			     ld	     c,	#14				     ; string length
ROM:0895 CD F3 08		     call    draw_str_hl_de_			     ; show it
ROM:0898 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:089B 0F			     rrca
ROM:089C 3E 1C			     ld	     a,	#0x1C				     ; "2"
ROM:089E 21 11 37		     ld	     hl, # vram+0x1311			     ; screen loc
ROM:08A1 D4 FF 08		     call    NC, draw_char			     ; over-write with "2" if p2
ROM:08A4 3E B0			     ld	     a,	#176				     ; set timer to 176
ROM:08A6 32 C0 20		     ld	     (isr_delay), a
ROM:08A9
ROM:08A9	     flash_score:
ROM:08A9 3A C0 20		     ld	     a,	(isr_delay)
ROM:08AC A7			     and     a					     ; done?
ROM:08AD C8			     ret     Z					     ; yes, exit
ROM:08AE E6 04			     and     #4					     ; draw blank or score?
ROM:08B0 C2 BC 08		     jp	     NZ, blank_score			     ; blank, skip
ROM:08B3 CD CA 09		     call    get_ptr_curr_score
ROM:08B6 CD 31 19		     call    draw_bcd_word_from_table
ROM:08B9 C3 A9 08		     jp	     flash_score
ROM:08BC	     ; ---------------------------------------------------------------------------
ROM:08BC
ROM:08BC	     blank_score:
ROM:08BC 06 20			     ld	     b,	#0x20 ;	' '
ROM:08BE 21 1C 27		     ld	     hl, # vram+0x31C			     ; p1 score	screen loc
ROM:08C1 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:08C4 0F			     rrca					     ; p1?
ROM:08C5 DA CB 08		     jp	     C,	loc_0_8CB			     ; yes, skip
ROM:08C8 21 1C 39		     ld	     hl, # vram+0x151C			     ; p2 score	screen loc
ROM:08CB
ROM:08CB	     loc_0_8CB:							     ; blank score
ROM:08CB CD CB 14		     call    clear_small_sprite
ROM:08CE C3 A9 08		     jp	     flash_score
ROM:08CE	     ; End of function show_PLAY_PLAYER
ROM:08CE
ROM:08D1
ROM:08D1	     ; =============== S U B R O U T I N E =======================================
ROM:08D1
ROM:08D1
ROM:08D1	     read_num_lives_from_dips:
ROM:08D1 DB 02			     in	     a,	(2)				     ; read dipswitches
ROM:08D3 E6 03			     and     #3					     ; only interested in number of lives
ROM:08D5 C6 03			     add     a,	#3				     ; calc number of lives
ROM:08D7 C9			     ret
ROM:08D7	     ; End of function read_num_lives_from_dips
ROM:08D7
ROM:08D8
ROM:08D8	     ; =============== S U B R O U T I N E =======================================
ROM:08D8
ROM:08D8
ROM:08D8	     check_and_update_bomb_speed:
ROM:08D8 3A 82 20		     ld	     a,	(num_invaders_left)
ROM:08DB FE 09			     cp	     #9					     ; more than 8 invaders left?
ROM:08DD D0			     ret     NC					     ; yes, exit
ROM:08DE 3E FB			     ld	     a,	#0xFB ;	'û'                          ; set alien bombs to 5 pixels/inc
ROM:08E0 32 7E 20		     ld	     (alien_bomb_y_inc), a		     ; save
ROM:08E3 C9			     ret
ROM:08E3	     ; End of function check_and_update_bomb_speed
ROM:08E3
ROM:08E4	     ; ---------------------------------------------------------------------------
ROM:08E4
ROM:08E4	     wipe_2p_score:
ROM:08E4 3A CE 20		     ld	     a,	(two_p_game)
ROM:08E7 A7			     and     a					     ; 2 players?
ROM:08E8 C0			     ret     NZ					     ; no, exit
ROM:08E9 21 1C 39		     ld	     hl, # vram+0x151C			     ; screen loc
ROM:08EC 06 20			     ld	     b,	#32				     ; 32 chars
ROM:08EE C3 CB 14		     jp	     clear_small_sprite
ROM:08F1	     ; ---------------------------------------------------------------------------
ROM:08F1
ROM:08F1	     draw_str_hl_de_3_:
ROM:08F1 0E 03			     ld	     c,	#3
ROM:08F3
ROM:08F3	     ; =============== S U B R O U T I N E =======================================
ROM:08F3
ROM:08F3
ROM:08F3	     draw_str_hl_de_:
ROM:08F3 1A			     ld	     a,	(de)				     ; get char
ROM:08F4 D5			     push    de
ROM:08F5 CD FF 08		     call    draw_char
ROM:08F8 D1			     pop     de
ROM:08F9 13			     inc     de
ROM:08FA 0D			     dec     c					     ; dec length
ROM:08FB C2 F3 08		     jp	     NZ, draw_str_hl_de_		     ; not done	- loop
ROM:08FE C9			     ret
ROM:08FE	     ; End of function draw_str_hl_de_
ROM:08FE
ROM:08FF
ROM:08FF	     ; =============== S U B R O U T I N E =======================================
ROM:08FF
ROM:08FF
ROM:08FF	     draw_char:
ROM:08FF 11 00 1E		     ld	     de, #bitmap_table			     ; char bitmap
ROM:0902 E5			     push    hl					     ; save screen loc
ROM:0903 26 00			     ld	     h,	#0
ROM:0905 6F			     ld	     l,	a
ROM:0906 29			     add     hl, hl
ROM:0907 29			     add     hl, hl
ROM:0908 29			     add     hl, hl				     ; char * 8
ROM:0909 19			     add     hl, de				     ; ptr char	bitmap
ROM:090A EB			     ex	     de, hl				     ; de = ptr	char bitmap
ROM:090B E1			     pop     hl					     ; restore screen loc
ROM:090C 06 08			     ld	     b,	#8
ROM:090E D3 06			     out     (6), a
ROM:0910 C3 39 14		     jp	     draw_simp_sprite
ROM:0910	     ; End of function draw_char
ROM:0910
ROM:0913
ROM:0913	     ; =============== S U B R O U T I N E =======================================
ROM:0913
ROM:0913
ROM:0913	     handle_next_ufo_timer:
ROM:0913 3A 09 20		     ld	     a,	(bottom_left_invader_y)		     ; get y coord of bl invader
ROM:0916 FE 78			     cp	     #120				     ; moved down at least once?
ROM:0918 D0			     ret     NC					     ; no, exit
ROM:0919 2A 91 20		     ld	     hl, (next_ufo_timer)
ROM:091C 7D			     ld	     a,	l
ROM:091D B4			     or	     h					     ; is it time for the next ufo?
ROM:091E C2 29 09		     jp	     NZ, next_ufo_tick			     ; no, skip
ROM:0921 21 00 06		     ld	     hl, #0x600
ROM:0924 3E 01			     ld	     a,	#1				     ; flag the	ufo as visible
ROM:0926 32 83 20		     ld	     (time_for_ufo), a
ROM:0929
ROM:0929	     next_ufo_tick:						     ; next ufo	timer tick
ROM:0929 2B			     dec     hl
ROM:092A 22 91 20		     ld	     (next_ufo_timer), hl		     ; save
ROM:092D C9			     ret
ROM:092D	     ; End of function handle_next_ufo_timer
ROM:092D
ROM:092E
ROM:092E	     ; =============== S U B R O U T I N E =======================================
ROM:092E
ROM:092E
ROM:092E	     get_curr_player_num_ships:
ROM:092E CD 11 16		     call    set_hl_ptr_curr_player_data
ROM:0931 2E FF			     ld	     l,	#0xFF				     ; ptr curr	player num ships
ROM:0933 7E			     ld	     a,	(hl)				     ; curr player num ships
ROM:0934 C9			     ret
ROM:0934	     ; End of function get_curr_player_num_ships
ROM:0934
ROM:0935
ROM:0935	     ; =============== S U B R O U T I N E =======================================
ROM:0935
ROM:0935
ROM:0935	     handle_bonus_ship:
ROM:0935 CD 10 19		     call    set_hl_num_ships_curr_player
ROM:0938 2B			     dec     hl
ROM:0939 2B			     dec     hl
ROM:093A 7E			     ld	     a,	(hl)				     ; bonus earnt flag
ROM:093B A7			     and     a					     ; already got it?
ROM:093C C8			     ret     Z					     ; yes, exit
ROM:093D 06 15			     ld	     b,	#0x15				     ; bonus high byte (1500)
ROM:093F DB 02			     in	     a,	(2)				     ; read dipswitches
ROM:0941 E6 08			     and     #8					     ; bonus life setting
ROM:0943 CA 48 09		     jp	     Z,	loc_0_948			     ; bonus @1500 - skip
ROM:0946 06 10			     ld	     b,	#0x10				     ; bonus high byte (1000)
ROM:0948
ROM:0948	     loc_0_948:
ROM:0948 CD CA 09		     call    get_ptr_curr_score
ROM:094B 23			     inc     hl					     ; ptr score
ROM:094C 7E			     ld	     a,	(hl)				     ; get high	byte
ROM:094D B8			     cp	     b					     ; bonus?
ROM:094E D8			     ret     C					     ; no - return
ROM:094F CD 2E 09		     call    get_curr_player_num_ships
ROM:0952 34			     inc     (hl)				     ; add an extra ship
ROM:0953 7E			     ld	     a,	(hl)				     ; number of ships
ROM:0954 F5			     push    af
ROM:0955 21 01 25		     ld	     hl, # vram+0x101			     ; screen loc
ROM:0958
ROM:0958	     loc_0_958:
ROM:0958 24			     inc     h
ROM:0959 24			     inc     h					     ; leave 2 pixels
ROM:095A 3D			     dec     a					     ; next ship
ROM:095B C2 58 09		     jp	     NZ, loc_0_958			     ; calc where to draw extra	ship
ROM:095E 06 10			     ld	     b,	#0x10				     ; bitmap size
ROM:0960 11 60 1C		     ld	     de, #base				     ; player ship
ROM:0963 CD 39 14		     call    draw_simp_sprite			     ; draw extra ship
ROM:0966 F1			     pop     af
ROM:0967 3C			     inc     a					     ; digit includes ship currently playing
ROM:0968 CD 8B 1A		     call    prt_num_ships_left
ROM:096B CD 10 19		     call    set_hl_num_ships_curr_player
ROM:096E 2B			     dec     hl
ROM:096F 2B			     dec     hl
ROM:0970 36 00			     ld	     (hl), #0				     ; flag already got	bonus
ROM:0972 3E FF			     ld	     a,	#0xFF				     ; init bonus ship sound timer
ROM:0974 32 99 20		     ld	     (bonus_ship_sound_timer), a
ROM:0977 06 10			     ld	     b,	#0x10				     ; bonus ship sound
ROM:0979 C3 FA 18		     jp	     start_port3_sound
ROM:0979	     ; End of function handle_bonus_ship
ROM:0979
ROM:097C
ROM:097C	     ; =============== S U B R O U T I N E =======================================
ROM:097C
ROM:097C
ROM:097C	     get_invader_point_value:
ROM:097C 21 A0 1D		     ld	     hl, #invader_points_table		     ; ptr invader score
ROM:097F FE 02			     cp	     #2					     ; row < 2?
ROM:0981 D8			     ret     C					     ; yes, return (10 pts)
ROM:0982 23			     inc     hl					     ; next score
ROM:0983 FE 04			     cp	     #4					     ; row < 4?
ROM:0985 D8			     ret     C					     ; yes, return (20 pts)
ROM:0986 23			     inc     hl					     ; 30 pts
ROM:0987 C9			     ret
ROM:0987	     ; End of function get_invader_point_value
ROM:0987
ROM:0988
ROM:0988	     ; =============== S U B R O U T I N E =======================================
ROM:0988
ROM:0988
ROM:0988	     update_score_and_draw:
ROM:0988 CD CA 09		     call    get_ptr_curr_score
ROM:098B 3A F1 20		     ld	     a,	(any_points_to_add)
ROM:098E A7			     and     a					     ; are there any points to add to score?
ROM:098F C8			     ret     Z					     ; no, exit
ROM:0990 AF			     xor     a					     ; flag that we've added the points
ROM:0991 32 F1 20		     ld	     (any_points_to_add), a		     ; save
ROM:0994 E5			     push    hl					     ; save ptr	score
ROM:0995 2A F2 20		     ld	     hl, (points_to_add)
ROM:0998 EB			     ex	     de, hl				     ; de = value to add to score
ROM:0999 E1			     pop     hl					     ; ptr score
ROM:099A 7E			     ld	     a,	(hl)				     ; score B0
ROM:099B 83			     add     a,	e				     ; add value B0
ROM:099C 27			     daa
ROM:099D 77			     ld	     (hl), a				     ; save score B0
ROM:099E 5F			     ld	     e,	a				     ; e = score B0
ROM:099F 23			     inc     hl
ROM:09A0 7E			     ld	     a,	(hl)				     ; score B1
ROM:09A1 8A			     adc     a,	d				     ; add value B1
ROM:09A2 27			     daa
ROM:09A3 77			     ld	     (hl), a				     ; save score B1
ROM:09A4 57			     ld	     d,	a				     ; d = score B1
ROM:09A5 23			     inc     hl
ROM:09A6 7E			     ld	     a,	(hl)				     ; score screen loc	lsb
ROM:09A7 23			     inc     hl
ROM:09A8 66			     ld	     h,	(hl)				     ; score screen loc	msb
ROM:09A9 6F			     ld	     l,	a				     ; hl = score screen loc
ROM:09AA C3 AD 09		     jp	     draw_bcd_word_de_			     ; draw score
ROM:09AD
ROM:09AD	     draw_bcd_word_de_:
ROM:09AD 7A			     ld	     a,	d
ROM:09AE CD B2 09		     call    draw_bcd_byte_a_
ROM:09B1 7B			     ld	     a,	e
ROM:09B1	     ; End of function update_score_and_draw
ROM:09B1
ROM:09B2
ROM:09B2	     ; =============== S U B R O U T I N E =======================================
ROM:09B2
ROM:09B2
ROM:09B2	     draw_bcd_byte_a_:
ROM:09B2 D5			     push    de
ROM:09B3 F5			     push    af
ROM:09B4 0F			     rrca
ROM:09B5 0F			     rrca
ROM:09B6 0F			     rrca
ROM:09B7 0F			     rrca					     ; high nibble
ROM:09B8 E6 0F			     and     #0xF
ROM:09BA CD C5 09		     call    draw_ascii_digit
ROM:09BD F1			     pop     af
ROM:09BE E6 0F			     and     #0xF				     ; low nibble
ROM:09C0 CD C5 09		     call    draw_ascii_digit
ROM:09C3 D1			     pop     de
ROM:09C4 C9			     ret
ROM:09C4	     ; End of function draw_bcd_byte_a_
ROM:09C4
ROM:09C5
ROM:09C5	     ; =============== S U B R O U T I N E =======================================
ROM:09C5
ROM:09C5
ROM:09C5	     draw_ascii_digit:
ROM:09C5 C6 1A			     add     a,	#0x1A				     ; convert digit to	'ascii'
ROM:09C7 C3 FF 08		     jp	     draw_char
ROM:09C7	     ; End of function draw_ascii_digit
ROM:09C7
ROM:09CA
ROM:09CA	     ; =============== S U B R O U T I N E =======================================
ROM:09CA
ROM:09CA
ROM:09CA	     get_ptr_curr_score:
ROM:09CA 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:09CD 0F			     rrca
ROM:09CE 21 F8 20		     ld	     hl, #p1_score			     ; p1 score
ROM:09D1 D8			     ret     C					     ; return if p1
ROM:09D2 21 FC 20		     ld	     hl, #p2_score			     ; p2 score
ROM:09D5 C9			     ret
ROM:09D5	     ; End of function get_ptr_curr_score
ROM:09D5
ROM:09D6
ROM:09D6	     ; =============== S U B R O U T I N E =======================================
ROM:09D6
ROM:09D6
ROM:09D6	     clear_visible_display:
ROM:09D6 21 02 24		     ld	     hl, # vram+2			     ; start of	visible	area
ROM:09D9
ROM:09D9	     clear_to_eos:						     ; clear video ram byte
ROM:09D9 36 00			     ld	     (hl), #0
ROM:09DB 23			     inc     hl					     ; next loc
ROM:09DC 7D			     ld	     a,	l
ROM:09DD E6 1F			     and     #0x1F
ROM:09DF FE 1C			     cp	     #0x1C				     ; end of line?
ROM:09E1 DA E8 09		     jp	     C,	loc_0_9E8			     ; no, skip
ROM:09E4 11 06 00		     ld	     de, #6
ROM:09E7 19			     add     hl, de				     ; unused video ram
ROM:09E8
ROM:09E8	     loc_0_9E8:
ROM:09E8 7C			     ld	     a,	h
ROM:09E9 FE 40			     cp	     #0x40 ; '@'                             ; end of video ram?
ROM:09EB DA D9 09		     jp	     C,	clear_to_eos			     ; no, loop
ROM:09EE C9			     ret
ROM:09EE	     ; End of function clear_visible_display
ROM:09EE
ROM:09EF	     ; ---------------------------------------------------------------------------
ROM:09EF
ROM:09EF	     end_of_wave:
ROM:09EF CD 3C 0A		     call    wait_4_timer_after_gameplay_tick
ROM:09F2 AF			     xor     a					     ; disable vblank code
ROM:09F3 32 E9 20		     ld	     (enable_vblank_code), a
ROM:09F6 CD D6 09		     call    clear_visible_display		     ; clear screen
ROM:09F9 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:09FC F5			     push    af
ROM:09FD CD E4 01		     call    init_vars_192			     ; init data for new wave
ROM:0A00 F1			     pop     af
ROM:0A01 32 67 20		     ld	     (ptr_curr_player_data), a
ROM:0A04 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:0A07 67			     ld	     h,	a
ROM:0A08 E5			     push    hl					     ; save curr player
ROM:0A09 2E FE			     ld	     l,	#0xFE ;	'þ'                          ; ptr wave number
ROM:0A0B 7E			     ld	     a,	(hl)				     ; get curr	wave number
ROM:0A0C E6 07			     and     #7					     ; resets every 8 waves
ROM:0A0E 3C			     inc     a					     ; next wave
ROM:0A0F 77			     ld	     (hl), a				     ; save
ROM:0A10 21 A2 1D		     ld	     hl, #unk_0_1DA2			     ; ptr table of starting invader y coords
ROM:0A13
ROM:0A13	     loc_0_A13:
ROM:0A13 23			     inc     hl
ROM:0A14 3D			     dec     a
ROM:0A15 C2 13 0A		     jp	     NZ, loc_0_A13			     ; find entry for this wave
ROM:0A18 7E			     ld	     a,	(hl)				     ; get starting invader y coord
ROM:0A19 E1			     pop     hl					     ; restore curr player
ROM:0A1A 2E FC			     ld	     l,	#0xFC ;	'ü'                          ; ptr curr player bl invader coords
ROM:0A1C 77			     ld	     (hl), a				     ; set bl invader y	coord from table
ROM:0A1D 23			     inc     hl
ROM:0A1E 36 38			     ld	     (hl), #56				     ; init bl invader x coord
ROM:0A20 7C			     ld	     a,	h				     ; curr player
ROM:0A21 0F			     rrca					     ; player 1?
ROM:0A22 DA 33 0A		     jp	     C,	init_p1_shields_map		     ; yes, skip
ROM:0A25 3E 21			     ld	     a,	#0x21 ;	'!'                          ; fleet #1 and screen flip
ROM:0A27 32 98 20		     ld	     (port_5_sound_shadow_reg),	a	     ; save
ROM:0A2A CD F5 01		     call    init_p2_shields
ROM:0A2D CD 04 19		     call    init_p2_invader_map
ROM:0A30 C3 04 08		     jp	     start_player_new_ship_2
ROM:0A33	     ; ---------------------------------------------------------------------------
ROM:0A33
ROM:0A33	     init_p1_shields_map:
ROM:0A33 CD EF 01		     call    init_p1_shields
ROM:0A36 CD C0 01		     call    init_p1_invader_map
ROM:0A39 C3 04 08		     jp	     start_player_new_ship_2
ROM:0A3C
ROM:0A3C	     ; =============== S U B R O U T I N E =======================================
ROM:0A3C
ROM:0A3C
ROM:0A3C	     wait_4_timer_after_gameplay_tick:
ROM:0A3C CD 59 0A		     call    check_player_hit
ROM:0A3F C2 52 0A		     jp	     NZ, wait_for_gameplay_tick
ROM:0A42 3E 30			     ld	     a,	#48
ROM:0A44 32 C0 20		     ld	     (isr_delay), a
ROM:0A47
ROM:0A47	     loc_0_A47:
ROM:0A47 3A C0 20		     ld	     a,	(isr_delay)
ROM:0A4A A7			     and     a					     ; expired?
ROM:0A4B C8			     ret     Z					     ; yes, exit
ROM:0A4C CD 59 0A		     call    check_player_hit
ROM:0A4F CA 47 0A		     jp	     Z,	loc_0_A47
ROM:0A52
ROM:0A52	     wait_for_gameplay_tick:
ROM:0A52 CD 59 0A		     call    check_player_hit
ROM:0A55 C2 52 0A		     jp	     NZ, wait_for_gameplay_tick
ROM:0A58 C9			     ret
ROM:0A58	     ; End of function wait_4_timer_after_gameplay_tick
ROM:0A58
ROM:0A59
ROM:0A59	     ; =============== S U B R O U T I N E =======================================
ROM:0A59
ROM:0A59
ROM:0A59	     check_player_hit:
ROM:0A59 3A 15 20		     ld	     a,	(gameplay_ticker)
ROM:0A5C FE FF			     cp	     #0xFF				     ; $FF = player OK (zero flag set)
ROM:0A5E C9			     ret
ROM:0A5E	     ; End of function check_player_hit
ROM:0A5E
ROM:0A5F
ROM:0A5F	     ; =============== S U B R O U T I N E =======================================
ROM:0A5F
ROM:0A5F
ROM:0A5F	     get_score_for_invader:
ROM:0A5F 3A EF 20		     ld	     a,	(game_in_progress)
ROM:0A62 A7			     and     a					     ; game in progress?
ROM:0A63 CA 7C 0A		     jp	     Z,	loc_0_A7C			     ; no, skip	(be silent)
ROM:0A66 48			     ld	     c,	b				     ; c = invader row
ROM:0A67 06 08			     ld	     b,	#8				     ; invader hit sound
ROM:0A69 CD FA 18		     call    start_port3_sound			     ; play sound depending on invader type
ROM:0A6C 41			     ld	     b,	c
ROM:0A6D 78			     ld	     a,	b				     ; a = invader row
ROM:0A6E CD 7C 09		     call    get_invader_point_value
ROM:0A71 7E			     ld	     a,	(hl)				     ; get invader point value
ROM:0A72 21 F3 20		     ld	     hl, # points_to_add+1		     ; ptr points to add (msb)
ROM:0A75 36 00			     ld	     (hl), #0				     ; set msb = 0
ROM:0A77 2B			     dec     hl					     ; ptr lsb
ROM:0A78 77			     ld	     (hl), a				     ; set number of points for	invader
ROM:0A79 2B			     dec     hl					     ; ptr any points to add
ROM:0A7A 36 01			     ld	     (hl), #1				     ; flag that score needs updating
ROM:0A7C
ROM:0A7C	     loc_0_A7C:							     ; ptr invader graphics object
ROM:0A7C 21 62 20		     ld	     hl, #exp_alien
ROM:0A7F C9			     ret
ROM:0A7F	     ; End of function get_score_for_invader
ROM:0A7F
ROM:0A80
ROM:0A80	     ; =============== S U B R O U T I N E =======================================
ROM:0A80
ROM:0A80
ROM:0A80	     animate:
ROM:0A80 3E 02			     ld	     a,	#2				     ; invader animation
ROM:0A82 32 C1 20		     ld	     (animation_type), a
ROM:0A85
ROM:0A85	     wait_for_animation_loop:
ROM:0A85 D3 06			     out     (6), a
ROM:0A87 3A CB 20		     ld	     a,	(animation_finished)
ROM:0A8A A7			     and     a					     ; has the animation finished?
ROM:0A8B CA 85 0A		     jp	     Z,	wait_for_animation_loop		     ; no, loop
ROM:0A8E AF			     xor     a					     ; reset animation
ROM:0A8F 32 C1 20		     ld	     (animation_type), a
ROM:0A92 C9			     ret
ROM:0A92	     ; End of function animate
ROM:0A92
ROM:0A93
ROM:0A93	     ; =============== S U B R O U T I N E =======================================
ROM:0A93
ROM:0A93
ROM:0A93	     print_message_del:
ROM:0A93 D5			     push    de
ROM:0A94 1A			     ld	     a,	(de)				     ; get char
ROM:0A95 CD FF 08		     call    draw_char
ROM:0A98 D1			     pop     de
ROM:0A99 3E 07			     ld	     a,	#7
ROM:0A9B 32 C0 20		     ld	     (isr_delay), a
ROM:0A9E
ROM:0A9E	     @1$:
ROM:0A9E 3A C0 20		     ld	     a,	(isr_delay)
ROM:0AA1 3D			     dec     a
ROM:0AA2 C2 9E 0A		     jp	     NZ, @1$				     ; delay
ROM:0AA5 13			     inc     de					     ; next char
ROM:0AA6 0D			     dec     c					     ; done?
ROM:0AA7 C2 93 0A		     jp	     NZ, print_message_del		     ; no - loop
ROM:0AAA C9			     ret
ROM:0AAA	     ; End of function print_message_del
ROM:0AAA
ROM:0AAB	     ; ---------------------------------------------------------------------------
ROM:0AAB
ROM:0AAB	     update_bomb_c_animation:
ROM:0AAB 21 50 20		     ld	     hl, # plu_shot_blow_cnt+6
ROM:0AAE C3 4B 02		     jp	     dispatch_jump_vector
ROM:0AB1
ROM:0AB1	     ; =============== S U B R O U T I N E =======================================
ROM:0AB1
ROM:0AB1
ROM:0AB1	     one_sec_delay:
ROM:0AB1 3E 40			     ld	     a,	#0x40 ;	'@'
ROM:0AB3 C3 D7 0A		     jp	     delay_a_
ROM:0AB3	     ; End of function one_sec_delay
ROM:0AB3
ROM:0AB6
ROM:0AB6	     ; =============== S U B R O U T I N E =======================================
ROM:0AB6
ROM:0AB6
ROM:0AB6	     two_sec_delay:
ROM:0AB6 3E 80			     ld	     a,	#0x80 ;	'€'
ROM:0AB8 C3 D7 0A		     jp	     delay_a_
ROM:0AB8	     ; End of function two_sec_delay
ROM:0AB8
ROM:0ABB	     ; ---------------------------------------------------------------------------
ROM:0ABB
ROM:0ABB	     update_demo:
ROM:0ABB E1			     pop     hl
ROM:0ABC C3 72 00		     jp	     loc_0_72
ROM:0ABF
ROM:0ABF	     ; =============== S U B R O U T I N E =======================================
ROM:0ABF
ROM:0ABF
ROM:0ABF	     update_attract_animations:
ROM:0ABF 3A C1 20		     ld	     a,	(animation_type)
ROM:0AC2 0F			     rrca					     ; demo animation?
ROM:0AC3 DA BB 0A		     jp	     C,	update_demo			     ; yes, handle
ROM:0AC6 0F			     rrca					     ; invader animation?
ROM:0AC7 DA 68 18		     jp	     C,	update_animated_invader		     ; yes, handle
ROM:0ACA 0F			     rrca					     ; bomb-c animation?
ROM:0ACB DA AB 0A		     jp	     C,	update_bomb_c_animation		     ; yes, handle
ROM:0ACE C9			     ret
ROM:0ACE	     ; End of function update_attract_animations
ROM:0ACE
ROM:0ACF
ROM:0ACF	     ; =============== S U B R O U T I N E =======================================
ROM:0ACF
ROM:0ACF
ROM:0ACF	     draw_SPACE__INVADERS:
ROM:0ACF 21 14 2B		     ld	     hl, # vram+0x714			     ; screen loc
ROM:0AD2 0E 0F			     ld	     c,	#0xF				     ; length
ROM:0AD4 C3 93 0A		     jp	     print_message_del
ROM:0AD4	     ; End of function draw_SPACE__INVADERS
ROM:0AD4
ROM:0AD7	     ; ---------------------------------------------------------------------------
ROM:0AD7
ROM:0AD7	     delay_a_:
ROM:0AD7 32 C0 20		     ld	     (isr_delay), a
ROM:0ADA
ROM:0ADA	     delay_loop:
ROM:0ADA 3A C0 20		     ld	     a,	(isr_delay)
ROM:0ADD A7			     and     a					     ; done?
ROM:0ADE C2 DA 0A		     jp	     NZ, delay_loop			     ; no - loop
ROM:0AE1 C9			     ret
ROM:0AE2
ROM:0AE2	     ; =============== S U B R O U T I N E =======================================
ROM:0AE2
ROM:0AE2
ROM:0AE2	     init_splash_ani:
ROM:0AE2 21 C2 20		     ld	     hl, #animation_frame_count		     ; invader animation data
ROM:0AE5 06 0C			     ld	     b,	#0xC				     ; 12 bytes	of data
ROM:0AE7 C3 32 1A		     jp	     memcpy_hl_de_b_			     ; init
ROM:0AE7	     ; End of function init_splash_ani
ROM:0AE7
ROM:0AEA	     ; ---------------------------------------------------------------------------
ROM:0AEA
ROM:0AEA	     attract_mode_loop:
ROM:0AEA AF			     xor     a
ROM:0AEB D3 03			     out     (3), a				     ; turn off	all sound
ROM:0AED D3 05			     out     (5), a				     ; turn off	all sound
ROM:0AEF CD 82 19		     call    set_animation_type			     ; reset animation
ROM:0AF2 FB			     ei
ROM:0AF3 CD B1 0A		     call    one_sec_delay
ROM:0AF6 3A EC 20		     ld	     a,	(splash_animate)
ROM:0AF9 A7			     and     a					     ; show inverted-y animation?
ROM:0AFA 21 17 30		     ld	     hl, # vram+0xC17			     ; screen loc
ROM:0AFD 0E 04			     ld	     c,	#4				     ; length
ROM:0AFF C2 E8 0B		     jp	     NZ, draw_PLAY			     ; no, skip
ROM:0B02 11 FA 1C		     ld	     de, #message_play_UY		     ; "PLAY" with inverted Y
ROM:0B05 CD 93 0A		     call    print_message_del
ROM:0B08 11 AF 1D		     ld	     de, #message_invaders		     ; "SPACE  INVADERS"
ROM:0B0B
ROM:0B0B	     show_inverted_y_animation:
ROM:0B0B CD CF 0A		     call    draw_SPACE__INVADERS
ROM:0B0E CD B1 0A		     call    one_sec_delay
ROM:0B11 CD 15 18		     call    draw_adv_table
ROM:0B14 CD B6 0A		     call    two_sec_delay
ROM:0B17 3A EC 20		     ld	     a,	(splash_animate)
ROM:0B1A A7			     and     a					     ; show inverted-Y animation?
ROM:0B1B C2 4A 0B		     jp	     NZ, init_demo_player_data		     ; no, skip
ROM:0B1E 11 95 1A		     ld	     de, #byte_0_1A95			     ; ptr inverted-Y animation	pt.1 data
ROM:0B21 CD E2 0A		     call    init_splash_ani			     ; init animation
ROM:0B24 CD 80 0A		     call    animate
ROM:0B27 11 B0 1B		     ld	     de, #byte_0_1BB0			     ; ptr inverted-Y animation	pt.2 data
ROM:0B2A CD E2 0A		     call    init_splash_ani			     ; init animation
ROM:0B2D CD 80 0A		     call    animate
ROM:0B30 CD B1 0A		     call    one_sec_delay
ROM:0B33 11 C9 1F		     ld	     de, #byte_0_1FC9			     ; ptr inverted-Y animation	pt.3 data
ROM:0B36 CD E2 0A		     call    init_splash_ani			     ; init animation
ROM:0B39 CD 80 0A		     call    animate
ROM:0B3C CD B1 0A		     call    one_sec_delay
ROM:0B3F 21 B7 33		     ld	     hl, # vram+0xFB7			     ; screen loc of animated invader
ROM:0B42 06 0A			     ld	     b,	#10				     ; bitmap size
ROM:0B44 CD CB 14		     call    clear_small_sprite			     ; wipe invader
ROM:0B47 CD B6 0A		     call    two_sec_delay
ROM:0B4A
ROM:0B4A	     init_demo_player_data:
ROM:0B4A CD D6 09		     call    clear_visible_display
ROM:0B4D 3A FF 21		     ld	     a,	(p1_ships_left)
ROM:0B50 A7			     and     a					     ; has player number of ships been initialised yet?
ROM:0B51 C2 5D 0B		     jp	     NZ, init_demo_game_data		     ; yes, skip initialisation
ROM:0B54 CD D1 08		     call    read_num_lives_from_dips
ROM:0B57 32 FF 21		     ld	     (p1_ships_left), a			     ; initialise player number	of ships
ROM:0B5A CD 7F 1A		     call    show_ships_left			     ; show them
ROM:0B5D
ROM:0B5D	     init_demo_game_data:					     ; initialise player variables
ROM:0B5D CD E4 01		     call    init_vars_192
ROM:0B60 CD C0 01		     call    init_p1_invader_map		     ; initialise map of invaders
ROM:0B63 CD EF 01		     call    init_p1_shields			     ; initialise shields in memory
ROM:0B66 CD 1A 02		     call    draw_p1_shields			     ; draw them
ROM:0B69 3E 01			     ld	     a,	#1				     ; demo animation
ROM:0B6B 32 C1 20		     ld	     (animation_type), a
ROM:0B6E CD CF 01		     call    draw_base_line			     ; draw pristine base line
ROM:0B71
ROM:0B71	     attract_tick_loop_1:					     ; also controls demo logic	inputs
ROM:0B71 CD 18 16		     call    poll_fire_button
ROM:0B74 CD F1 0B		     call    update_p_bullet_inv_dir_chk_east
ROM:0B77 D3 06			     out     (6), a
ROM:0B79 CD 59 0A		     call    check_player_hit			     ; next tick of the	game timer?
ROM:0B7C CA 71 0B		     jp	     Z,	attract_tick_loop_1		     ; no, loop
ROM:0B7F AF			     xor     a
ROM:0B80 32 25 20		     ld	     (fire_progress_state), a
ROM:0B83
ROM:0B83	     attract_tick_loop_2:
ROM:0B83 CD 59 0A		     call    check_player_hit
ROM:0B86 C2 83 0B		     jp	     NZ, attract_tick_loop_2
ROM:0B89
ROM:0B89	     attract_tick_loop_3:					     ; reset animation
ROM:0B89 AF			     xor     a
ROM:0B8A 32 C1 20		     ld	     (animation_type), a
ROM:0B8D CD B1 0A		     call    one_sec_delay
ROM:0B90 CD 88 19		     call    j_clear_visible_display		     ; clear visible display
ROM:0B93 0E 0C			     ld	     c,	#0xC				     ; length
ROM:0B95 21 11 2C		     ld	     hl, # vram+0x811			     ; screen loc
ROM:0B98 11 90 1F		     ld	     de, #aINSERTCOIN			     ; "INSERT	COIN"
ROM:0B9B CD F3 08		     call    draw_str_hl_de_			     ; show it
ROM:0B9E 3A EC 20		     ld	     a,	(splash_animate)
ROM:0BA1 FE 00			     cp	     #0					     ; show animations?
ROM:0BA3 C2 AE 0B		     jp	     NZ, loc_0_BAE			     ; no, skip
ROM:0BA6 21 11 33		     ld	     hl, # vram+0xF11			     ; screen loc
ROM:0BA9 3E 02			     ld	     a,	#2				     ; "C"
ROM:0BAB CD FF 08		     call    draw_char
ROM:0BAE
ROM:0BAE	     loc_0_BAE:							     ; table "<1 OR 2 PLAYERS>"
ROM:0BAE 01 9C 1F		     ld	     bc, #credit_tbl
ROM:0BB1 CD 56 18		     call    lookup_hl_de_at_bc			     ; get screen loc, text
ROM:0BB4 CD 4C 18		     call    draw_str_varlen
ROM:0BB7 DB 02			     in	     a,	(2)				     ; read dipswitches
ROM:0BB9 07			     rlca					     ; coin info
ROM:0BBA DA C3 0B		     jp	     C,	loc_0_BC3			     ; no coin info - skip
ROM:0BBD 01 A0 1F		     ld	     bc, #0x1FA0			     ; table of	coin info msgs
ROM:0BC0 CD 3A 18		     call    draw_multistr_varlen
ROM:0BC3
ROM:0BC3	     loc_0_BC3:
ROM:0BC3 CD B6 0A		     call    two_sec_delay
ROM:0BC6 3A EC 20		     ld	     a,	(splash_animate)
ROM:0BC9 FE 00			     cp	     #0					     ; do bomb-c animation?
ROM:0BCB C2 DA 0B		     jp	     NZ, toggle_attract_state_and_cls	     ; no, skip
ROM:0BCE 11 D5 1F		     ld	     de, #splash_anim_4			     ; ptr bomb-c animation data
ROM:0BD1 CD E2 0A		     call    init_splash_ani			     ; init animation
ROM:0BD4 CD 80 0A		     call    animate
ROM:0BD7 CD 9E 18		     call    animate_bomb_c_dropping
ROM:0BDA
ROM:0BDA	     toggle_attract_state_and_cls:				     ; get attract mode	state
ROM:0BDA 21 EC 20		     ld	     hl, #splash_animate
ROM:0BDD 7E			     ld	     a,	(hl)
ROM:0BDE 3C			     inc     a					     ; next state
ROM:0BDF E6 01			     and     #1					     ; only 2 valid states
ROM:0BE1 77			     ld	     (hl), a				     ; save
ROM:0BE2 CD D6 09		     call    clear_visible_display
ROM:0BE5 C3 DF 18		     jp	     set_max_bomb_frequency
ROM:0BE8	     ; ---------------------------------------------------------------------------
ROM:0BE8
ROM:0BE8	     draw_PLAY:							     ; "PLAY"
ROM:0BE8 11 AB 1D		     ld	     de, #aPLAYSPACEINVADERS
ROM:0BEB CD 93 0A		     call    print_message_del
ROM:0BEE C3 0B 0B		     jp	     show_inverted_y_animation
ROM:0BF1
ROM:0BF1	     ; =============== S U B R O U T I N E =======================================
ROM:0BF1
ROM:0BF1
ROM:0BF1	     update_p_bullet_inv_dir_chk_east:
ROM:0BF1 CD 0A 19		     call    update_player_bullet_invader_dir
ROM:0BF4 C3 9A 19		     jp	     check_TAITO_easter_egg
ROM:0BF4	     ; End of function update_p_bullet_inv_dir_chk_east
ROM:0BF4
ROM:0BF4	     ; ---------------------------------------------------------------------------
ROM:0BF7 13 00 08 13+aTAITOCOP:	     .db 0x13, 0, 8, 0x13, 0xE,	0x26, 2, 0xE, 0xF    ; "TAITO COP"
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:0C00 00 00 00 00+		     .db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
ROM:1400	     ; ---------------------------------------------------------------------------
ROM:1400
ROM:1400	     OR_shifted_bitmap_to_vram:
ROM:1400 00			     nop
ROM:1401 CD 74 14		     call    set_shifter_and_calc_vram_addr
ROM:1404 00			     nop
ROM:1405
ROM:1405	     loc_0_1405:
ROM:1405 C5			     push    bc
ROM:1406 E5			     push    hl
ROM:1407 1A			     ld	     a,	(de)				     ; get bitmap byte
ROM:1408 D3 04			     out     (4), a				     ; set shifter data
ROM:140A DB 03			     in	     a,	(3)				     ; read back
ROM:140C B6			     or	     (hl)
ROM:140D 77			     ld	     (hl), a				     ; OR to vram
ROM:140E 23			     inc     hl					     ; next vram byte
ROM:140F 13			     inc     de					     ; next bitmap byte
ROM:1410 AF			     xor     a					     ; zero data
ROM:1411 D3 04			     out     (4), a				     ; set shifter data
ROM:1413 DB 03			     in	     a,	(3)				     ; read back
ROM:1415 B6			     or	     (hl)
ROM:1416 77			     ld	     (hl), a				     ; OR to vram
ROM:1417 E1			     pop     hl
ROM:1418 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:141B 09			     add     hl, bc				     ; next line
ROM:141C C1			     pop     bc
ROM:141D 05			     dec     b					     ; done all	lines?
ROM:141E C2 05 14		     jp	     NZ, loc_0_1405			     ; no, loop
ROM:1421 C9			     ret
ROM:1422	     ; ---------------------------------------------------------------------------
ROM:1422 00			     nop
ROM:1423 00			     nop
ROM:1424
ROM:1424	     ; =============== S U B R O U T I N E =======================================
ROM:1424
ROM:1424
ROM:1424	     clear_shifted_bitmap:
ROM:1424 CD 74 14		     call    set_shifter_and_calc_vram_addr
ROM:1427
ROM:1427	     clear_shifted_bitmap_hl:
ROM:1427 C5			     push    bc
ROM:1428 E5			     push    hl					     ; save vram addr
ROM:1429 AF			     xor     a
ROM:142A 77			     ld	     (hl), a
ROM:142B 23			     inc     hl
ROM:142C 77			     ld	     (hl), a
ROM:142D 23			     inc     hl					     ; clear both bytes	in vram
ROM:142E E1			     pop     hl
ROM:142F 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:1432 09			     add     hl, bc				     ; next line
ROM:1433 C1			     pop     bc
ROM:1434 05			     dec     b					     ; done?
ROM:1435 C2 27 14		     jp	     NZ, clear_shifted_bitmap_hl	     ; no, loop
ROM:1438 C9			     ret
ROM:1438	     ; End of function clear_shifted_bitmap
ROM:1438
ROM:1439
ROM:1439	     ; =============== S U B R O U T I N E =======================================
ROM:1439
ROM:1439
ROM:1439	     draw_simp_sprite:
ROM:1439 C5			     push    bc
ROM:143A 1A			     ld	     a,	(de)				     ; get bitmap byte
ROM:143B 77			     ld	     (hl), a				     ; copy to screen loc
ROM:143C 13			     inc     de					     ; next bitmap byte
ROM:143D 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:1440 09			     add     hl, bc				     ; next screen loc
ROM:1441 C1			     pop     bc
ROM:1442 05			     dec     b					     ; num bytes in bitmap
ROM:1443 C2 39 14		     jp	     NZ, draw_simp_sprite		     ; not done	- loop
ROM:1446 C9			     ret
ROM:1446	     ; End of function draw_simp_sprite
ROM:1446
ROM:1446	     ; ---------------------------------------------------------------------------
ROM:1447 00 00 00 00+		     .db 0, 0, 0, 0, 0,	0, 0, 0, 0, 0, 0
ROM:1452
ROM:1452	     ; =============== S U B R O U T I N E =======================================
ROM:1452
ROM:1452
ROM:1452	     wipe_shifted_bitmap_pixels:
ROM:1452 CD 74 14		     call    set_shifter_and_calc_vram_addr
ROM:1455
ROM:1455	     loc_0_1455:						     ; save bitmap length (b)
ROM:1455 C5			     push    bc
ROM:1456 E5			     push    hl					     ; save vram addr
ROM:1457 1A			     ld	     a,	(de)				     ; ptr bitmap data
ROM:1458 D3 04			     out     (4), a				     ; set shifter data
ROM:145A DB 03			     in	     a,	(3)				     ; read back
ROM:145C 2F			     cpl					     ; invert
ROM:145D A6			     and     (hl)				     ; wipe from vram
ROM:145E 77			     ld	     (hl), a				     ; put on screen
ROM:145F 23			     inc     hl					     ; next vram byte
ROM:1460 13			     inc     de					     ; next bitmap byte
ROM:1461 AF			     xor     a					     ; clear data
ROM:1462 D3 04			     out     (4), a				     ; set shifter data
ROM:1464 DB 03			     in	     a,	(3)				     ; read back
ROM:1466 2F			     cpl
ROM:1467 A6			     and     (hl)				     ; wipe from vram
ROM:1468 77			     ld	     (hl), a				     ; put on screen
ROM:1469 E1			     pop     hl
ROM:146A 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:146D 09			     add     hl, bc				     ; next line
ROM:146E C1			     pop     bc
ROM:146F 05			     dec     b					     ; done all	lines?
ROM:1470 C2 55 14		     jp	     NZ, loc_0_1455			     ; no, loop
ROM:1473 C9			     ret
ROM:1473	     ; End of function wipe_shifted_bitmap_pixels
ROM:1473
ROM:1474
ROM:1474	     ; =============== S U B R O U T I N E =======================================
ROM:1474
ROM:1474
ROM:1474	     set_shifter_and_calc_vram_addr:
ROM:1474 7D			     ld	     a,	l				     ; shift value = ? coord
ROM:1475 E6 07			     and     #7					     ; mask off	invalid	bits
ROM:1477 D3 02			     out     (2), a				     ; set shifter bits
ROM:1479 C3 47 1A		     jp	     calc_vram_addr_from_pixel_offset
ROM:1479	     ; End of function set_shifter_and_calc_vram_addr
ROM:1479
ROM:147C
ROM:147C	     ; =============== S U B R O U T I N E =======================================
ROM:147C
ROM:147C
ROM:147C	     save_1_shield:
ROM:147C C5			     push    bc
ROM:147D E5			     push    hl
ROM:147E
ROM:147E	     loc_0_147E:						     ; shield data from	screen
ROM:147E 7E			     ld	     a,	(hl)
ROM:147F 12			     ld	     (de), a				     ; save it
ROM:1480 13			     inc     de
ROM:1481 23			     inc     hl
ROM:1482 0D			     dec     c					     ; done 1 row?
ROM:1483 C2 7E 14		     jp	     NZ, loc_0_147E			     ; no, loop
ROM:1486 E1			     pop     hl					     ; screen loc
ROM:1487 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:148A 09			     add     hl, bc				     ; next line
ROM:148B C1			     pop     bc
ROM:148C 05			     dec     b					     ; done all	rows?
ROM:148D C2 7C 14		     jp	     NZ, save_1_shield			     ; no, loop
ROM:1490 C9			     ret
ROM:1490	     ; End of function save_1_shield
ROM:1490
ROM:1491
ROM:1491	     ; =============== S U B R O U T I N E =======================================
ROM:1491
ROM:1491
ROM:1491	     draw_and_detect_collision:
ROM:1491 CD 74 14		     call    set_shifter_and_calc_vram_addr
ROM:1494 AF			     xor     a
ROM:1495 32 61 20		     ld	     (something_hit), a			     ; flag nothing hit
ROM:1498
ROM:1498	     loc_0_1498:
ROM:1498 C5			     push    bc
ROM:1499 E5			     push    hl
ROM:149A 1A			     ld	     a,	(de)				     ; get bitmap data
ROM:149B D3 04			     out     (4), a				     ; write shifter data
ROM:149D DB 03			     in	     a,	(3)				     ; read back
ROM:149F F5			     push    af
ROM:14A0 A6			     and     (hl)				     ; hit something?
ROM:14A1 CA A9 14		     jp	     Z,	loc_0_14A9			     ; no, continue
ROM:14A4 3E 01			     ld	     a,	#1
ROM:14A6 32 61 20		     ld	     (something_hit), a			     ; flag that something was hit
ROM:14A9
ROM:14A9	     loc_0_14A9:						     ; shifted data
ROM:14A9 F1			     pop     af
ROM:14AA B6			     or	     (hl)				     ; OR it to	the screen
ROM:14AB 77			     ld	     (hl), a				     ; write to	vram
ROM:14AC 23			     inc     hl					     ; next vram byte
ROM:14AD 13			     inc     de					     ; next bitmap byte
ROM:14AE AF			     xor     a					     ; zero data
ROM:14AF D3 04			     out     (4), a				     ; write shifter data
ROM:14B1 DB 03			     in	     a,	(3)				     ; read back
ROM:14B3 F5			     push    af
ROM:14B4 A6			     and     (hl)				     ; hit something?
ROM:14B5 CA BD 14		     jp	     Z,	loc_0_14BD			     ; no, continue
ROM:14B8 3E 01			     ld	     a,	#1
ROM:14BA 32 61 20		     ld	     (something_hit), a			     ; flag that something was hit
ROM:14BD
ROM:14BD	     loc_0_14BD:						     ; shifted data
ROM:14BD F1			     pop     af
ROM:14BE B6			     or	     (hl)				     ; OR it to	the screen
ROM:14BF 77			     ld	     (hl), a				     ; write to	vram
ROM:14C0 E1			     pop     hl
ROM:14C1 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:14C4 09			     add     hl, bc				     ; next line
ROM:14C5 C1			     pop     bc
ROM:14C6 05			     dec     b					     ; done all	rows?
ROM:14C7 C2 98 14		     jp	     NZ, loc_0_1498			     ; no, loop
ROM:14CA C9			     ret
ROM:14CA	     ; End of function draw_and_detect_collision
ROM:14CA
ROM:14CB
ROM:14CB	     ; =============== S U B R O U T I N E =======================================
ROM:14CB
ROM:14CB
ROM:14CB	     clear_small_sprite:
ROM:14CB AF			     xor     a
ROM:14CC
ROM:14CC	     fill_chr_hl_b_:
ROM:14CC C5			     push    bc
ROM:14CD 77			     ld	     (hl), a				     ; write bitmap data to vram
ROM:14CE 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:14D1 09			     add     hl, bc				     ; next line
ROM:14D2 C1			     pop     bc
ROM:14D3 05			     dec     b					     ; done?
ROM:14D4 C2 CC 14		     jp	     NZ, fill_chr_hl_b_			     ; no, loop
ROM:14D7 C9			     ret
ROM:14D7	     ; End of function clear_small_sprite
ROM:14D7
ROM:14D8
ROM:14D8	     ; =============== S U B R O U T I N E =======================================
ROM:14D8
ROM:14D8
ROM:14D8	     update_player_bullet:
ROM:14D8 3A 25 20		     ld	     a,	(fire_progress_state)
ROM:14DB FE 05			     cp	     #5					     ; finished	firing?
ROM:14DD C8			     ret     Z					     ; yes, exit
ROM:14DE FE 02			     cp	     #2					     ; bullet in flight?
ROM:14E0 C0			     ret     NZ					     ; no, return
ROM:14E1 3A 29 20		     ld	     a,	(player_shot_y_coord)
ROM:14E4 FE D8			     cp	     #216				     ; top of screen?
ROM:14E6 47			     ld	     b,	a
ROM:14E7 D2 30 15		     jp	     NC, non_scoring_hit		     ; yes, skip
ROM:14EA 3A 02 20		     ld	     a,	(player_shot_something)
ROM:14ED A7			     and     a					     ; did player hit something?
ROM:14EE C8			     ret     Z					     ; no, exit
ROM:14EF 78			     ld	     a,	b				     ; player shot y coord
ROM:14F0 FE CE			     cp	     #206				     ; was it the UFO?
ROM:14F2 D2 79 15		     jp	     NC, flag_ufo_hit			     ; yes, handle
ROM:14F5 C6 06			     add     a,	#6				     ; move bullet up the screen
ROM:14F7 47			     ld	     b,	a				     ; b=bullet	y cood
ROM:14F8 3A 09 20		     ld	     a,	(bottom_left_invader_y)
ROM:14FB FE 90			     cp	     #144
ROM:14FD D2 04 15		     jp	     NC, invader_or_bomb_hit
ROM:1500 B8			     cp	     b					     ; reached lowest invader yet?
ROM:1501 D2 30 15		     jp	     NC, non_scoring_hit		     ; no, skip
ROM:1504
ROM:1504	     invader_or_bomb_hit:					     ; bullet y	coord
ROM:1504 68			     ld	     l,	b
ROM:1505 CD 62 15		     call    find_hit_invader_row		     ; b=row, l=y coord
ROM:1508 3A 2A 20		     ld	     a,	(player_shot_x_coord)		     ; get player shot coord
ROM:150B 67			     ld	     h,	a
ROM:150C CD 6F 15		     call    find_hit_invader_column		     ; h=x coord
ROM:150F 22 64 20		     ld	     (invader_screen_loc), hl		     ; save ptr	invader	screen loc
ROM:1512 3E 05			     ld	     a,	#5				     ; flag that shot is finished
ROM:1514 32 25 20		     ld	     (fire_progress_state), a
ROM:1517 CD 81 15		     call    set_hl_invader_b_c			     ; get ptr invader in player invader map
ROM:151A 7E			     ld	     a,	(hl)
ROM:151B A7			     and     a					     ; alive?
ROM:151C CA 30 15		     jp	     Z,	non_scoring_hit			     ; no, missed - a bomb?
ROM:151F 36 00			     ld	     (hl), #0				     ; flag invader as killed
ROM:1521 CD 5F 0A		     call    get_score_for_invader
ROM:1524 CD 3B 1A		     call    extract_DE_HL_B			     ; setup graphics object params
ROM:1527 CD D3 15		     call    draw_shifted_bitmap		     ; draw it
ROM:152A 3E 10			     ld	     a,	#16				     ; counter for invader explosion
ROM:152C 32 03 20		     ld	     (invader_explosion_counter), a	     ; init to 16
ROM:152F C9			     ret
ROM:1530	     ; ---------------------------------------------------------------------------
ROM:1530
ROM:1530	     non_scoring_hit:						     ; player bullet exploding
ROM:1530 3E 03			     ld	     a,	#3
ROM:1532 32 25 20		     ld	     (fire_progress_state), a		     ; save state
ROM:1535 C3 4A 15		     jp	     bullet_missed
ROM:1538	     ; ---------------------------------------------------------------------------
ROM:1538
ROM:1538	     check_invader_finished_exploding:				     ; ptr inavsion explosion counter
ROM:1538 21 03 20		     ld	     hl, #invader_explosion_counter
ROM:153B 35			     dec     (hl)				     ; finished	exploding?
ROM:153C C0			     ret     NZ					     ; no, exit
ROM:153D 2A 64 20		     ld	     hl, (invader_screen_loc)		     ; ptr invader screen loc
ROM:1540 06 10			     ld	     b,	#0x10				     ; explosion bitmap	size
ROM:1542 CD 24 14		     call    clear_shifted_bitmap		     ; wipe explosion
ROM:1545
ROM:1545	     loc_0_1545:						     ; something is about to explode?
ROM:1545 3E 04			     ld	     a,	#4
ROM:1547 32 25 20		     ld	     (fire_progress_state), a
ROM:154A
ROM:154A	     bullet_missed:						     ; re-init flag that player	shot something
ROM:154A AF			     xor     a
ROM:154B 32 02 20		     ld	     (player_shot_something), a		     ; save
ROM:154E 06 F7			     ld	     b,	#0xF7 ;	'÷'                          ; mask off invader hit sound
ROM:1550 C3 DC 19		     jp	     stop_port3_sound			     ; stop invader hit	sound
ROM:1550	     ; End of function update_player_bullet
ROM:1550
ROM:1553	     ; ---------------------------------------------------------------------------
ROM:1553 00			     nop
ROM:1554
ROM:1554	     ; =============== S U B R O U T I N E =======================================
ROM:1554
ROM:1554
ROM:1554	     collision_detect_1_axis:
ROM:1554 0E 00			     ld	     c,	#0				     ; a = object x/y coord
ROM:1554									     ; h = player bullet x/y coord
ROM:1556 BC			     cp	     h					     ; object coord > bullet coord?
ROM:1557 D4 90 15		     call    NC, sub_0_1590			     ; yes, add	16 to object coord
ROM:155A
ROM:155A	     loc_0_155A:						     ; adjusted	object coord > bullet coord?
ROM:155A BC			     cp	     h
ROM:155B D0			     ret     NC					     ; yes, exit
ROM:155C C6 10			     add     a,	#16				     ; add 16
ROM:155E 0C			     inc     c					     ; inc invader row counter
ROM:155F C3 5A 15		     jp	     loc_0_155A
ROM:155F	     ; End of function collision_detect_1_axis
ROM:155F
ROM:1562
ROM:1562	     ; =============== S U B R O U T I N E =======================================
ROM:1562
ROM:1562
ROM:1562	     find_hit_invader_row:
ROM:1562 3A 09 20		     ld	     a,	(bottom_left_invader_y)
ROM:1565 65			     ld	     h,	l				     ; player bullet y coordinate
ROM:1566 CD 54 15		     call    collision_detect_1_axis		     ; find invader row	that bullet is in
ROM:1569 41			     ld	     b,	c				     ; invader row
ROM:156A 05			     dec     b					     ; zero-based
ROM:156B DE 10			     sbc     a,	#0x10
ROM:156D 6F			     ld	     l,	a				     ; object coord possibly hit
ROM:156E C9			     ret
ROM:156E	     ; End of function find_hit_invader_row
ROM:156E
ROM:156F
ROM:156F	     ; =============== S U B R O U T I N E =======================================
ROM:156F
ROM:156F
ROM:156F	     find_hit_invader_column:
ROM:156F 3A 0A 20		     ld	     a,	(bottom_left_invader_x)
ROM:1572 CD 54 15		     call    collision_detect_1_axis
ROM:1575 DE 10			     sbc     a,	#0x10
ROM:1577 67			     ld	     h,	a				     ; object x	coord
ROM:1578 C9			     ret
ROM:1578	     ; End of function find_hit_invader_column
ROM:1578
ROM:1579	     ; ---------------------------------------------------------------------------
ROM:1579
ROM:1579	     flag_ufo_hit:						     ; flag ufo	as being hit
ROM:1579 3E 01			     ld	     a,	#1
ROM:157B 32 85 20		     ld	     (ufo_hit),	a
ROM:157E C3 45 15		     jp	     loc_0_1545
ROM:1581
ROM:1581	     ; =============== S U B R O U T I N E =======================================
ROM:1581
ROM:1581
ROM:1581	     set_hl_invader_b_c:
ROM:1581 78			     ld	     a,	b				     ; b = row
ROM:1582 07			     rlca
ROM:1583 07			     rlca
ROM:1584 07			     rlca					     ; x8
ROM:1585 80			     add     a,	b				     ; x9
ROM:1586 80			     add     a,	b				     ; x10
ROM:1587 80			     add     a,	b				     ; get row
ROM:1588 81			     add     a,	c				     ; c = column
ROM:1589 3D			     dec     a					     ; get invader in row
ROM:158A 6F			     ld	     l,	a
ROM:158B 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:158E 67			     ld	     h,	a				     ; hl = ptr	invader	in map
ROM:158F C9			     ret
ROM:158F	     ; End of function set_hl_invader_b_c
ROM:158F
ROM:1590
ROM:1590	     ; =============== S U B R O U T I N E =======================================
ROM:1590
ROM:1590
ROM:1590	     sub_0_1590:
ROM:1590 0C			     inc     c					     ; inc counter
ROM:1591 C6 10			     add     a,	#16				     ; add 16 pixel to coord
ROM:1593 FA 90 15		     jp	     M,	sub_0_1590
ROM:1596 C9			     ret
ROM:1596	     ; End of function sub_0_1590
ROM:1596
ROM:1597	     ; ---------------------------------------------------------------------------
ROM:1597
ROM:1597	     check_handle_invader_direction:
ROM:1597 3A 0D 20		     ld	     a,	(invader_left_right)
ROM:159A A7			     and     a					     ; moving left?
ROM:159B C2 B7 15		     jp	     NZ, invaders_are_moving_right	     ; no, handle right
ROM:159E 21 A4 3E		     ld	     hl, # vram+0x1AA4			     ; video ram
ROM:15A1 CD C5 15		     call    check_vram_23_bytes		     ; any pixels in next 23 bytes?
ROM:15A4 D0			     ret     NC					     ; no, exit
ROM:15A5 06 FE			     ld	     b,	#0xFE ;	'þ'                          ; invader x inc (moving left)
ROM:15A7 3E 01			     ld	     a,	#1
ROM:15A9
ROM:15A9	     change_invader_direction:					     ; store new invader direction
ROM:15A9 32 0D 20		     ld	     (invader_left_right), a
ROM:15AC 78			     ld	     a,	b
ROM:15AD 32 08 20		     ld	     (invader_x_inc), a			     ; store new invader x inc
ROM:15B0 3A 0E 20		     ld	     a,	(invader_y_inc_init_value)	     ; get y inc init value
ROM:15B3 32 07 20		     ld	     (invader_y_inc), a			     ; store new invader y inc
ROM:15B6 C9			     ret
ROM:15B7	     ; ---------------------------------------------------------------------------
ROM:15B7
ROM:15B7	     invaders_are_moving_right:					     ; video ram
ROM:15B7 21 24 25		     ld	     hl, # vram+0x124
ROM:15BA CD C5 15		     call    check_vram_23_bytes		     ; any pixels in next 23 bytes?
ROM:15BD D0			     ret     NC					     ; no, exit
ROM:15BE CD F1 18		     call    check_only_1_invader_left
ROM:15C1 AF			     xor     a					     ; flag invader direction =	left
ROM:15C2 C3 A9 15		     jp	     change_invader_direction
ROM:15C5
ROM:15C5	     ; =============== S U B R O U T I N E =======================================
ROM:15C5
ROM:15C5
ROM:15C5	     check_vram_23_bytes:
ROM:15C5 06 17			     ld	     b,	#23
ROM:15C7
ROM:15C7	     loc_0_15C7:
ROM:15C7 7E			     ld	     a,	(hl)
ROM:15C8 A7			     and     a					     ; any pixels at this location?
ROM:15C9 C2 6B 16		     jp	     NZ, scf_and_ret			     ; yes, flag and return
ROM:15CC 23			     inc     hl					     ; next vram loc
ROM:15CD 05			     dec     b					     ; done?
ROM:15CE C2 C7 15		     jp	     NZ, loc_0_15C7			     ; no, loop
ROM:15D1 C9			     ret
ROM:15D1	     ; End of function check_vram_23_bytes
ROM:15D1
ROM:15D2	     ; ---------------------------------------------------------------------------
ROM:15D2 00			     nop
ROM:15D3
ROM:15D3	     ; =============== S U B R O U T I N E =======================================
ROM:15D3
ROM:15D3
ROM:15D3	     draw_shifted_bitmap:
ROM:15D3 CD 74 14		     call    set_shifter_and_calc_vram_addr
ROM:15D6 E5			     push    hl					     ; save pixel offset
ROM:15D7
ROM:15D7	     draw_shifted_bitmap_hl_de_b_:				     ; save length
ROM:15D7 C5			     push    bc
ROM:15D8 E5			     push    hl					     ; save vram addr
ROM:15D9 1A			     ld	     a,	(de)				     ; get first bitmap	byte
ROM:15DA D3 04			     out     (4), a
ROM:15DC DB 03			     in	     a,	(3)				     ; shift it
ROM:15DE 77			     ld	     (hl), a				     ; move shifted value to screen
ROM:15DF 23			     inc     hl					     ; next vram loc
ROM:15E0 13			     inc     de					     ; next bitmap byte
ROM:15E1 AF			     xor     a					     ; lsb=0
ROM:15E2 D3 04			     out     (4), a
ROM:15E4 DB 03			     in	     a,	(3)				     ; shift it
ROM:15E6 77			     ld	     (hl), a				     ; move shifted value to vram
ROM:15E7 E1			     pop     hl
ROM:15E8 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:15EB 09			     add     hl, bc				     ; next line
ROM:15EC C1			     pop     bc
ROM:15ED 05			     dec     b					     ; finished	bitmap?
ROM:15EE C2 D7 15		     jp	     NZ, draw_shifted_bitmap_hl_de_b_	     ; no, loop
ROM:15F1 E1			     pop     hl					     ; return pixel offset
ROM:15F2 C9			     ret
ROM:15F2	     ; End of function draw_shifted_bitmap
ROM:15F2
ROM:15F3
ROM:15F3	     ; =============== S U B R O U T I N E =======================================
ROM:15F3
ROM:15F3
ROM:15F3	     count_invaders_left:
ROM:15F3 CD 11 16		     call    set_hl_ptr_curr_player_data
ROM:15F6 01 00 37		     ld	     bc, #0x3700			     ; b=55, c=0
ROM:15F9
ROM:15F9	     loc_0_15F9:						     ; invader map?
ROM:15F9 7E			     ld	     a,	(hl)
ROM:15FA A7			     and     a					     ; invader there?
ROM:15FB CA FF 15		     jp	     Z,	loc_0_15FF			     ; no, skip
ROM:15FE 0C			     inc     c					     ; inc invader count
ROM:15FF
ROM:15FF	     loc_0_15FF:						     ; next map	location
ROM:15FF 23			     inc     hl
ROM:1600 05			     dec     b					     ; done?
ROM:1601
ROM:1601	     loc_0_1601:						     ; no, loop
ROM:1601 C2 F9 15		     jp	     NZ, loc_0_15F9
ROM:1604 79			     ld	     a,	c				     ; number of invaders left
ROM:1605 32 82 20		     ld	     (num_invaders_left), a		     ; store
ROM:1608 FE 01			     cp	     #1					     ; 1 left?
ROM:160A C0			     ret     NZ					     ; no, exit
ROM:160B 21 6B 20		     ld	     hl, #only_1_invader_left
ROM:160E 36 01			     ld	     (hl), #1				     ; flag only 1 invader left
ROM:1610 C9			     ret
ROM:1610	     ; End of function count_invaders_left
ROM:1610
ROM:1611
ROM:1611	     ; =============== S U B R O U T I N E =======================================
ROM:1611
ROM:1611
ROM:1611	     set_hl_ptr_curr_player_data:
ROM:1611 2E 00			     ld	     l,	#0
ROM:1613 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:1616 67			     ld	     h,	a
ROM:1617 C9			     ret
ROM:1617	     ; End of function set_hl_ptr_curr_player_data
ROM:1617
ROM:1618
ROM:1618	     ; =============== S U B R O U T I N E =======================================
ROM:1618
ROM:1618
ROM:1618	     poll_fire_button:
ROM:1618 3A 15 20		     ld	     a,	(gameplay_ticker)
ROM:161B FE FF			     cp	     #0xFF				     ; ready to	poll player controls?
ROM:161D C0			     ret     NZ					     ; no, exit
ROM:161E 21 10 20		     ld	     hl, #obj0_timer_msb
ROM:1621 7E			     ld	     a,	(hl)
ROM:1622 23			     inc     hl
ROM:1623 46			     ld	     b,	(hl)
ROM:1624 B0			     or	     b
ROM:1625 C0			     ret     NZ
ROM:1626 3A 25 20		     ld	     a,	(fire_progress_state)
ROM:1629 A7			     and     a					     ; already firing?
ROM:162A C0			     ret     NZ					     ; yes, exit
ROM:162B 3A EF 20		     ld	     a,	(game_in_progress)
ROM:162E A7			     and     a					     ; is someone playing?
ROM:162F CA 52 16		     jp	     Z,	handle_demo_logic		     ; no, skip
ROM:1632 3A 2D 20		     ld	     a,	(last_fire_button_state)
ROM:1635 A7			     and     a
ROM:1636 C2 48 16		     jp	     NZ, fire_falling_edge_detect	     ; catch leading edge of button press
ROM:1639 CD C0 17		     call    read_player_controller
ROM:163C E6 10			     and     #0x10				     ; only interested in fire button
ROM:163E C8			     ret     Z					     ; not pressed - return
ROM:163F 3E 01			     ld	     a,	#1
ROM:1641 32 25 20		     ld	     (fire_progress_state), a		     ; only loaded on leading edge
ROM:1644 32 2D 20		     ld	     (last_fire_button_state), a
ROM:1647 C9			     ret
ROM:1648	     ; ---------------------------------------------------------------------------
ROM:1648
ROM:1648	     fire_falling_edge_detect:
ROM:1648 CD C0 17		     call    read_player_controller
ROM:164B E6 10			     and     #0x10				     ; only interested in fire button
ROM:164D C0			     ret     NZ					     ; pressed - exit
ROM:164E 32 2D 20		     ld	     (last_fire_button_state), a
ROM:1651 C9			     ret
ROM:1652	     ; ---------------------------------------------------------------------------
ROM:1652
ROM:1652	     handle_demo_logic:						     ; ptr fire	progress state
ROM:1652 21 25 20		     ld	     hl, #fire_progress_state
ROM:1655 36 01			     ld	     (hl), #1				     ; simulate	fire button press
ROM:1655									     ; - note that demo	always firing if possible
ROM:1657 2A ED 20		     ld	     hl, (ptr_demo_joystick_input)	     ; ptr next	logic byte
ROM:165A 23			     inc     hl
ROM:165B 7D			     ld	     a,	l
ROM:165C FE 7E			     cp	     #0x7E ; '~'                             ; end of logic table?
ROM:165E DA 63 16		     jp	     C,	loc_0_1663			     ; no, skip
ROM:1661 2E 74			     ld	     l,	#0x74 ;	't'                          ; loop near end of table
ROM:1663
ROM:1663	     loc_0_1663:						     ; save ptr	next logic byte
ROM:1663 22 ED 20		     ld	     (ptr_demo_joystick_input),	hl
ROM:1666 7E			     ld	     a,	(hl)				     ; get logic
ROM:1667 32 1D 20		     ld	     (demo_joystick_input), a		     ; save as current 'joystick'
ROM:166A C9			     ret
ROM:166A	     ; End of function poll_fire_button
ROM:166A
ROM:166B	     ; ---------------------------------------------------------------------------
ROM:166B
ROM:166B	     scf_and_ret:
ROM:166B 37			     scf
ROM:166C C9			     ret
ROM:166D	     ; ---------------------------------------------------------------------------
ROM:166D
ROM:166D	     prt_0_ships_left:						     ; print '0'
ROM:166D AF			     xor     a
ROM:166E CD 8B 1A		     call    prt_num_ships_left
ROM:1671
ROM:1671	     update_hi_score:
ROM:1671 CD 10 19		     call    set_hl_num_ships_curr_player
ROM:1674 36 00			     ld	     (hl), #0				     ; set num ships curr player = 0
ROM:1676 CD CA 09		     call    get_ptr_curr_score
ROM:1679 23			     inc     hl
ROM:167A 11 F5 20		     ld	     de, # hi_score+1
ROM:167D 1A			     ld	     a,	(de)				     ; hi score	msb
ROM:167E BE			     cp	     (hl)				     ; player score msb
ROM:167F 1B			     dec     de
ROM:1680 2B			     dec     hl					     ; next lower byte
ROM:1681 1A			     ld	     a,	(de)				     ; hi score	lsb
ROM:1682 CA 8B 16		     jp	     Z,	loc_0_168B			     ; msb same, need another compare
ROM:1685 D2 98 16		     jp	     NC, loc_0_1698			     ; no hi score, skip
ROM:1688 C3 8F 16		     jp	     new_hi_score
ROM:168B	     ; ---------------------------------------------------------------------------
ROM:168B
ROM:168B	     loc_0_168B:						     ; player score lsb
ROM:168B BE			     cp	     (hl)
ROM:168C D2 98 16		     jp	     NC, loc_0_1698			     ; no hi score, skip
ROM:168F
ROM:168F	     new_hi_score:						     ; player score lsb
ROM:168F 7E			     ld	     a,	(hl)
ROM:1690 12			     ld	     (de), a				     ; copy to hi score	lsb
ROM:1691 13			     inc     de
ROM:1692 23			     inc     hl					     ; ptr msb
ROM:1693 7E			     ld	     a,	(hl)				     ; player score msb
ROM:1694 12			     ld	     (de), a				     ; copy to hi score	msb
ROM:1695 CD 50 19		     call    draw_hi_score
ROM:1698
ROM:1698	     loc_0_1698:
ROM:1698 3A CE 20		     ld	     a,	(two_p_game)
ROM:169B A7			     and     a
ROM:169C CA C9 16		     jp	     Z,	game_over_everyone		     ; only 1 player - skip
ROM:169F 21 03 28		     ld	     hl, # vram+0x403			     ; screen loc
ROM:16A2 11 A6 1A		     ld	     de, #message_g_over		     ; "GAME OVER PLAYER"
ROM:16A5 0E 14			     ld	     c,	#0x14				     ; length
ROM:16A7 CD 93 0A		     call    print_message_del
ROM:16AA 25			     dec     h
ROM:16AB 25			     dec     h
ROM:16AC 06 1B			     ld	     b,	#0x1B				     ; "1"
ROM:16AE 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:16B1 0F			     rrca					     ; player 1?
ROM:16B2 DA B7 16		     jp	     C,	loc_0_16B7			     ; yes - skip
ROM:16B5 06 1C			     ld	     b,	#0x1C				     ; "2"
ROM:16B7
ROM:16B7	     loc_0_16B7:						     ; player number
ROM:16B7 78			     ld	     a,	b
ROM:16B8 CD FF 08		     call    draw_char				     ; print "1" or "2"
ROM:16BB CD B1 0A		     call    one_sec_delay
ROM:16BE CD E7 18		     call    get_ptr_num_ships_other_player
ROM:16C1 7E			     ld	     a,	(hl)				     ; num men
ROM:16C2 A7			     and     a					     ; zero?
ROM:16C3 CA C9 16		     jp	     Z,	game_over_everyone		     ; yes, game over for everyone
ROM:16C6 C3 ED 02		     jp	     save_player_state			     ; loop
ROM:16C9	     ; ---------------------------------------------------------------------------
ROM:16C9
ROM:16C9	     game_over_everyone:
ROM:16C9 21 18 2D		     ld	     hl, # vram+0x918
ROM:16CC 11 A6 1A		     ld	     de, #message_g_over		     ; "GAME OVER"
ROM:16CF 0E 0A			     ld	     c,	#0xA				     ; length
ROM:16D1 CD 93 0A		     call    print_message_del
ROM:16D4 CD B6 0A		     call    two_sec_delay
ROM:16D7 CD D6 09		     call    clear_visible_display
ROM:16DA AF			     xor     a
ROM:16DB 32 EF 20		     ld	     (game_in_progress), a		     ; flag no game in progress
ROM:16DE D3 05			     out     (5), a				     ; stop sound
ROM:16E0 CD D1 19		     call    do_enable_vblank_code
ROM:16E3 C3 89 0B		     jp	     attract_tick_loop_3
ROM:16E6	     ; ---------------------------------------------------------------------------
ROM:16E6
ROM:16E6	     kill_player_and_end_game:					     ; reset context
ROM:16E6 31 00 24		     ld	     sp, #vram
ROM:16E9 FB			     ei
ROM:16EA AF			     xor     a
ROM:16EB 32 15 20		     ld	     (gameplay_ticker),	a		     ; init player control poll	counter
ROM:16EE
ROM:16EE	     wait_for_ship_stop_exploding:
ROM:16EE CD D8 14		     call    update_player_bullet
ROM:16F1 06 04			     ld	     b,	#4				     ; player ship hit sound
ROM:16F3 CD FA 18		     call    start_port3_sound
ROM:16F6 CD 59 0A		     call    check_player_hit			     ; time to move on?
ROM:16F6									     ; - wait for ship to stop exploding
ROM:16F9 C2 EE 16		     jp	     NZ, wait_for_ship_stop_exploding	     ; no, loop
ROM:16FC CD D7 19		     call    disable_vblank_code
ROM:16FF 21 01 27		     ld	     hl, #0x2701
ROM:1702 CD FA 19		     call    clr_ship_display			     ; wipe remaining ships
ROM:1705 AF			     xor     a
ROM:1706 CD 8B 1A		     call    prt_num_ships_left			     ; show 0 ships left
ROM:1709 06 FB			     ld	     b,	#0xFB ;	'û'                          ; mask off player ship hit sound
ROM:170B C3 6B 19		     jp	     play_sound_and_update_hi_score
ROM:170E
ROM:170E	     ; =============== S U B R O U T I N E =======================================
ROM:170E
ROM:170E
ROM:170E	     update_bomb_frequency:
ROM:170E CD CA 09		     call    get_ptr_curr_score
ROM:1711 23			     inc     hl					     ; skip unused byte
ROM:1712 7E			     ld	     a,	(hl)				     ; get digit
ROM:1713 11 B8 1C		     ld	     de, #byte_0_1CB8			     ; ptr 2(00), 10(00), 20(00), 30(00) (BCD)
ROM:1716 21 A1 1A		     ld	     hl, #bomb_freq_tbl			     ; ptr 48, 16, 11, 8, 7
ROM:1719 0E 04			     ld	     c,	#4				     ; 4+1 table entries
ROM:171B 47			     ld	     b,	a				     ; digit
ROM:171C
ROM:171C	     lookup_bomb_frequency:					     ; get table entry
ROM:171C 1A			     ld	     a,	(de)
ROM:171D B8			     cp	     b					     ; entry > score digit?
ROM:171E D2 27 17		     jp	     NC, set_bomb_frequency		     ; yes, skip
ROM:1721 23			     inc     hl					     ; next entry
ROM:1722 13			     inc     de
ROM:1723 0D			     dec     c					     ; done?
ROM:1724 C2 1C 17		     jp	     NZ, lookup_bomb_frequency		     ; no, loop
ROM:1727
ROM:1727	     set_bomb_frequency:					     ; get corresponding table entry
ROM:1727 7E			     ld	     a,	(hl)
ROM:1728 32 CF 20		     ld	     (bomb_frequency), a		     ; set bomb	frequency
ROM:172B C9			     ret
ROM:172B	     ; End of function update_bomb_frequency
ROM:172B
ROM:172C
ROM:172C	     ; =============== S U B R O U T I N E =======================================
ROM:172C
ROM:172C
ROM:172C	     start_stop_shot_sound:
ROM:172C 3A 25 20		     ld	     a,	(fire_progress_state)
ROM:172F FE 00			     cp	     #0
ROM:1731 C2 39 17		     jp	     NZ, start_shot_sound
ROM:1734 06 FD			     ld	     b,	#0xFD ;	'ý'                          ; mask off shot sound
ROM:1736 C3 DC 19		     jp	     stop_port3_sound			     ; stop shot sound
ROM:1739	     ; ---------------------------------------------------------------------------
ROM:1739
ROM:1739	     start_shot_sound:						     ; shot sound
ROM:1739 06 02			     ld	     b,	#2
ROM:173B C3 FA 18		     jp	     start_port3_sound
ROM:173B	     ; End of function start_stop_shot_sound
ROM:173B
ROM:173E	     ; ---------------------------------------------------------------------------
ROM:173E 00			     nop
ROM:173F 00			     nop
ROM:1740
ROM:1740	     ; =============== S U B R O U T I N E =======================================
ROM:1740
ROM:1740
ROM:1740	     do_update_invader_sound:
ROM:1740 21 9B 20		     ld	     hl, #invader_sound_counter		     ; ptr invader sound counter
ROM:1743 35			     dec     (hl)				     ; time to stop sound?
ROM:1744 CC 6D 17		     call    Z,	stop_invader_march_sound	     ; yes, handle
ROM:1747 3A 68 20		     ld	     a,	(player_ok)
ROM:174A A7			     and     a
ROM:174B CA 6D 17		     jp	     Z,	stop_invader_march_sound
ROM:174E 21 96 20		     ld	     hl, #fleet_snd_cnt
ROM:1751 35			     dec     (hl)
ROM:1752 C0			     ret     NZ					     ; no, exit
ROM:1753 21 98 20		     ld	     hl, #port_5_sound_shadow_reg	     ; port 5 sound shadow register
ROM:1756 7E			     ld	     a,	(hl)
ROM:1757 D3 05			     out     (5), a				     ; drive sound h/w
ROM:1759 3A 82 20		     ld	     a,	(num_invaders_left)
ROM:175C A7			     and     a					     ; any invaders left?
ROM:175D CA 6D 17		     jp	     Z,	stop_invader_march_sound	     ; no, exit
ROM:1760 2B			     dec     hl					     ; ptr invader sound delay re-init value
ROM:1761 7E			     ld	     a,	(hl)
ROM:1762 2B			     dec     hl					     ; ptr inavder sound delay
ROM:1763 77			     ld	     (hl), a				     ; re-init invader sound delay
ROM:1764 2B			     dec     hl					     ; ptr flag	to update invader sound
ROM:1765 36 01			     ld	     (hl), #1				     ; flag as requiring update
ROM:1767 3E 04			     ld	     a,	#4				     ; re-init invader sound counter
ROM:1769 32 9B 20		     ld	     (invader_sound_counter), a		     ; save
ROM:176C C9			     ret
ROM:176C	     ; End of function do_update_invader_sound
ROM:176C
ROM:176D
ROM:176D	     ; =============== S U B R O U T I N E =======================================
ROM:176D
ROM:176D
ROM:176D	     stop_invader_march_sound:
ROM:176D 3A 98 20		     ld	     a,	(port_5_sound_shadow_reg)
ROM:1770
ROM:1770	     start_stop_ufo_hit_sound:					     ; mask off	all but	ufo hit, screen	flip
ROM:1770 E6 30			     and     #0x30 ; '0'
ROM:1772 D3 05			     out     (5), a				     ; start/stop sound
ROM:1774 C9			     ret
ROM:1774	     ; End of function stop_invader_march_sound
ROM:1774
ROM:1775
ROM:1775	     ; =============== S U B R O U T I N E =======================================
ROM:1775
ROM:1775
ROM:1775	     check_update_invader_sound:
ROM:1775 3A 95 20		     ld	     a,	(update_invader_sound)
ROM:1778 A7			     and     a					     ; need to update invader sound?
ROM:1779 CA AA 17		     jp	     Z,	check_bonus_ship_sound		     ; no, skip
ROM:177C 21 11 1A		     ld	     hl, #byte_0_1A11			     ; ptr to table of number of invaders left
ROM:177F 11 21 1A		     ld	     de, #byte_0_1A21			     ; ptr to table of corresponding values
ROM:1782 3A 82 20		     ld	     a,	(num_invaders_left)		     ; get num invaders	left
ROM:1785
ROM:1785	     loc_0_1785:						     ; more than [entry] invaders left?
ROM:1785 BE			     cp	     (hl)
ROM:1786 D2 8E 17		     jp	     NC, calc_next_invader_sound	     ; yes, exit
ROM:1789 23			     inc     hl					     ; next entry
ROM:178A 13			     inc     de					     ; next entry
ROM:178B C3 85 17		     jp	     loc_0_1785				     ; loop
ROM:178E	     ; ---------------------------------------------------------------------------
ROM:178E
ROM:178E	     calc_next_invader_sound:					     ; get corresponding entry
ROM:178E 1A			     ld	     a,	(de)
ROM:178F 32 97 20		     ld	     (fleet_snd_reload), a
ROM:1792 21 98 20		     ld	     hl, #port_5_sound_shadow_reg	     ; port 5 sound shadow register
ROM:1795 7E			     ld	     a,	(hl)
ROM:1796 E6 30			     and     #0x30 ; '0'                             ; mask out invader sounds
ROM:1798 47			     ld	     b,	a
ROM:1799 7E			     ld	     a,	(hl)
ROM:179A E6 0F			     and     #0xF				     ; current invader sound
ROM:179C 07			     rlca					     ; next invader sound
ROM:179D FE 10			     cp	     #0x10				     ; was 4?
ROM:179F C2 A4 17		     jp	     NZ, loc_0_17A4			     ; no, skip
ROM:17A2 3E 01			     ld	     a,	#1				     ; set invader sound = 1
ROM:17A4
ROM:17A4	     loc_0_17A4:						     ; restore other bits
ROM:17A4 B0			     or	     b
ROM:17A5 77			     ld	     (hl), a				     ; save in shadow register
ROM:17A6 AF			     xor     a					     ; no need to update invader sound
ROM:17A7 32 95 20		     ld	     (update_invader_sound), a		     ; save
ROM:17AA
ROM:17AA	     check_bonus_ship_sound:					     ; ptr bonus ship sound timer
ROM:17AA 21 99 20		     ld	     hl, #bonus_ship_sound_timer
ROM:17AD 35			     dec     (hl)				     ; done?
ROM:17AE C0			     ret     NZ					     ; no, exit
ROM:17AF 06 EF			     ld	     b,	#0xEF ;	'ï'                          ; mask off bonus ship sound
ROM:17B1 C3 DC 19		     jp	     stop_port3_sound			     ; stop bonus ship sound
ROM:17B1	     ; End of function check_update_invader_sound
ROM:17B1
ROM:17B4	     ; ---------------------------------------------------------------------------
ROM:17B4 06 EF			     ld	     b,	#0xEF ;	'ï'                          ; mask off ufo hit sound
ROM:17B6 21 98 20		     ld	     hl, #port_5_sound_shadow_reg	     ; port 5 shadow register
ROM:17B9 7E			     ld	     a,	(hl)
ROM:17BA A0			     and     b					     ; mask off	ufo hit	sound
ROM:17BB 77			     ld	     (hl), a				     ; save
ROM:17BC D3 05			     out     (5), a				     ; stop sound
ROM:17BE C9			     ret
ROM:17BF	     ; ---------------------------------------------------------------------------
ROM:17BF 00			     nop
ROM:17C0
ROM:17C0	     ; =============== S U B R O U T I N E =======================================
ROM:17C0
ROM:17C0
ROM:17C0	     read_player_controller:
ROM:17C0 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:17C3 0F			     rrca
ROM:17C4 D2 CA 17		     jp	     NC, read_p2_controller
ROM:17C7 DB 01			     in	     a,	(1)				     ; read controller 1
ROM:17C9 C9			     ret
ROM:17CA	     ; ---------------------------------------------------------------------------
ROM:17CA
ROM:17CA	     read_p2_controller:					     ; read controller 2
ROM:17CA DB 02			     in	     a,	(2)
ROM:17CC C9			     ret
ROM:17CC	     ; End of function read_player_controller
ROM:17CC
ROM:17CD
ROM:17CD	     ; =============== S U B R O U T I N E =======================================
ROM:17CD
ROM:17CD
ROM:17CD	     handle_tilt:
ROM:17CD DB 02			     in	     a,	(2)				     ; read dipswitches
ROM:17CF E6 04			     and     #4					     ; tilt?
ROM:17D1 C8			     ret     Z					     ; no, return
ROM:17D2 3A 9A 20		     ld	     a,	(tilted)
ROM:17D5 A7			     and     a					     ; already titled?
ROM:17D6 C0			     ret     NZ					     ; yes, exit
ROM:17D7 31 00 24		     ld	     sp, #vram
ROM:17DA 06 04			     ld	     b,	#4				     ; num times
ROM:17DC
ROM:17DC	     loc_0_17DC:
ROM:17DC CD D6 09		     call    clear_visible_display
ROM:17DF 05			     dec     b					     ; done?
ROM:17E0 C2 DC 17		     jp	     NZ, loc_0_17DC			     ; no, loop
ROM:17E3 3E 01			     ld	     a,	#1
ROM:17E5 32 9A 20		     ld	     (tilted), a			     ; flag already tilted
ROM:17E8 CD D7 19		     call    disable_vblank_code
ROM:17EB FB			     ei
ROM:17EC 11 BC 1C		     ld	     de, #aTILT				     ; "TILT"
ROM:17EF 21 16 30		     ld	     hl, # vram+0xC16			     ; screen loc
ROM:17F2 0E 04			     ld	     c,	#4				     ; length
ROM:17F2	     ; End of function handle_tilt
ROM:17F2
ROM:17F4 CD 93 0A		     call    print_message_del			     ; show tilt message
ROM:17F7 CD B1 0A		     call    one_sec_delay
ROM:17FA AF			     xor     a
ROM:17FB 32 9A 20		     ld	     (tilted), a			     ; reset tilted flag
ROM:17FE 32 93 20		     ld	     (coined_up), a			     ; reset coined up
ROM:1801 C3 C9 16		     jp	     game_over_everyone			     ; game over for all
ROM:1804
ROM:1804	     ; =============== S U B R O U T I N E =======================================
ROM:1804
ROM:1804
ROM:1804	     start_stop_ufo_sound:
ROM:1804 21 84 20		     ld	     hl, #ufo_visible			     ; ptr ufo visible flag
ROM:1807 7E			     ld	     a,	(hl)
ROM:1808 A7			     and     a					     ; is the ufo visible?
ROM:1809 CA 07 07		     jp	     Z,	stop_ufo_sound			     ; no, stop	sound
ROM:180C 23			     inc     hl					     ; ptr ufo hit flag
ROM:180D 7E			     ld	     a,	(hl)
ROM:180E A7			     and     a					     ; ufo hit?
ROM:180F C0			     ret     NZ					     ; yes, exit
ROM:1810 06 01			     ld	     b,	#1				     ; ufo sound
ROM:1812 C3 FA 18		     jp	     start_port3_sound
ROM:1812	     ; End of function start_stop_ufo_sound
ROM:1812
ROM:1815
ROM:1815	     ; =============== S U B R O U T I N E =======================================
ROM:1815
ROM:1815
ROM:1815	     draw_adv_table:
ROM:1815 21 10 28		     ld	     hl, # vram+0x410			     ; screen loc
ROM:1818 11 A3 1C		     ld	     de, #aSCOREADVANCETABLE		     ; "SCORE ADVANCE TABLE"
ROM:181B
ROM:181B	     loc_0_181B:						     ; length
ROM:181B 0E 15			     ld	     c,	#21
ROM:181D CD F3 08		     call    draw_str_hl_de_
ROM:1820 3E 0A			     ld	     a,	#10				     ; string length = 10 chars
ROM:1822 32 6C 20		     ld	     (string_length), a			     ; save
ROM:1825 01 BE 1D		     ld	     bc, #off_0_1DBE			     ; ptr score table gfx data
ROM:1828
ROM:1828	     loc_0_1828:						     ; get invader screen loc and bitmap
ROM:1828 CD 56 18		     call    lookup_hl_de_at_bc
ROM:182B DA 37 18		     jp	     C,	loc_0_1837			     ; exit if finished
ROM:182E CD 44 18		     call    draw_bitmap_16_bytes		     ; draw ufo/invader
ROM:1831 C3 28 18		     jp	     loc_0_1828				     ; loop
ROM:1834	     ; ---------------------------------------------------------------------------
ROM:1834 CD B1 0A		     call    one_sec_delay
ROM:1837
ROM:1837	     loc_0_1837:						     ; ptr score table strings
ROM:1837 01 CF 1D		     ld	     bc, #0x1DCF
ROM:1837	     ; End of function draw_adv_table
ROM:1837
ROM:183A
ROM:183A	     ; =============== S U B R O U T I N E =======================================
ROM:183A
ROM:183A
ROM:183A	     draw_multistr_varlen:
ROM:183A CD 56 18		     call    lookup_hl_de_at_bc			     ; get string loc and value
ROM:183D D8			     ret     C					     ; exit if done
ROM:183E CD 4C 18		     call    draw_str_varlen			     ; draw first string (sets length)
ROM:1841 C3 3A 18		     jp	     draw_multistr_varlen		     ; draw the	rest
ROM:1841	     ; End of function draw_multistr_varlen
ROM:1841
ROM:1844
ROM:1844	     ; =============== S U B R O U T I N E =======================================
ROM:1844
ROM:1844
ROM:1844	     draw_bitmap_16_bytes:
ROM:1844 C5			     push    bc
ROM:1845 06 10			     ld	     b,	#0x10
ROM:1847 CD 39 14		     call    draw_simp_sprite
ROM:184A C1			     pop     bc
ROM:184B C9			     ret
ROM:184B	     ; End of function draw_bitmap_16_bytes
ROM:184B
ROM:184C
ROM:184C	     ; =============== S U B R O U T I N E =======================================
ROM:184C
ROM:184C
ROM:184C	     draw_str_varlen:
ROM:184C C5			     push    bc
ROM:184D 3A 6C 20		     ld	     a,	(string_length)
ROM:1850 4F			     ld	     c,	a				     ; set length
ROM:1851 CD 93 0A		     call    print_message_del
ROM:1854 C1			     pop     bc
ROM:1855 C9			     ret
ROM:1855	     ; End of function draw_str_varlen
ROM:1855
ROM:1856
ROM:1856	     ; =============== S U B R O U T I N E =======================================
ROM:1856
ROM:1856
ROM:1856	     lookup_hl_de_at_bc:
ROM:1856 0A			     ld	     a,	(bc)
ROM:1857 FE FF			     cp	     #0xFF				     ; end of table?
ROM:1859 37			     scf					     ; flag end	of table
ROM:185A C8			     ret     Z					     ; yes, exit
ROM:185B 6F			     ld	     l,	a
ROM:185C 03			     inc     bc
ROM:185D 0A			     ld	     a,	(bc)
ROM:185E 67			     ld	     h,	a				     ; set hl
ROM:185F 03			     inc     bc
ROM:1860 0A			     ld	     a,	(bc)
ROM:1861 5F			     ld	     e,	a
ROM:1862 03			     inc     bc
ROM:1863 0A			     ld	     a,	(bc)
ROM:1864 57			     ld	     d,	a				     ; set de
ROM:1865 03			     inc     bc
ROM:1866 A7			     and     a					     ; flag not	end of table
ROM:1867 C9			     ret
ROM:1867	     ; End of function lookup_hl_de_at_bc
ROM:1867
ROM:1868	     ; ---------------------------------------------------------------------------
ROM:1868
ROM:1868	     update_animated_invader:					     ; ptr animation frame counter
ROM:1868 21 C2 20		     ld	     hl, #animation_frame_count
ROM:186B 34			     inc     (hl)				     ; next frame
ROM:186C 23			     inc     hl					     ; ptr invader x inc
ROM:186D 4E			     ld	     c,	(hl)				     ; invader x inc
ROM:186E CD D9 01		     call    add_c_hl1_hl2_hl3			     ; x += x_inc, y +=	y_inc
ROM:1871 47			     ld	     b,	a				     ; invader x coord
ROM:1872 3A CA 20		     ld	     a,	(animated_invader_final_x)	     ; invader final x coord
ROM:1875 B8			     cp	     b					     ; finished	this part of animation?
ROM:1876 CA 98 18		     jp	     Z,	flag_animation_finished		     ; yes, exit
ROM:1879 3A C2 20		     ld	     a,	(animation_frame_count)
ROM:187C E6 04			     and     #4					     ; 2nd invader bitmap? (2nd	animation cell)
ROM:187E 2A CC 20		     ld	     hl, (animated_invader_base_bitmap)	     ; get ptr base bitmap type
ROM:1881 C2 88 18		     jp	     NZ, draw_animated_invader		     ; no, skip
ROM:1884 11 30 00		     ld	     de, #0x30 ; '0'
ROM:1887 19			     add     hl, de				     ; ptr to 2nd invader bitmap
ROM:1888
ROM:1888	     draw_animated_invader:
ROM:1888 22 C7 20		     ld	     (animated_invader_curr_bitmap), hl
ROM:188B 21 C5 20		     ld	     hl, #animated_invader_screen_loc	     ; ptr animated invader object
ROM:188E CD 3B 1A		     call    extract_DE_HL_B			     ; get animated invader object params
ROM:1891 EB			     ex	     de, hl				     ; screen, bitmap stored swapped
ROM:1892 C3 D3 15		     jp	     draw_shifted_bitmap		     ; draw animated invader
ROM:1895	     ; ---------------------------------------------------------------------------
ROM:1895 00			     nop
ROM:1896 00			     nop
ROM:1897 00			     nop
ROM:1898
ROM:1898	     flag_animation_finished:
ROM:1898 3E 01			     ld	     a,	#1
ROM:189A 32 CB 20		     ld	     (animation_finished), a
ROM:189D C9			     ret
ROM:189E
ROM:189E	     ; =============== S U B R O U T I N E =======================================
ROM:189E
ROM:189E
ROM:189E	     animate_bomb_c_dropping:
ROM:189E 21 50 20		     ld	     hl, # plu_shot_blow_cnt+6		     ; ptr alien bomb 3	data
ROM:18A1 11 C0 1B		     ld	     de, #word_0_1BC0
ROM:18A4 06 10			     ld	     b,	#0x10
ROM:18A6 CD 32 1A		     call    memcpy_hl_de_b_			     ; re-init alien bomb 3
ROM:18A9 3E 02			     ld	     a,	#2
ROM:18AB 32 80 20		     ld	     (shot_sync), a
ROM:18AE 3E FF			     ld	     a,	#0xFF
ROM:18B0 32 7E 20		     ld	     (alien_bomb_y_inc), a		     ; init alien bomb y inc
ROM:18B3 3E 04			     ld	     a,	#4				     ; set bomb-c animation
ROM:18B5 32 C1 20		     ld	     (animation_type), a
ROM:18B8
ROM:18B8	     loc_0_18B8:
ROM:18B8 3A 55 20		     ld	     a,	(alien_bomb_3_data)
ROM:18BB E6 01			     and     #1					     ; has bomb	animation started?
ROM:18BD CA B8 18		     jp	     Z,	loc_0_18B8			     ; no, loop
ROM:18C0
ROM:18C0	     loc_0_18C0:
ROM:18C0 3A 55 20		     ld	     a,	(alien_bomb_3_data)
ROM:18C3 E6 01			     and     #1					     ; has bomb	animation finished?
ROM:18C5 C2 C0 18		     jp	     NZ, loc_0_18C0			     ; no, loop
ROM:18C8 21 11 33		     ld	     hl, # vram+0xF11			     ; screen loc
ROM:18CB 3E 26			     ld	     a,	#0x26 ;	'&'                          ; " "
ROM:18CD 00			     nop
ROM:18CE CD FF 08		     call    draw_char				     ; clear "C"
ROM:18D1 C3 B6 0A		     jp	     two_sec_delay
ROM:18D1	     ; End of function animate_bomb_c_dropping
ROM:18D1
ROM:18D4	     ; ---------------------------------------------------------------------------
ROM:18D4
ROM:18D4	     start:							     ; video ram
ROM:18D4 31 00 24		     ld	     sp, #vram
ROM:18D7 06 00			     ld	     b,	#0				     ; 256 vars	to init
ROM:18D9 CD E6 01		     call    init_vars_b_
ROM:18DC CD 56 19		     call    update_screen_text
ROM:18DF
ROM:18DF	     set_max_bomb_frequency:					     ; init bombing frequency to max
ROM:18DF 3E 08			     ld	     a,	#8
ROM:18E1 32 CF 20		     ld	     (bomb_frequency), a		     ; store
ROM:18E4 C3 EA 0A		     jp	     attract_mode_loop
ROM:18E7
ROM:18E7	     ; =============== S U B R O U T I N E =======================================
ROM:18E7
ROM:18E7
ROM:18E7	     get_ptr_num_ships_other_player:
ROM:18E7 3A 67 20		     ld	     a,	(ptr_curr_player_data)
ROM:18EA 21 E7 20		     ld	     hl, #num_men_p1			     ; num_men_p1
ROM:18ED 0F			     rrca					     ; curr player 2?
ROM:18EE D0			     ret     NC					     ; yes, exit
ROM:18EF 23			     inc     hl					     ; num_men_p2
ROM:18F0 C9			     ret
ROM:18F0	     ; End of function get_ptr_num_ships_other_player
ROM:18F0
ROM:18F1
ROM:18F1	     ; =============== S U B R O U T I N E =======================================
ROM:18F1
ROM:18F1
ROM:18F1	     check_only_1_invader_left:
ROM:18F1 06 02			     ld	     b,	#2
ROM:18F3 3A 82 20		     ld	     a,	(num_invaders_left)
ROM:18F6 3D			     dec     a					     ; more than 1 invader left?
ROM:18F7 C0			     ret     NZ					     ; yes, exit
ROM:18F8 04			     inc     b
ROM:18F9 C9			     ret
ROM:18F9	     ; End of function check_only_1_invader_left
ROM:18F9
ROM:18FA
ROM:18FA	     ; =============== S U B R O U T I N E =======================================
ROM:18FA
ROM:18FA
ROM:18FA	     start_port3_sound:
ROM:18FA 3A 94 20		     ld	     a,	(port3_sound_shadow_reg)
ROM:18FD B0			     or	     b
ROM:18FE 32 94 20		     ld	     (port3_sound_shadow_reg), a
ROM:1901 D3 03			     out     (3), a
ROM:1903 C9			     ret
ROM:1903	     ; End of function start_port3_sound
ROM:1903
ROM:1904
ROM:1904	     ; =============== S U B R O U T I N E =======================================
ROM:1904
ROM:1904
ROM:1904	     init_p2_invader_map:
ROM:1904 21 00 22		     ld	     hl, #p2_invader_map
ROM:1907 C3 C3 01		     jp	     init_invader_map
ROM:1907	     ; End of function init_p2_invader_map
ROM:1907
ROM:190A
ROM:190A	     ; =============== S U B R O U T I N E =======================================
ROM:190A
ROM:190A
ROM:190A	     update_player_bullet_invader_dir:
ROM:190A CD D8 14		     call    update_player_bullet
ROM:190D C3 97 15		     jp	     check_handle_invader_direction
ROM:190D	     ; End of function update_player_bullet_invader_dir
ROM:190D
ROM:1910
ROM:1910	     ; =============== S U B R O U T I N E =======================================
ROM:1910
ROM:1910
ROM:1910	     set_hl_num_ships_curr_player:
ROM:1910 21 E7 20		     ld	     hl, #num_men_p1			     ; number of ships left for	player 1
ROM:1913 3A 67 20		     ld	     a,	(ptr_curr_player_data)		     ; current player
ROM:1916 0F			     rrca					     ; player 1?
ROM:1917 D8			     ret     C					     ; yes, exit
ROM:1918 23			     inc     hl					     ; number ships left for player 2
ROM:1919 C9			     ret
ROM:1919	     ; End of function set_hl_num_ships_curr_player
ROM:1919
ROM:191A
ROM:191A	     ; =============== S U B R O U T I N E =======================================
ROM:191A
ROM:191A
ROM:191A	     draw_score_hdr:
ROM:191A 0E 1C			     ld	     c,	#0x1C				     ; length
ROM:191C 21 1E 24		     ld	     hl, # vram+0x1E			     ; screen loc
ROM:191F 11 E4 1A		     ld	     de, #message_score			     ; "SCORE <1> HI-SCORE SCORE <2>"
ROM:1922 C3 F3 08		     jp	     draw_str_hl_de_
ROM:1922	     ; End of function draw_score_hdr
ROM:1922
ROM:1925
ROM:1925	     ; =============== S U B R O U T I N E =======================================
ROM:1925
ROM:1925
ROM:1925	     draw_p1_score:
ROM:1925 21 F8 20		     ld	     hl, #p1_score			     ; p1 score
ROM:1928 C3 31 19		     jp	     draw_bcd_word_from_table
ROM:1928	     ; End of function draw_p1_score
ROM:1928
ROM:192B
ROM:192B	     ; =============== S U B R O U T I N E =======================================
ROM:192B
ROM:192B
ROM:192B	     draw_p2_score:
ROM:192B 21 FC 20		     ld	     hl, #p2_score			     ; p2 score
ROM:192E C3 31 19		     jp	     draw_bcd_word_from_table
ROM:1931
ROM:1931	     draw_bcd_word_from_table:
ROM:1931 5E			     ld	     e,	(hl)
ROM:1932 23			     inc     hl
ROM:1933 56			     ld	     d,	(hl)				     ; de = bcd	word
ROM:1934 23			     inc     hl
ROM:1935 7E			     ld	     a,	(hl)
ROM:1936 23			     inc     hl
ROM:1937 66			     ld	     h,	(hl)
ROM:1938 6F			     ld	     l,	a				     ; hl = screen loc
ROM:1939 C3 AD 09		     jp	     draw_bcd_word_de_
ROM:1939	     ; End of function draw_p2_score
ROM:1939
ROM:193C
ROM:193C	     ; =============== S U B R O U T I N E =======================================
ROM:193C
ROM:193C
ROM:193C	     print_CREDIT:
ROM:193C 0E 07			     ld	     c,	#7				     ; length
ROM:193E 21 01 35		     ld	     hl, # vram+0x1101			     ; screen loc
ROM:1941 11 A9 1F		     ld	     de, #aCREDIT			     ; "CREDIT "
ROM:1944 C3 F3 08		     jp	     draw_str_hl_de_
ROM:1944	     ; End of function print_CREDIT
ROM:1944
ROM:1947
ROM:1947	     ; =============== S U B R O U T I N E =======================================
ROM:1947
ROM:1947
ROM:1947	     draw_credits:
ROM:1947 3A EB 20		     ld	     a,	(num_credits)
ROM:194A 21 01 3C		     ld	     hl, # vram+0x1801
ROM:194D C3 B2 09		     jp	     draw_bcd_byte_a_
ROM:194D	     ; End of function draw_credits
ROM:194D
ROM:1950
ROM:1950	     ; =============== S U B R O U T I N E =======================================
ROM:1950
ROM:1950
ROM:1950	     draw_hi_score:
ROM:1950 21 F4 20		     ld	     hl, #hi_score
ROM:1953 C3 31 19		     jp	     draw_bcd_word_from_table
ROM:1953	     ; End of function draw_hi_score
ROM:1953
ROM:1956
ROM:1956	     ; =============== S U B R O U T I N E =======================================
ROM:1956
ROM:1956
ROM:1956	     update_screen_text:
ROM:1956 CD 5C 1A		     call    clear_screen
ROM:1959 CD 1A 19		     call    draw_score_hdr
ROM:195C CD 25 19		     call    draw_p1_score
ROM:195F CD 2B 19		     call    draw_p2_score
ROM:1962 CD 50 19		     call    draw_hi_score
ROM:1965 CD 3C 19		     call    print_CREDIT
ROM:1968 C3 47 19		     jp	     draw_credits
ROM:1968	     ; End of function update_screen_text
ROM:1968
ROM:196B	     ; ---------------------------------------------------------------------------
ROM:196B
ROM:196B	     play_sound_and_update_hi_score:
ROM:196B CD DC 19		     call    stop_port3_sound
ROM:196E C3 71 16		     jp	     update_hi_score
ROM:1971	     ; ---------------------------------------------------------------------------
ROM:1971
ROM:1971	     handle_invasion:						     ; flag invasion
ROM:1971 3E 01			     ld	     a,	#1
ROM:1973 32 6D 20		     ld	     (invaded),	a			     ; save
ROM:1976 C3 E6 16		     jp	     kill_player_and_end_game		     ; exit and	reset context
ROM:1979
ROM:1979	     ; =============== S U B R O U T I N E =======================================
ROM:1979
ROM:1979
ROM:1979	     draw_credit_display:
ROM:1979 CD D7 19		     call    disable_vblank_code
ROM:197C CD 47 19		     call    draw_credits
ROM:197F C3 3C 19		     jp	     print_CREDIT
ROM:197F	     ; End of function draw_credit_display
ROM:197F
ROM:1982
ROM:1982	     ; =============== S U B R O U T I N E =======================================
ROM:1982
ROM:1982
ROM:1982	     set_animation_type:
ROM:1982 32 C1 20		     ld	     (animation_type), a
ROM:1985 C9			     ret
ROM:1985	     ; End of function set_animation_type
ROM:1985
ROM:1985	     ; ---------------------------------------------------------------------------
ROM:1986 8B 19			     .dw 0x198B
ROM:1988
ROM:1988	     ; =============== S U B R O U T I N E =======================================
ROM:1988
ROM:1988
ROM:1988	     j_clear_visible_display:
ROM:1988 C3 D6 09		     jp	     clear_visible_display
ROM:1988	     ; End of function j_clear_visible_display
ROM:1988
ROM:198B	     ; ---------------------------------------------------------------------------
ROM:198B 21 03 28		     ld	     hl, # vram+0x403			     ; screen loc
ROM:198E 11 BE 19		     ld	     de, #aTAITOCORPORATION		     ; "TAITO CORPORATION"
ROM:1991 0E 13			     ld	     c,	#19				     ; length
ROM:1993 C3 F3 08		     jp	     draw_str_hl_de_
ROM:1996	     ; ---------------------------------------------------------------------------
ROM:1996 00			     nop
ROM:1997 00			     nop
ROM:1998 00			     nop
ROM:1999 00			     nop
ROM:199A
ROM:199A	     check_TAITO_easter_egg:
ROM:199A 3A 1E 20		     ld	     a,	(enable_taito_easter_egg)
ROM:199D A7			     and     a					     ; easter egg enabled?
ROM:199E C2 AC 19		     jp	     NZ, TAITO_easter_egg		     ; yes, handle
ROM:19A1 DB 01			     in	     a,	(1)				     ; read controller 1
ROM:19A3 E6 76			     and     #1110110b				     ; only interested in player controls
ROM:19A5 D6 72			     sub     #1110010b				     ; 2P+fire+left+right
ROM:19A7 C0			     ret     NZ
ROM:19A8 3C			     inc     a					     ; flag easter egg enabled
ROM:19A9 32 1E 20		     ld	     (enable_taito_easter_egg),	a
ROM:19AC
ROM:19AC	     TAITO_easter_egg:						     ; read controller 1
ROM:19AC DB 01			     in	     a,	(1)
ROM:19AE E6 76			     and     #1110110b				     ; only interested in player controls
ROM:19B0 FE 34			     cp	     #110100b				     ; 1P+fire+left
ROM:19B2 C0			     ret     NZ					     ; no - exit
ROM:19B3 21 1B 2E		     ld	     hl, # vram+0xA1B			     ; screen loc
ROM:19B6 11 F7 0B		     ld	     de, #aTAITOCOP			     ; "TAITO COP"
ROM:19B9 0E 09			     ld	     c,	#9				     ; length
ROM:19BB C3 F3 08		     jp	     draw_str_hl_de_
ROM:19BB	     ; ---------------------------------------------------------------------------
ROM:19BE 28	     aTAITOCORPORATION:.db 0x28	; (
ROM:19BF 13 00 08 13+		     .db 0x13, 0, 8, 0x13, 0xE,	0x26, 2, 0xE, 0x11, 0xF, 0xE ; "TAITO CORPORATION"
ROM:19BF 0E 26 02 0E+		     .db 0x11, 0, 0x13,	8, 0xE,	0xD
ROM:19D0 28			     .db 0x28 ;	(
ROM:19D1
ROM:19D1	     ; =============== S U B R O U T I N E =======================================
ROM:19D1
ROM:19D1
ROM:19D1	     do_enable_vblank_code:
ROM:19D1 3E 01			     ld	     a,	#1				     ; flag vblank code	enabled
ROM:19D3
ROM:19D3	     enable_disable_vblank_code:
ROM:19D3 32 E9 20		     ld	     (enable_vblank_code), a
ROM:19D6 C9			     ret
ROM:19D6	     ; End of function do_enable_vblank_code
ROM:19D6
ROM:19D7
ROM:19D7	     ; =============== S U B R O U T I N E =======================================
ROM:19D7
ROM:19D7
ROM:19D7	     disable_vblank_code:
ROM:19D7 AF			     xor     a					     ; flag vblank code	disabled
ROM:19D8 C3 D3 19		     jp	     enable_disable_vblank_code
ROM:19D8	     ; End of function disable_vblank_code
ROM:19D8
ROM:19DB	     ; ---------------------------------------------------------------------------
ROM:19DB 00			     nop
ROM:19DC
ROM:19DC	     ; =============== S U B R O U T I N E =======================================
ROM:19DC
ROM:19DC
ROM:19DC	     stop_port3_sound:
ROM:19DC 3A 94 20		     ld	     a,	(port3_sound_shadow_reg)
ROM:19DF A0			     and     b					     ; apply mask
ROM:19E0 32 94 20		     ld	     (port3_sound_shadow_reg), a	     ; save it
ROM:19E3 D3 03			     out     (3), a				     ; stop sound
ROM:19E5 C9			     ret
ROM:19E5	     ; End of function stop_port3_sound
ROM:19E5
ROM:19E6
ROM:19E6	     ; =============== S U B R O U T I N E =======================================
ROM:19E6
ROM:19E6
ROM:19E6	     draw_player_ships:
ROM:19E6 21 01 27		     ld	     hl, # vram+0x301
ROM:19E9 CA FA 19		     jp	     Z,	clr_ship_display		     ; no ships	to draw	- skip
ROM:19EC
ROM:19EC	     draw_player_ships_a_:					     ; player ship
ROM:19EC 11 60 1C		     ld	     de, #base
ROM:19EF 06 10			     ld	     b,	#0x10				     ; size
ROM:19F1 4F			     ld	     c,	a				     ; save num	ships
ROM:19F2 CD 39 14		     call    draw_simp_sprite
ROM:19F5 79			     ld	     a,	c				     ; restore num ships
ROM:19F6 3D			     dec     a					     ; next ship
ROM:19F7 C2 EC 19		     jp	     NZ, draw_player_ships_a_
ROM:19FA
ROM:19FA	     clr_ship_display:						     ; bitmap size
ROM:19FA 06 10			     ld	     b,	#0x10
ROM:19FC CD CB 14		     call    clear_small_sprite
ROM:19FF 7C			     ld	     a,	h
ROM:1A00 FE 35			     cp	     #53
ROM:1A02 C2 FA 19		     jp	     NZ, clr_ship_display
ROM:1A05 C9			     ret
ROM:1A05	     ; End of function draw_player_ships
ROM:1A05
ROM:1A06
ROM:1A06	     ; =============== S U B R O U T I N E =======================================
ROM:1A06
ROM:1A06
ROM:1A06	     sub_0_1A06:
ROM:1A06 21 72 20		     ld	     hl, #which_intr			     ; which interrupt?
ROM:1A09 46			     ld	     b,	(hl)				     ; b = RST8/10
ROM:1A0A 1A			     ld	     a,	(de)				     ; msb of vram addr
ROM:1A0B E6 80			     and     #0x80 ; '€'
ROM:1A0D A8			     xor     b
ROM:1A0E C0			     ret     NZ
ROM:1A0F 37			     scf
ROM:1A10 C9			     ret
ROM:1A10	     ; End of function sub_0_1A06
ROM:1A10
ROM:1A10	     ; ---------------------------------------------------------------------------
ROM:1A11	     ; table of	number of invaders left
ROM:1A11	     ; -to do with invader sound generation
ROM:1A11 32 2B 24 1C+byte_0_1A11:    .db 50, 43, 36, 28, 22, 17, 13, 10, 8, 7, 6, 5, 4,	3, 2
ROM:1A11 16 11 0D 0A+		     .db 1
ROM:1A21	     ; table of	entries	corresponding to above
ROM:1A21 34 2E 27 22+byte_0_1A21:    .db 52, 46, 39, 34, 28, 24, 21, 19, 16, 14, 13, 12, 11
ROM:1A21 1C 18 15 13+		     .db 9, 7, 5
ROM:1A31	     ; ---------------------------------------------------------------------------
ROM:1A31 FF			     rst     sub_0_38
ROM:1A32
ROM:1A32	     ; =============== S U B R O U T I N E =======================================
ROM:1A32
ROM:1A32
ROM:1A32	     memcpy_hl_de_b_:
ROM:1A32 1A			     ld	     a,	(de)
ROM:1A33 77			     ld	     (hl), a
ROM:1A34 23			     inc     hl
ROM:1A35 13			     inc     de
ROM:1A36 05			     dec     b
ROM:1A37
ROM:1A37	     loc_0_1A37:
ROM:1A37 C2 32 1A		     jp	     NZ, memcpy_hl_de_b_
ROM:1A3A C9			     ret
ROM:1A3A	     ; End of function memcpy_hl_de_b_
ROM:1A3A
ROM:1A3B
ROM:1A3B	     ; =============== S U B R O U T I N E =======================================
ROM:1A3B
ROM:1A3B
ROM:1A3B	     extract_DE_HL_B:
ROM:1A3B 5E			     ld	     e,	(hl)
ROM:1A3C 23			     inc     hl
ROM:1A3D 56			     ld	     d,	(hl)				     ; DE
ROM:1A3E 23			     inc     hl
ROM:1A3F 7E			     ld	     a,	(hl)				     ; then A -> L
ROM:1A40 23			     inc     hl
ROM:1A41 4E			     ld	     c,	(hl)				     ; then C -> H
ROM:1A42 23			     inc     hl
ROM:1A43 46			     ld	     b,	(hl)				     ; then B
ROM:1A44 61			     ld	     h,	c
ROM:1A45 6F			     ld	     l,	a
ROM:1A46 C9			     ret
ROM:1A46	     ; End of function extract_DE_HL_B
ROM:1A46
ROM:1A47
ROM:1A47	     ; =============== S U B R O U T I N E =======================================
ROM:1A47
ROM:1A47
ROM:1A47	     calc_vram_addr_from_pixel_offset:
ROM:1A47 C5			     push    bc
ROM:1A48 06 03			     ld	     b,	#3
ROM:1A4A
ROM:1A4A	     loc_0_1A4A:						     ; hl = graphic coordinate
ROM:1A4A 7C			     ld	     a,	h
ROM:1A4B 1F			     rra
ROM:1A4C 67			     ld	     h,	a
ROM:1A4D 7D			     ld	     a,	l
ROM:1A4E 1F			     rra
ROM:1A4F 6F			     ld	     l,	a
ROM:1A50 05			     dec     b
ROM:1A51 C2 4A 1A		     jp	     NZ, loc_0_1A4A			     ; calculate byte offset
ROM:1A54 7C			     ld	     a,	h
ROM:1A55 E6 3F			     and     #0x3F ; '?'
ROM:1A57 F6 20			     or	     #0x20 ; ' '                             ; adjust to vram base address
ROM:1A59 67			     ld	     h,	a
ROM:1A5A C1			     pop     bc
ROM:1A5B C9			     ret
ROM:1A5B	     ; End of function calc_vram_addr_from_pixel_offset
ROM:1A5B
ROM:1A5C
ROM:1A5C	     ; =============== S U B R O U T I N E =======================================
ROM:1A5C
ROM:1A5C
ROM:1A5C	     clear_screen:
ROM:1A5C 21 00 24		     ld	     hl, #vram				     ; video ram
ROM:1A5F
ROM:1A5F	     cls_loop:
ROM:1A5F 36 00			     ld	     (hl), #0
ROM:1A61 23			     inc     hl
ROM:1A62 7C			     ld	     a,	h
ROM:1A63 FE 40			     cp	     #0x40 ; '@'
ROM:1A65 C2 5F 1A		     jp	     NZ, cls_loop
ROM:1A68 C9			     ret
ROM:1A68	     ; End of function clear_screen
ROM:1A68
ROM:1A69
ROM:1A69	     ; =============== S U B R O U T I N E =======================================
ROM:1A69
ROM:1A69
ROM:1A69	     restore_1_shield:
ROM:1A69 C5			     push    bc
ROM:1A6A E5			     push    hl
ROM:1A6B
ROM:1A6B	     loc_0_1A6B:						     ; get shield data
ROM:1A6B 1A			     ld	     a,	(de)
ROM:1A6C B6			     or	     (hl)
ROM:1A6D 77			     ld	     (hl), a				     ; copy to screen
ROM:1A6E 13			     inc     de
ROM:1A6F 23			     inc     hl
ROM:1A70 0D			     dec     c					     ; done 1 row?
ROM:1A71 C2 6B 1A		     jp	     NZ, loc_0_1A6B			     ; no, loop
ROM:1A74 E1			     pop     hl					     ; screen loc
ROM:1A75 01 20 00		     ld	     bc, #0x20 ; ' '
ROM:1A78 09			     add     hl, bc				     ; next line
ROM:1A79 C1			     pop     bc
ROM:1A7A 05			     dec     b					     ; done all	rows in	shield?
ROM:1A7B C2 69 1A		     jp	     NZ, restore_1_shield		     ; no, loop
ROM:1A7E C9			     ret
ROM:1A7E	     ; End of function restore_1_shield
ROM:1A7E
ROM:1A7F
ROM:1A7F	     ; =============== S U B R O U T I N E =======================================
ROM:1A7F
ROM:1A7F
ROM:1A7F	     show_ships_left:
ROM:1A7F CD 2E 09		     call    get_curr_player_num_ships
ROM:1A82 A7			     and     a
ROM:1A83 C8			     ret     Z
ROM:1A84 F5			     push    af					     ; save num	ships
ROM:1A85 3D			     dec     a					     ; drawing one less	(extra ships left)
ROM:1A86 77			     ld	     (hl), a				     ; save num	ships
ROM:1A87 CD E6 19		     call    draw_player_ships
ROM:1A8A F1			     pop     af					     ; restore num ships
ROM:1A8B
ROM:1A8B	     prt_num_ships_left:
ROM:1A8B 21 01 25		     ld	     hl, # vram+0x101
ROM:1A8E E6 0F			     and     #0xF
ROM:1A90 C3 C5 09		     jp	     draw_ascii_digit
ROM:1A90	     ; End of function show_ships_left
ROM:1A90
ROM:1A90	     ; ---------------------------------------------------------------------------
ROM:1A93 00			     .db    0
ROM:1A94 00			     .db    0
ROM:1A95 00	     byte_0_1A95:    .db 0					     ; inverted-y animation pt.1 data
ROM:1A96 00			     .db 0
ROM:1A97 FF			     .db 0xFF
ROM:1A98 B8			     .db 0xB8
ROM:1A99 FE			     .db 0xFE
ROM:1A9A 20 1C			     .dw byte_0_1C20
ROM:1A9C 10			     .db 0x10
ROM:1A9D 9E			     .db 0x9E
ROM:1A9E 00			     .db 0
ROM:1A9F 20 1C			     .dw byte_0_1C20
ROM:1AA1 30 10 0B 08+bomb_freq_tbl:  .db 48, 16, 11, 8,	7			     ; table of	bomb frequency counters
ROM:1AA6	     ; "GAME OVER PLAYER < >"
ROM:1AA6 06 00 0C 04+message_g_over: .db 6, 0, 0xC, 4, 0x26, 0xE, 0x15,	4, 0x11, 0x26, 0x26
ROM:1AA6 26 0E 15 04+		     .db 0xF, 0xB, 0, 0x18, 4, 0x11, 0x24, 0x26, 0x25
ROM:1ABA	     ; "1 OR 2PLAYERS BUTTON"
ROM:1ABA 1B 26 0E 11+message_b_1_or_2:.db 0x1B,	0x26, 0xE, 0x11, 0x26, 0x1C, 0xF, 0xB, 0, 0x18
ROM:1ABA 26 1C 0F 0B+		     .db 4, 0x11, 0x12,	0x26, 1, 0x14, 0x13, 0x13, 0xE,	0xD
ROM:1ABA 00 18 04 11+		     .db 0x26
ROM:1ACF	     ; "ONLY 1 PLAYER BUTTON"
ROM:1ACF 0E 0D 0B 18+message_1_only: .db 0xE,0xD,0xB,0x18,0x26,0x1B,0xF,0xB
ROM:1ACF 26 1B 0F 0B+		     .db 0,0x18,4,0x11,0x26,0x26,1,0x14
ROM:1ACF 00 18 04 11+		     .db 0x13,0x13,0xE,0xD,0x26
ROM:1AE4	     ; " SCORE<1> HI-SCORE SCORE<2> "
ROM:1AE4 26 12 02 0E+message_score:  .db 0x26,0x12,2,0xE,0x11,4,0x24,0x1B,0x25,0x26,7,8,0x3F
ROM:1AE4 11 04 24 1B+		     .db 0x12,2,0xE,0x11,4,0x26,0x12,2,0xE,0x11,4,0x24,0x1C
ROM:1AE4 25 26 07 08+		     .db 0x25,0x26
ROM:1B00	     ; this data is copied to RAM
ROM:1B00 01 00 00 10+byte_0_1B00:    .db 1,0,0,0x10,0,0,0,0
ROM:1B00 00 00 00 00+		     .db 2,0x78,0x38,0x78,0x38,0,0xF8,0
ROM:1B00 02 78 38 78+		     .db 0,0x80,0,0x8E,2,0xFF,5,0xC
ROM:1B00 38 00 F8 00+		     .db 0x60,0x1C,0x20,0x30,0x10,1,0,0
ROM:1B00 00 80 00 8E+		     .db 0,0,0,0xBB,3,0,0x10,0x90
ROM:1B00 02 FF 05 0C+		     .db 0x1C,0x28,0x30,1,4,0,0xFF,0xFF
ROM:1B00 60 1C 20 30+		     .db 0,0,2,0x76,4,0,0,0
ROM:1B00 10 01 00 00+		     .db 0,0,4,0xEE,0x1C,0,0,3
ROM:1B00 00 00 00 BB+		     .db 0,0,0,0xB6,4,0,0,1
ROM:1B00 03 00 10 90+		     .db 0,0x1D,4,0xE2,0x1C,0,0,3
ROM:1B00 1C 28 30 01+		     .db 0,0,0,0x82,6,0,0,1
ROM:1B00 04 00 FF FF+		     .db 6,0x1D,4,0xD0,0x1C,0,0,3
ROM:1B00 00 00 02 76+		     .db 0xFF,0,0xC0,0x1C,0,0,0x10,0x21
ROM:1B00 04 00 00 00+		     .db 1,0,0x30,0,0x12,0,0,0
ROM:1B70 0F 0B 00 18+aPLAYPLAYER1:   .db 0xF,0xB,0,0x18,0x26,0xF,0xB,0
ROM:1B70 26 0F 0B 00+		     .db 0x18,4,0x11,0x24,0x1B,0x25,0xFC,0
ROM:1B80 01			     .db    1
ROM:1B81 FF			     .db 0xFF
ROM:1B82 FF			     .db 0xFF
ROM:1B83 00	     ufo_init_data:  .db 0					     ; ufo visible flag
ROM:1B84 00			     .db    0
ROM:1B85 00			     .db    0
ROM:1B86 20			     .db 32					     ; countdown after ufo hit
ROM:1B87 64 1D			     .dw unk_0_1D64				     ; ufo bitmap address
ROM:1B89 D0 29			     .dw vram+0x5D0				     ; ufo screen loc
ROM:1B8B 18			     .db 24					     ; ufo bitmap size
ROM:1B8C 02			     .db    2
ROM:1B8D 54			     .db 0x54 ;	T
ROM:1B8E 1D			     .db 0x1D
ROM:1B8F 00 08			     .dw 0x800					     ; ptr to code - of	which b0 determines which side ufo appears
ROM:1B91 00			     .db    0
ROM:1B92 06			     .db    6
ROM:1B93 00			     .db    0
ROM:1B94 00			     .db    0
ROM:1B95 01			     .db    1
ROM:1B96 40			     .db 0x40 ;	@
ROM:1B97 00			     .db    0
ROM:1B98 01			     .db    1
ROM:1B99 00			     .db    0
ROM:1B9A 00			     .db    0
ROM:1B9B 10			     .db 0x10
ROM:1B9C 9E			     .db 0x9E ;	ž
ROM:1B9D 00			     .db    0
ROM:1B9E 20			     .db 0x20
ROM:1B9F 1C			     .db 0x1C
ROM:1BA0	     ; Alien sprite type C pulling upside down Y
ROM:1BA0 00 03 04 78+alien_spr_CYA:  .db 0,3,4,0x78,0x14,0x13,8,0x1A
ROM:1BA0 14 13 08 1A+		     .db 0x3D,0x68,0xFC,0xFC,0x68,0x3D,0x1A,0
ROM:1BB0 00	     byte_0_1BB0:    .db 0
ROM:1BB1 00			     .db 0
ROM:1BB2 01			     .db 1
ROM:1BB3 B8			     .db 0xB8
ROM:1BB4 98			     .db 0x98
ROM:1BB5 A0 1B			     .dw alien_spr_CYA
ROM:1BB7 10			     .db 0x10
ROM:1BB8 FF			     .db 0xFF
ROM:1BB9 00			     .db 0
ROM:1BBA A0 1B			     .dw alien_spr_CYA
ROM:1BBC 00			     .db    0
ROM:1BBD 00			     .db    0
ROM:1BBE 00			     .db    0
ROM:1BBF 00			     .db    0
ROM:1BC0	     ; sqiggly shot descriptor
ROM:1BC0	     ; gets copied to $2050 ($6050) overwriting	value from init
ROM:1BC0 00 10	     word_0_1BC0:    .dw 0x1000					     ; initialised only	at startup
ROM:1BC2 00			     .db 0
ROM:1BC3 0E 05			     .dw game_obj_4
ROM:1BC5 00			     .db 0
ROM:1BC6 00			     .db 0
ROM:1BC7 00			     .db 0
ROM:1BC8 00 00			     .dw 0
ROM:1BCA 07			     .db 7
ROM:1BCB D0 1C			     .dw squiggly_shot
ROM:1BCD C8			     .db 0xC8 ;	È
ROM:1BCE 9B			     .db 0x9B ;	›
ROM:1BCF 03			     .db    3
ROM:1BD0	     ; Alien sprite C pulling upside down Y. Note the difference between this and the first picture
ROM:1BD0	     ; above. The Y is closer to the ship. This	gives the effect of the	Y kind of "sticking" in	the
ROM:1BD0	     ; animation.
ROM:1BD0 00 00 03 04+alien_spr_CYB:  .db 0, 0, 3, 4, 0x78, 0x14, 0xB, 0x19
ROM:1BD0 78 14 0B 19+		     .db 0x3A, 0x6D, 0xFA, 0xFA, 0x6D, 0x3A, 0x19, 0
ROM:1BE0 00			     .db    0
ROM:1BE1 00			     .db    0
ROM:1BE2 00			     .db    0
ROM:1BE3 00			     .db    0
ROM:1BE4 00			     .db    0
ROM:1BE5 00			     .db    0
ROM:1BE6 00			     .db    0
ROM:1BE7 00			     .db    0
ROM:1BE8 00			     .db    0
ROM:1BE9 01			     .db    1
ROM:1BEA 00			     .db    0
ROM:1BEB 00			     .db    0
ROM:1BEC 01			     .db    1
ROM:1BED 74			     .db 0x74 ;	t
ROM:1BEE 1F			     .db 0x1F
ROM:1BEF 00			     .db    0
ROM:1BF0 80			     .db 0x80 ;	€
ROM:1BF1 00			     .db    0
ROM:1BF2 00			     .db    0
ROM:1BF3 00			     .db    0
ROM:1BF4 00 00			     .db 0, 0
ROM:1BF6 1C 2F			     .dw vram+0xB1C
ROM:1BF8 00 00			     .db 0, 0
ROM:1BFA 1C 27			     .dw vram+0x31C
ROM:1BFC 00 00			     .db 0, 0
ROM:1BFE 1C 39			     .dw vram+0x151C
ROM:1C00 00 00 39 79+gfx_table:	     .db 0, 0, 0x39, 0x79, 0x7A, 0x6E, 0xEC, 0xFA, 0xFA, 0xEC ;	10 pt invader #1
ROM:1C00 7A 6E EC FA+		     .db 0x6E, 0x7A, 0x79, 0x39, 0, 0
ROM:1C10 00 00 00 78+		     .db 0, 0, 0, 0x78,	0x1D, 0xBE, 0x6C, 0x3C,	0x3C, 0x3C ; 20	pt invader #1
ROM:1C10 1D BE 6C 3C+		     .db 0x6C, 0xBE, 0x1D, 0x78, 0, 0
ROM:1C20 00 00 00 00+byte_0_1C20:    .db 0, 0, 0, 0, 0x19, 0x3A, 0x6D, 0xFA, 0xFA, 0x6D, 0x3A ;	30 pt invader #1
ROM:1C20 19 3A 6D FA+		     .db 0x19, 0, 0, 0,	0
ROM:1C30 00 00 38 7A+		     .db 0, 0, 0x38, 0x7A, 0x7F, 0x6D, 0xEC, 0xFA, 0xFA, 0xEC ;	10 pt invader #2
ROM:1C30 7F 6D EC FA+		     .db 0x6D, 0x7F, 0x7A, 0x38, 0, 0
ROM:1C40 00 00 00 0E+byte_0_1C40:    .db 0, 0, 0, 0xE, 0x18, 0xBE, 0x6D, 0x3D, 0x3C, 0x3D, 0x6D	; 20 pt	invader	#2
ROM:1C40 18 BE 6D 3D+		     .db 0xBE, 0x18, 0xE, 0, 0
ROM:1C50 00 00 00 00+		     .db 0, 0, 0, 0, 0x1A, 0x3D, 0x68, 0xFC, 0xFC, 0x68, 0x3D ;	30 pt invader #2
ROM:1C50 1A 3D 68 FC+		     .db 0x1A, 0, 0, 0,	0
ROM:1C60 00 00 0F 1F+base:	     .db 0, 0, 0xF, 0x1F, 0x1F,	0x1F, 0x1F, 0x7F, 0xFF,	0x7F ; player ship
ROM:1C60 1F 1F 1F 7F+		     .db 0x1F, 0x1F, 0x1F, 0x1F, 0xF, 0
ROM:1C70 00 04 01 13+explosion_1:    .db 0, 4, 1, 0x13,	3, 7, 0xB3, 0xF, 0x2F, 3, 0x2F,	0x49, 4, 3, 0, 1 ; ship	explosion #1
ROM:1C80 40 08 05 A3+		     .db 0x40, 8, 5, 0xA3, 0xA,	3, 0x5B, 0xF, 0x27, 0x27, 0xB, 0x4B, 0x40, 0x84, 0x11, 0x48 ; ship explosion #2
ROM:1C90 0F			     .db  0xF
ROM:1C91 99			     .db 0x99 ;	™
ROM:1C92 3C			     .db 0x3C ;	<
ROM:1C93 7E			     .db 0x7E ;	~
ROM:1C94 3D			     .db 0x3D ;	=
ROM:1C95 BC			     .db 0xBC ;	¼
ROM:1C96 3E			     .db 0x3E ;	>
ROM:1C97 7C			     .db 0x7C ;	|
ROM:1C98 99			     .db 0x99 ;	™
ROM:1C99 27 1B 1A 26+byte_0_1C99:    .db 0x27, 0x1B, 0x1A, 0x26, 0xF, 0xE, 8, 0xD, 0x13, 0x12 ;	"=10 POINTS"
ROM:1CA3 28	     aSCOREADVANCETABLE:.db 0x28 ; (
ROM:1CA4 12 02 0E 11+		     .db 0x12, 2, 0xE, 0x11, 4,	0x26, 0, 3, 0x15, 0, 0xD, 2 ; "SCORE ADVANCE TABLE"
ROM:1CA4 04 26 00 03+		     .db 4, 0x26, 0x13,	0, 1, 0xB, 4
ROM:1CB7 28			     .db 0x28 ;	(
ROM:1CB8 02 10 20 30 byte_0_1CB8:    .db 2, 0x10, 0x20,	0x30			     ; table of	scores at which	bomb frequency increases
ROM:1CB8									     ; -200, 1000, 2000, 3000
ROM:1CBC 13 08 0B 13 aTILT:	     .db 0x13, 8, 0xB, 0x13			     ; "TILT"
ROM:1CC0 00 08 49 22+		     .db 0, 8, 0x49, 0x22, 0x14, 0x81, 0x42, 0,	0x42, 0x81, 0x14, 0x22,	0x49, 8, 0, 0 ;	invader	explosion
ROM:1CD0 44	     squiggly_shot:  .db 0x44 ;	D
ROM:1CD1 AA			     .db 0xAA ;	ª
ROM:1CD2 10			     .db 0x10
ROM:1CD3 88			     .db 0x88 ;	ˆ
ROM:1CD4 54			     .db 0x54 ;	T
ROM:1CD5 22			     .db 0x22 ;	"
ROM:1CD6 10			     .db 0x10
ROM:1CD7 AA			     .db 0xAA ;	ª
ROM:1CD8 44			     .db 0x44 ;	D
ROM:1CD9 22			     .db 0x22 ;	"
ROM:1CDA 54			     .db 0x54 ;	T
ROM:1CDB 88			     .db 0x88 ;	ˆ
ROM:1CDC 4A			     .db 0x4A ;	J
ROM:1CDD 15			     .db 0x15
ROM:1CDE BE			     .db 0xBE ;	¾
ROM:1CDF 3F			     .db 0x3F ;	?
ROM:1CE0 5E			     .db 0x5E ;	^
ROM:1CE1 25			     .db 0x25 ;	%
ROM:1CE2 04			     .db    4
ROM:1CE3 FC			     .db 0xFC ;	ü
ROM:1CE4 04			     .db    4
ROM:1CE5 10			     .db 0x10
ROM:1CE6 FC			     .db 0xFC ;	ü
ROM:1CE7 10			     .db 0x10
ROM:1CE8 20			     .db 0x20
ROM:1CE9 FC			     .db 0xFC ;	ü
ROM:1CEA 20			     .db 0x20
ROM:1CEB 80			     .db 0x80 ;	€
ROM:1CEC FC			     .db 0xFC ;	ü
ROM:1CED 80			     .db 0x80 ;	€
ROM:1CEE 00			     .db    0
ROM:1CEF FE			     .db 0xFE ;	þ
ROM:1CF0 00			     .db    0
ROM:1CF1 24			     .db 0x24 ;	$
ROM:1CF2 FE			     .db 0xFE ;	þ
ROM:1CF3 12			     .db 0x12
ROM:1CF4 00			     .db    0
ROM:1CF5 FE			     .db 0xFE ;	þ
ROM:1CF6 00			     .db    0
ROM:1CF7 48			     .db 0x48 ;	H
ROM:1CF8 FE			     .db 0xFE ;	þ
ROM:1CF9 90			     .db 0x90 ;	
ROM:1CFA 0F 0B 00 29 message_play_UY:.db 0xF, 0xB, 0, 0x29			     ; "PLAY" with inverted Y
ROM:1CFE 00			     .db    0
ROM:1CFF 00			     .db    0
ROM:1D00 01 07 01 01+col_fire_table: .db 1, 7, 1, 1, 1,	4, 0xB,	1		     ; table of	columns	to drop	bomb
ROM:1D00 01 04 0B 01+		     .db 6, 3, 1, 1, 0xB, 9, 2,	8		     ; - (pseudo-random	series)
ROM:1D00 06 03 01 01+		     .db 2, 0xB, 4, 7, 0xA
ROM:1D15 05			     .db    5
ROM:1D16 02			     .db    2
ROM:1D17 05			     .db    5
ROM:1D18 04			     .db    4
ROM:1D19 06			     .db    6
ROM:1D1A 07			     .db    7
ROM:1D1B 08			     .db    8
ROM:1D1C 0A			     .db  0xA
ROM:1D1D 06			     .db    6
ROM:1D1E 0A			     .db  0xA
ROM:1D1F 03			     .db    3
ROM:1D20 FF 0F FF 1F+shield_gfx_data:.db 0xFF, 0xF, 0xFF, 0x1F,	0xFF, 0x3F, 0xFF, 0x7F,	0xFF ; shield data
ROM:1D20 FF 3F FF 7F+		     .db 0xFF, 0xFC, 0xFF, 0xF8, 0xFF, 0xF0, 0xFF, 0xF0, 0xFF
ROM:1D20 FF FF FC FF+		     .db 0xF0, 0xFF, 0xF0, 0xFF, 0xF0, 0xFF, 0xF0, 0xFF, 0xF0
ROM:1D20 F8 FF F0 FF+		     .db 0xFF, 0xF8, 0xFF, 0xFC, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF
ROM:1D20 F0 FF F0 FF+		     .db 0xFF, 0x7F, 0xFF, 0x3F, 0xFF, 0x1F, 0xFF, 0xF
ROM:1D4C 05 10 15 30 ufo_score_tbl:  .db 5, 0x10, 0x15,	0x30			     ; table of	UFO points (/100)
ROM:1D50 94 97 9A 9D byte_0_1D50:    .db 0x94, 0x97, 0x9A, 0x9D			     ; table of	corresponding bitmap addresses (lsb)
ROM:1D54 10			     .db 0x10
ROM:1D55 05			     .db    5
ROM:1D56 05			     .db    5
ROM:1D57 10			     .db 0x10
ROM:1D58 15			     .db 0x15
ROM:1D59 10			     .db 0x10
ROM:1D5A 10			     .db 0x10
ROM:1D5B 05			     .db    5
ROM:1D5C 30			     .db 0x30 ;	0
ROM:1D5D 10			     .db 0x10
ROM:1D5E 10			     .db 0x10
ROM:1D5F 10			     .db 0x10
ROM:1D60 05			     .db    5
ROM:1D61 15			     .db 0x15
ROM:1D62 10			     .db 0x10
ROM:1D63 05			     .db    5
ROM:1D64 00	     unk_0_1D64:     .db    0
ROM:1D65 00			     .db    0
ROM:1D66 00			     .db    0
ROM:1D67 00			     .db    0
ROM:1D68 04 0C 1E 37+byte_0_1D68:    .db 4, 0xC, 0x1E, 0x37, 0x3E, 0x7C, 0x74, 0x7E, 0x7E, 0x74	; UFO
ROM:1D68 3E 7C 74 7E+		     .db 0x7C, 0x3E, 0x37, 0x1E, 0xC, 4
ROM:1D78 00 00 00 00		     .db 0, 0, 0, 0				     ; (nothing?)
ROM:1D7C 00 22 00 A5+byte_0_1D7C:    .db 0, 0x22, 0, 0xA5, 0x40, 8, 0x98, 0x3D,	0xB6, 0x3C ; UFO explosion bitmap
ROM:1D7C 40 08 98 3D+		     .db 0x36, 0x1D, 0x10, 0x48, 0x62, 0xB6, 0x1D, 0x98, 8
ROM:1D7C B6 3C 36 1D+		     .db 0x42, 0x90, 8,	0, 0
ROM:1D94 26 1F 1A    ufo_score_text_table:.db 0x26, 0x1F, 0x1A			     ; " 50"
ROM:1D97 1B 1A 1A		     .db 0x1B, 0x1A, 0x1A			     ; "100"
ROM:1D9A 1B 1F 1A		     .db 0x1B, 0x1F, 0x1A			     ; "150"
ROM:1D9D 1D 1A 1A		     .db 0x1D, 0x1A, 0x1A			     ; "500"
ROM:1DA0 10	     invader_points_table:.db 0x10				     ; 10 points (BCD)
ROM:1DA1 20			     .db 0x20
ROM:1DA2 30	     unk_0_1DA2:     .db 0x30 ;	0				     ; 30 points (BCD)
ROM:1DA3 60 50 48 48+		     .db 96, 80, 72, 72, 72, 64, 64, 64		     ; table of	starting invader y coords
ROM:1DAB 0F 0B 00 18 aPLAYSPACEINVADERS:.db 0xF, 0xB, 0, 0x18			     ; "PLAYSPACE  INVADERS"
ROM:1DAF 12 0F 00 02+message_invaders:.db 0x12,	0xF, 0,	2, 4, 0x26, 0x26, 8, 0xD, 0x15,	0, 3
ROM:1DAF 04 26 26 08+		     .db 4, 0x11, 0x12
ROM:1DBE 0E 2C	     off_0_1DBE:     .dw vram+0x80E				     ; screen loc for ufo on score table
ROM:1DC0 68 1D			     .dw byte_0_1D68				     ; ptr ufo bitmap
ROM:1DC2 0C 2C			     .dw vram+0x80C				     ; screen loc for 30 pt invader
ROM:1DC4 20 1C			     .dw byte_0_1C20				     ; ptr 30 pt invader bitmap
ROM:1DC6 0A 2C			     .dw vram+0x80A				     ; screen loc for 20 pt invader
ROM:1DC8 40 1C			     .dw byte_0_1C40				     ; ptr 20 pt invader bitmap
ROM:1DCA 08 2C			     .dw vram+0x808				     ; screen loc for 10 pt invader
ROM:1DCC 00 1C			     .dw gfx_table				     ; ptr 10 pt nvader	bitmap
ROM:1DCE FF			     .db 0xFF					     ; end of table marker
ROM:1DCF 0E 2E			     .dw vram+0xA0E				     ; screen loc for following	string
ROM:1DD1 E0 1D			     .dw byte_0_1DE0				     ; "=? MYSTERY"
ROM:1DD3 0C 2E			     .dw vram+0xA0C				     ; screen loc for following	string
ROM:1DD5 EA 1D			     .dw byte_0_1DEA				     ; "=30 POINTS"
ROM:1DD7 0A 2E			     .dw vram+0xA0A				     ; screen loc for following	string
ROM:1DD9 F4 1D			     .dw byte_0_1DF4				     ; "=20 POINTS"
ROM:1DDB 08 2E			     .dw vram+0xA08				     ; screen loc for following	string
ROM:1DDD 99 1C			     .dw byte_0_1C99				     ; "=10 POINTS"
ROM:1DDF FF			     .db 0xFF					     ; end of table marker
ROM:1DE0 27 38 26 0C+byte_0_1DE0:    .db 0x27, 0x38, 0x26, 0xC,	0x18, 0x12, 0x13, 4, 0x11, 0x18	; "=? MYSTERY"
ROM:1DEA 27 1D 1A 26+byte_0_1DEA:    .db 0x27, 0x1D, 0x1A, 0x26, 0xF, 0xE, 8, 0xD, 0x13, 0x12 ;	"=30 POINTS"
ROM:1DF4 27 1C 1A 26+byte_0_1DF4:    .db 0x27, 0x1C, 0x1A, 0x26, 0xF, 0xE, 8, 0xD, 0x13, 0x12 ;	"=20 POINTS"
ROM:1DFE 00			     .db    0
ROM:1DFF 00			     .db    0
ROM:1E00 00 1F 24 44+bitmap_table:   .db 0, 0x1F, 0x24,	0x44, 0x24, 0x1F, 0, 0	     ; "A"
ROM:1E08 00 7F 49 49+		     .db 0, 0x7F, 0x49,	0x49, 0x49, 0x36, 0, 0	     ; "B"
ROM:1E10 00 3E 41 41+		     .db 0, 0x3E, 0x41,	0x41, 0x41, 0x22, 0, 0	     ; "C"
ROM:1E18 00 7F 41 41+		     .db 0, 0x7F, 0x41,	0x41, 0x41, 0x3E, 0, 0	     ; "D"
ROM:1E20 00 7F 49 49+		     .db 0, 0x7F, 0x49,	0x49, 0x49, 0x41, 0, 0	     ; "E"
ROM:1E28 00 7F 48 48+		     .db 0, 0x7F, 0x48,	0x48, 0x48, 0x40, 0, 0	     ; "F"
ROM:1E30 00 3E 41 41+		     .db 0, 0x3E, 0x41,	0x41, 0x45, 0x47, 0, 0	     ; "G"
ROM:1E38 00 7F 08 08+		     .db 0, 0x7F, 8, 8,	8, 0x7F, 0, 0		     ; "H"
ROM:1E40 00 00 41 7F+		     .db 0, 0, 0x41, 0x7F, 0x41, 0, 0, 0	     ; "I"
ROM:1E48 00 02 01 01+		     .db 0, 2, 1, 1, 1,	0x7E, 0, 0		     ; "J"
ROM:1E50 00 7F 08 14+		     .db 0, 0x7F, 8, 0x14, 0x22, 0x41, 0, 0	     ; "K"
ROM:1E58 00 7F 01 01+		     .db 0, 0x7F, 1, 1,	1, 1, 0, 0		     ; "L"
ROM:1E60 00 7F 20 18+		     .db 0, 0x7F, 0x20,	0x18, 0x20, 0x7F, 0, 0	     ; "M"
ROM:1E68 00 7F 10 08+		     .db 0, 0x7F, 0x10,	8, 4, 0x7F, 0, 0	     ; "N"
ROM:1E70 00 3E 41 41+		     .db 0, 0x3E, 0x41,	0x41, 0x41, 0x3E, 0, 0	     ; "O"
ROM:1E78 00 7F 48 48+		     .db 0, 0x7F, 0x48,	0x48, 0x48, 0x30, 0, 0	     ; "P"
ROM:1E80 00 3E 41 45+		     .db 0, 0x3E, 0x41,	0x45, 0x42, 0x3D, 0, 0	     ; "Q"
ROM:1E88 00 7F 48 4C+		     .db 0, 0x7F, 0x48,	0x4C, 0x4A, 0x31, 0, 0	     ; "R"
ROM:1E90 00 32 49 49+		     .db 0, 0x32, 0x49,	0x49, 0x49, 0x26, 0, 0	     ; "S"
ROM:1E98 00 40 40 7F+		     .db 0, 0x40, 0x40,	0x7F, 0x40, 0x40, 0, 0	     ; "T"
ROM:1EA0 00 7E 01 01+		     .db 0, 0x7E, 1, 1,	1, 0x7E, 0, 0		     ; "U"
ROM:1EA8 00 7C 02 01+		     .db 0, 0x7C, 2, 1,	2, 0x7C, 0, 0		     ; "V"
ROM:1EB0 00 7F 02 0C+		     .db 0, 0x7F, 2, 0xC, 2, 0x7F, 0, 0		     ; "W"
ROM:1EB8 00 63 14 08+		     .db 0, 0x63, 0x14,	8, 0x14, 0x63, 0, 0	     ; "X"
ROM:1EC0 00 60 10 0F+		     .db 0, 0x60, 0x10,	0xF, 0x10, 0x60, 0, 0	     ; "Y"
ROM:1EC8 00 43 45 49+		     .db 0, 0x43, 0x45,	0x49, 0x51, 0x61, 0, 0	     ; "Z"
ROM:1ED0 00 3E 45 49+		     .db 0, 0x3E, 0x45,	0x49, 0x51, 0x3E, 0, 0	     ; "0"
ROM:1ED8 00 00 21 7F+		     .db 0, 0, 0x21, 0x7F, 1, 0, 0, 0		     ; "1"
ROM:1EE0 00 23 45 49+		     .db 0, 0x23, 0x45,	0x49, 0x49, 0x31, 0, 0	     ; "2"
ROM:1EE8 00 42 41 49+		     .db 0, 0x42, 0x41,	0x49, 0x59, 0x66, 0, 0	     ; "3"
ROM:1EF0 00 0C 14 24+		     .db 0, 0xC, 0x14, 0x24, 0x7F, 4, 0, 0	     ; "4"
ROM:1EF8 00 72 51 51+		     .db 0, 0x72, 0x51,	0x51, 0x51, 0x4E, 0, 0	     ; "5"
ROM:1F00 00 1E 29 49+		     .db 0, 0x1E, 0x29,	0x49, 0x49, 0x46, 0, 0	     ; "6"
ROM:1F08 00 40 47 48+		     .db 0, 0x40, 0x47,	0x48, 0x50, 0x60, 0, 0	     ; "7"
ROM:1F10 00 36 49 49+		     .db 0, 0x36, 0x49,	0x49, 0x49, 0x36, 0, 0	     ; "8"
ROM:1F18 00 31 49 49+		     .db 0, 0x31, 0x49,	0x49, 0x4A, 0x3C, 0, 0	     ; "9"
ROM:1F20 00 08 14 22+		     .db 0, 8, 0x14, 0x22, 0x41, 0, 0, 0	     ; "<"
ROM:1F28 00 00 41 22+		     .db 0, 0, 0x41, 0x22, 0x14, 8, 0, 0	     ; ">"
ROM:1F30 00 00 00 00+		     .db 0, 0, 0, 0, 0,	0, 0, 0			     ; " "
ROM:1F38 00 14 14 14+		     .db 0, 0x14, 0x14,	0x14, 0x14, 0x14, 0, 0	     ; "="
ROM:1F40 00 22 14 7F+		     .db 0, 0x22, 0x14,	0x7F, 0x14, 0x22, 0, 0	     ; "*"
ROM:1F48 00 03 04 78+		     .db 0, 3, 4, 0x78,	4, 3, 0, 0		     ; "Y (inverted)" (chr $29)
ROM:1F50 24	     a1OR2PLAYERS:   .db 0x24 ;	$
ROM:1F51 1B 26 0E 11+		     .db 0x1B, 0x26, 0xE, 0x11,	0x26, 0x1C, 0x26, 0xF, 0xB ; "1	OR 2 PLAYERS"
ROM:1F51 26 1C 26 0F+		     .db 0, 0x18, 4, 0x11, 0x12
ROM:1F5F 25			     .db 0x25 ;	%
ROM:1F60 26			     .db 0x26 ;	&
ROM:1F61 26			     .db 0x26 ;	&
ROM:1F62 28	     a1PLAYER1COIN:  .db 0x28 ;	(
ROM:1F63 1B 26 0F 0B+		     .db 0x1B, 0x26, 0xF, 0xB, 0, 0x18,	4, 0x11, 0x26, 0x26 ; "1 PLAYER	 1 COIN"
ROM:1F63 00 18 04 11+		     .db 0x1B, 0x26, 2,	0xE, 8,	0xD, 0x26
ROM:1F74 01 01 00 00+demo_logic_table:.db 1, 1,	0, 0, 1, 0, 2, 1, 0, 2,	1, 0	     ; simulated controller reads
ROM:1F80 60 10 0F 10+		     .db 0x60, 0x10, 0xF, 0x10,	0x60, 0x30, 0x18, 0x1A,	0x3D ; letter Y	w/invader legs open
ROM:1F80 60 30 18 1A+		     .db 0x68, 0xFC, 0xFC, 0x68, 0x3D, 0x1A, 0
ROM:1F90 08 0D 12 04+aINSERTCOIN:    .db 8, 0xD, 0x12, 4, 0x11,	0x13, 0x26, 0x26, 2, 0xE, 8 ; "INSERT  COIN"
ROM:1F90 11 13 26 26+		     .db 0xD
ROM:1F9C 0D 2A	     credit_tbl:     .dw vram+0x60D				     ; screen loc
ROM:1F9E 50 1F			     .dw a1OR2PLAYERS				     ; "<1 OR 2	PLAYERS>
ROM:1FA0 0A 2A			     .dw vram+0x60A				     ; screen loc
ROM:1FA2 62 1F			     .dw a1PLAYER1COIN				     ; "*1 PLAYER 1  COIN"
ROM:1FA4 07 2A			     .dw vram+0x607				     ; screen loc
ROM:1FA6 E1 1F			     .dw a2PLAYERS2COINS			     ; "*2 PLAYERS 2 COINS"
ROM:1FA8 FF			     .db 0xFF
ROM:1FA9 02 11 04 03+aCREDIT:	     .db 2, 0x11, 4, 3,	8, 0x13, 0x26		     ; "CREDIT "
ROM:1FB0 00 60 10 0F+		     .db 0, 0x60, 0x10,	0xF, 0x10, 0x60, 0x38, 0x19, 0x3A, 0x6D	; letter Y w/invader legs closed
ROM:1FB0 10 60 38 19+		     .db 0xFA, 0xFA, 0x6D, 0x3A, 0x19, 0
ROM:1FC0 00 20 40 4D+		     .db 0, 0x20, 0x40,	0x4D, 0x50, 0x20, 0, 0	     ; "?" (chr	$38)
ROM:1FC8 00			     .db    0
ROM:1FC9 00 00 FF B8+byte_0_1FC9:    .db 0, 0, 0xFF, 0xB8, 0xFF, 0x80, 0x1F, 0x10, 0x97, 0 ; inverted-y	animation pt.3 data
ROM:1FC9 FF 80 1F 10+		     .db 0x80, 0x1F
ROM:1FD5 00 00 01 D0+splash_anim_4:  .db 0, 0, 1, 0xD0,	0x22, 0x20, 0x1C, 0x10,	0x94, 0, 0x20 ;	bomb-c animation data
ROM:1FD5 22 20 1C 10+		     .db 0x1C
ROM:1FE1 28 1C 26 0F+a2PLAYERS2COINS:.db 0x28, 0x1C, 0x26, 0xF,	0xB, 0,	0x18, 4, 0x11, 0x12 ; "*2 PLAYERS 2 COINS"
ROM:1FE1 0B 00 18 04+		     .db 0x26, 0x1C, 0x26, 2, 0xE, 8, 0xD, 0x12
ROM:1FF3 0F 14 12 07+aPUSH:	     .db 0xF, 0x14, 0x12, 7, 0x26		     ; "PUSH "
ROM:1FF8 00			     .db    0
ROM:1FF9 08 08 08 08+		     .db 8, 8, 8, 8, 8,	0
ROM:1FFF 00			     .db    0
ROM:1FFF	     ; end of 'ROM'
ROM:1FFF
RAM:2000	     ; ===========================================================================
RAM:2000
RAM:2000	     ; Segment type: Regular
RAM:2000			     .org 0x2000
RAM:2000 ??	     curr_invader_needs_drawing:.ds 1
RAM:2001 ??			     .ds 1
RAM:2002 ??	     player_shot_something:.ds 1
RAM:2003 ??	     invader_explosion_counter:.ds 1
RAM:2004 ??	     curr_invader_updated_row:.ds 1
RAM:2005 ??	     invader_animation_frame_no:.ds 1				     ; 0/1
RAM:2006 ??	     next_invader_to_update:.ds	1				     ; (0-54)
RAM:2007 ??	     invader_y_inc:  .ds 1					     ; value to	inc y coord of invaders	this frame
RAM:2008 ??	     invader_x_inc:  .ds 1					     ; value to	inc x coord of invaders	this frame
RAM:2009 ??	     bottom_left_invader_y:.ds 1				     ; y coord of bottom left invader
RAM:200A ??	     bottom_left_invader_x:.ds 1				     ; x coord of bottom left invader
RAM:200B ??	     curr_invader_y: .ds 1					     ; y coord of current invader
RAM:200C ??	     curr_invader_x: .ds 1					     ; x coord of current invader
RAM:200D ??	     invader_left_right:.ds 1
RAM:200E ??	     invader_y_inc_init_value:.ds 1
RAM:200F ??			     .ds 1
RAM:2010	     ; *
RAM:2010	     ; * Game object table
RAM:2010	     ; *
RAM:2010 ??	     obj0_timer_msb: .ds 1
RAM:2011 ??	     obj0_timer_lsb: .ds 1
RAM:2012 ??	     obj0_timer_extra:.ds 1
RAM:2013 ?? ??	     obj0_handler:   .ds 2
RAM:2015 ??	     gameplay_ticker:.ds 1
RAM:2016 ??			     .ds 1					     ; player explosion	counter
RAM:2017 ??			     .ds 1
RAM:2018 ?? ??	     player_ship_info:.ds 2					     ; ptr player ship gfx bitmap
RAM:201A ??	     player_ship_coord:.ds 1
RAM:201B ??	     player_ship_coord_lsb_:.ds	1				     ; player ship coord (2 bytes)
RAM:201C ??			     .ds 1					     ; player ship bitmap length
RAM:201D ??	     demo_joystick_input:.ds 1
RAM:201E ??	     enable_taito_easter_egg:.ds 1
RAM:201F ??			     .ds 1
RAM:2020 ??	     obj1_timer_msb: .ds 1
RAM:2021 ??			     .ds 1
RAM:2022 ??			     .ds 1
RAM:2023 ?? ??	     obj1_handler:   .ds 2					     ; jump vector
RAM:2025 ??	     fire_progress_state:.ds 1
RAM:2026 ??			     .ds 1
RAM:2027 ?? ??	     obj1_image:     .ds 2					     ; ptr player bullet bitmap
RAM:2029 ??	     player_shot_y_coord:.ds 1
RAM:202A ??	     player_shot_x_coord:.ds 1
RAM:202B ??			     .ds 1					     ; player bullet bitmap length
RAM:202C ??	     player_shot_y_inc:.ds 1					     ; player bullet y coord increment
RAM:202D ??	     last_fire_button_state:.ds	1
RAM:202E ??			     .ds 1
RAM:202F ??			     .ds 1
RAM:2030 ??	     obj2_timer_msb: .ds 1
RAM:2031 ??			     .ds 1
RAM:2032 ??	     obj2_timer_extra:.ds 1
RAM:2033 ?? ??	     obj2_handler:   .ds 2					     ; jump vector
RAM:2035 ??	     alien_bomb_1_data:.ds 1
RAM:2036 ??	     rol_shot_set_cnt:.ds 1
RAM:2037 ??			     .ds 1
RAM:2038 ?? ??	     rol_shot_track: .ds 2
RAM:203A ?? ?? ?? ??+rol_shot_blow_cnt:.ds 9					     ; (unused?)
RAM:2043 ?? ??	     obj3_handler:   .ds 2					     ; jump vector
RAM:2045 ??	     alien_bomb_2_data:.ds 1
RAM:2046 ??	     plu_shot_step_cnt:.ds 1
RAM:2047 ??			     .ds 1
RAM:2048 ?? ??	     plu_shot_col_fire_tbl:.ds 2
RAM:204A ?? ?? ?? ??+plu_shot_blow_cnt:.ds 9					     ; (unused?)
RAM:2053 ?? ??	     obj4_handler:   .ds 2					     ; jump vector
RAM:2055 ??	     alien_bomb_3_data:.ds 1
RAM:2056 ??	     squ_shot_step_cnt:.ds 1
RAM:2057 ??			     .ds 1
RAM:2058 ?? ??	     squ_shot_col_fire_tbl:.ds 2
RAM:205A ??			     .ds 1
RAM:205B ??			     .ds 1
RAM:205C ??			     .ds 1
RAM:205D ??			     .ds 1
RAM:205E ??			     .ds 1
RAM:205F ??			     .ds 1
RAM:2060 ??			     .ds 1
RAM:2061 ??	     something_hit:  .ds 1
RAM:2062 ?? ??	     exp_alien:	     .ds 2					     ; ptr invader object bitmap
RAM:2064 ?? ??	     invader_screen_loc:.ds 2					     ; invader object screen loc
RAM:2066 ??			     .ds 1					     ; invader object bitmap length
RAM:2067 ??	     ptr_curr_player_data:.ds 1					     ; msb loaded into high register (usually h)
RAM:2068 ??	     player_ok:	     .ds 1
RAM:2069 ??	     enable_alien_fire:.ds 1
RAM:206A ??	     alien_fire_delay:.ds 1
RAM:206B ??	     only_1_invader_left:.ds 1
RAM:206C ??	     string_length:  .ds 1
RAM:206D ??	     invaded:	     .ds 1					     ; boolean
RAM:206E ??	     skip_plunger:   .ds 1
RAM:206F ??			     .ds 1
RAM:2070 ??	     other_shot_1:   .ds 1
RAM:2071 ??	     other_shot_2:   .ds 1
RAM:2072 ??	     which_intr:     .ds 1
RAM:2073 ??	     curr_alien_bomb_data:.ds 1					     ; 11 bytes	of bomb	data
RAM:2074 ??			     .ds 1
RAM:2075 ??			     .ds 1
RAM:2076 ?? ??	     ptr_bomb_random_table:.ds 2
RAM:2078 ??	     a_shot_blow_cnt:.ds 1
RAM:2079 ?? ??	     alien_bomb_bitmap_addr:.ds	2				     ; object bitmap location
RAM:207B ?? ??	     alien_bomb_screen_loc:.ds 2				     ; object screen location
RAM:207D ??	     alien_bomb_bitmap_length:.ds 1				     ; object bitmap length
RAM:207E ??	     alien_bomb_y_inc:.ds 1
RAM:207F ??	     alien_pic_end:  .ds 1
RAM:2080 ??	     shot_sync:	     .ds 1
RAM:2081 ??	     draw_or_restore_shields_flag:.ds 1
RAM:2082 ??	     num_invaders_left:.ds 1
RAM:2083 ??	     time_for_ufo:   .ds 1					     ; time for	the ufo	to appear?
RAM:2084 ??	     ufo_visible:    .ds 1
RAM:2085 ??	     ufo_hit:	     .ds 1
RAM:2086 ??			     .ds 1					     ; countdown after ufo hit
RAM:2087 ?? ??	     ptr_ufo_bitmap: .ds 2					     ; object bitmap address -or-
RAM:2087									     ; string address
RAM:2089 ??			     .ds 1					     ; object screen location (2 bytes)
RAM:208A ??	     ufo_x:	     .ds 1
RAM:208B ??			     .ds 1					     ; object bitmap size
RAM:208C ??			     .ds 1					     ; object x	move offset
RAM:208D ?? ??	     ???_counter:    .ds 2
RAM:208F ??	     shot_count_lsb: .ds 1					     ; ptr to address (in ROM!)	whose b0
RAM:208F									     ; determines which	side the UFO comes in
RAM:2090 ??			     .ds 1
RAM:2091 ??	     next_ufo_timer: .ds 1					     ; time untilo next	ufo
RAM:2092 ??			     .ds 1
RAM:2093 ??	     coined_up:	     .ds 1
RAM:2094 ??	     port3_sound_shadow_reg:.ds	1
RAM:2095 ??	     update_invader_sound:.ds 1
RAM:2096 ??	     fleet_snd_cnt:  .ds 1
RAM:2097 ??	     fleet_snd_reload:.ds 1
RAM:2098 ??	     port_5_sound_shadow_reg:.ds 1
RAM:2099 ??	     bonus_ship_sound_timer:.ds	1
RAM:209A ??	     tilted:	     .ds 1
RAM:209B ??	     invader_sound_counter:.ds 1
RAM:209C ?? ?? ?? ??+		     .ds 0x24					     ; (unused?)
RAM:20C0 ??	     isr_delay:	     .ds 1
RAM:20C1 ??	     animation_type: .ds 1					     ; 0 = none,
RAM:20C1									     ; 1 = demo,
RAM:20C1									     ; 2 = invader,
RAM:20C1									     ; 4 = bomb-c
RAM:20C2 ??	     animation_frame_count:.ds 1				     ; frame count for current animation
RAM:20C3 ??	     animated_invader_y_inc:.ds	1				     ; animated	invader	y inc
RAM:20C4 ??	     animated_invader_x_inc:.ds	1				     ; animated	invader	x inc
RAM:20C5 ?? ??	     animated_invader_screen_loc:.ds 2				     ; animated	invader	y,x coords
RAM:20C7 ?? ??	     animated_invader_curr_bitmap:.ds 2				     ; ptr animated invader bitmap
RAM:20C9 ??	     animated_invader_bitmap_length:.ds	1			     ; animated	invader	bitmap size
RAM:20CA ??	     animated_invader_final_x:.ds 1				     ; animated	inavder	final x	coord
RAM:20CB ??	     animation_finished:.ds 1					     ; flag for	animation finished
RAM:20CC ?? ??	     animated_invader_base_bitmap:.ds 2
RAM:20CE ??	     two_p_game:     .ds 1
RAM:20CF ??	     bomb_frequency: .ds 1
RAM:20D0 ?? ?? ?? ??+		     .ds 0x15					     ; (unused?)
RAM:20E5 ??	     yet_to_earn_bonus_ship:.ds	1
RAM:20E6 ??			     .ds 1
RAM:20E7 ??	     num_men_p1:     .ds 1
RAM:20E8 ??	     num_men_p2:     .ds 1
RAM:20E9 ??	     enable_vblank_code:.ds 1
RAM:20EA ??	     debounced_credit_flag:.ds 1
RAM:20EB ??	     num_credits:    .ds 1
RAM:20EC ??	     splash_animate: .ds 1					     ; 0=show, 1=don't show animations
RAM:20ED ?? ??	     ptr_demo_joystick_input:.ds 2
RAM:20EF ??	     game_in_progress:.ds 1
RAM:20F0 ??			     .ds 1
RAM:20F1 ??	     any_points_to_add:.ds 1
RAM:20F2 ?? ??	     points_to_add:  .ds 2
RAM:20F4 ?? ??	     hi_score:	     .ds 2					     ; BCD
RAM:20F6 ?? ??	     hi_score_screen_loc:.ds 2
RAM:20F8 ?? ??	     p1_score:	     .ds 2					     ; BCD
RAM:20FA ?? ??	     p1_score_screen_loc:.ds 2
RAM:20FC ?? ??	     p2_score:	     .ds 2					     ; BCD
RAM:20FE ?? ??	     p2_score_screen_loc:.ds 2
RAM:2100 ?? ?? ?? ??+p1_invader_map: .ds 0x37					     ; 1=invader still alive
RAM:2137 ?? ?? ?? ??+		     .ds 0xB					     ; (unused?)
RAM:2142 ?? ?? ?? ??+p1_shields:     .ds 0xB0
RAM:21F2 ?? ?? ?? ??+		     .ds 9					     ; (unused?)
RAM:21FB ??	     p1_invader_x_inc:.ds 1					     ; p1 invader x increment
RAM:21FC ?? ??	     p1_bl_invader_coords:.ds 2					     ; p1 bottom left invader y,x coords
RAM:21FE ??	     p1_wave_number: .ds 1					     ; modulo 8
RAM:21FF ??	     p1_ships_left:  .ds 1
RAM:2200 ?? ?? ?? ??+p2_invader_map: .ds 0x37					     ; 1=invader still alive
RAM:2237 ?? ?? ?? ??+		     .ds 0xB					     ; (unsued?)
RAM:2242 ?? ?? ?? ??+p2_sheids:	     .ds 0xB0
RAM:22F2 ?? ?? ?? ??+		     .ds 9					     ; (unused?)
RAM:22FB ??	     p2_invader_x_inc:.ds 1					     ; p2 invader x increment
RAM:22FC ?? ??	     p2_bl_invader_coords:.ds 2					     ; p2 bottom left invader y,x coords
RAM:22FE ??	     p2_wave_number: .ds 1					     ; modulo 8
RAM:22FF ??	     p2_ships_left:  .ds 1
RAM:2300 ?? ?? ?? ??+stack_base:     .ds 0xFF					     ; stack
RAM:2300 ?? ?? ?? ??+; end of 'RAM'
RAM:2300 ?? ?? ?? ??+
VRAM:2400	      ;	===========================================================================
VRAM:2400
VRAM:2400	      ;	Segment	type: Regular
VRAM:2400			      .org 0x2400
VRAM:2400 ?? ??	?? ??+vram:	      .ds 0x1C00
VRAM:2400 ?? ??	?? ??+;	end of 'VRAM'
VRAM:2400 ?? ??	?? ??+
VRAM:2400 ?? ??	?? ??+;	end of file
